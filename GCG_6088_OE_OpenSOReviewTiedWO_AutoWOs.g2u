Program.Sub.ScreenSU.Start
Gui.FrmOrderReview..Create
Gui.FrmOrderReview..Caption("Open SO/WO Dashboard [6088]")
Gui.FrmOrderReview..Size(15180,10485)
Gui.FrmOrderReview..MinX(0)
Gui.FrmOrderReview..MinY(0)
Gui.FrmOrderReview..Position(0,0)
Gui.FrmOrderReview..BackColor(-2147483633)
Gui.FrmOrderReview..MousePointer(0)
Gui.FrmOrderReview..Event(UnLoad,FrmOrderReview_UnLoad)
Gui.FrmOrderReview.lblStatus.Create(Label,"Loading Sales Orders.....",False,1935,315,0,30,90,True,0,"Arial",8,-2147483633,0)
Gui.FrmOrderReview.picGSSLogo.Create(PictureBox)
Gui.FrmOrderReview.picGSSLogo.Size(4125,960)
Gui.FrmOrderReview.picGSSLogo.Position(5550,30)
Gui.FrmOrderReview.picGSSLogo.BackColor(15790320)
Gui.FrmOrderReview.picGSSLogo.ForeColor(0)
Gui.FrmOrderReview.picGSSLogo.Event(DblClick,picGSSLogo_DblClick)
Gui.FrmOrderReview.picGSSLogo.ToolTip("Double-Click for additional functions")
Gui.FrmOrderReview.GsGCAllOpen.Create(GsGridControl)
Gui.FrmOrderReview.GsGCAllOpen.Size(15000,8700)
Gui.FrmOrderReview.GsGCAllOpen.Position(-30,1020)
Gui.FrmOrderReview.GsGCAllOpen.Event(RowCellClick,GsGCAllOpen_RowCellClick)
Gui.FrmOrderReview.GsGCAllOpen.Event(CellValueChanged,GsGCAllOpen_CellValueChanged)
Gui.FrmOrderReview.progressBar1.Create(ProgressBar)
Gui.FrmOrderReview.progressBar1.Size(1860,255)
Gui.FrmOrderReview.progressBar1.Position(30,360)
Gui.FrmOrderReview.progressBar1.Visible(False)
Gui.FrmOrderReview.framePermissions.Create(Frame)
Gui.FrmOrderReview.framePermissions.Size(4305,450)
Gui.FrmOrderReview.framePermissions.Position(10830,-75)
Gui.FrmOrderReview.optEdit.Create(Option)
Gui.FrmOrderReview.optEdit.Enabled(False)
Gui.FrmOrderReview.optEdit.Size(645,255)
Gui.FrmOrderReview.optEdit.Position(855,150)
Gui.FrmOrderReview.optEdit.Caption("Edit")
Gui.FrmOrderReview.optEdit.Parent("framePermissions")
Gui.FrmOrderReview.optIssue.Create(Option)
Gui.FrmOrderReview.optIssue.Size(795,240)
Gui.FrmOrderReview.optIssue.Position(1515,150)
Gui.FrmOrderReview.optIssue.Caption("Issue")
Gui.FrmOrderReview.optIssue.Enabled(False)
Gui.FrmOrderReview.optIssue.Parent("framePermissions")
Gui.FrmOrderReview.optWiptoFG.Create(Option)
Gui.FrmOrderReview.optWiptoFG.Size(1080,255)
Gui.FrmOrderReview.optWiptoFG.Position(2325,150)
Gui.FrmOrderReview.optWiptoFG.Caption("Wip to FG")
Gui.FrmOrderReview.optWiptoFG.Enabled(False)
Gui.FrmOrderReview.optWiptoFG.Parent("framePermissions")
Gui.FrmOrderReview.optView.Create(Option)
Gui.FrmOrderReview.optView.Size(765,255)
Gui.FrmOrderReview.optView.Position(75,135)
Gui.FrmOrderReview.optView.Caption("View")
Gui.FrmOrderReview.optView.Parent("framePermissions")
Gui.FrmOrderReview.optShip.Create(Option)
Gui.FrmOrderReview.optShip.Enabled(False)
Gui.FrmOrderReview.optShip.Size(780,255)
Gui.FrmOrderReview.optShip.Position(3405,150)
Gui.FrmOrderReview.optShip.Parent("framePermissions")
Gui.FrmOrderReview.optShip.Caption("Ship")
Gui.FrmOrderReview.txt1.Create(TextBox,"0 - No Issues",True,1455,195,0,12135,390,True,0,"Arial",8,9498256,0)
Gui.FrmOrderReview.txt1.Locked(True)
Gui.FrmOrderReview.txt2.Create(TextBox,"1 - No WO/PO",True,1455,195,0,12135,600,True,0,"Arial",8,16777215,0)
Gui.FrmOrderReview.txt2.Locked(True)
Gui.FrmOrderReview.txt3.Create(TextBox,"2 - Part Mismatch",True,1455,195,0,12135,810,True,0,"Arial",8,14745599,0)
Gui.FrmOrderReview.txt3.Locked(True)
Gui.FrmOrderReview.txt4.Create(TextBox,"3 - Date Mismatch",True,1455,195,0,13605,390,True,0,"Arial",8,14524637,0)
Gui.FrmOrderReview.txt4.Locked(True)
Gui.FrmOrderReview.txt5.Create(TextBox,"4 - Qty Mismatch",True,1455,195,0,13605,600,True,0,"Arial",8,12695295,0)
Gui.FrmOrderReview.txt5.Locked(True)
Gui.FrmOrderReview.cmdCreateWO.Create(Button)
Gui.FrmOrderReview.cmdCreateWO.Size(2070,375)
Gui.FrmOrderReview.cmdCreateWO.Position(6375,1050)
Gui.FrmOrderReview.cmdCreateWO.Caption("Create Work Order")
Gui.FrmOrderReview.cmdCreateWO.Event(Click,cmdCreateWO_Click)
Gui.FrmOrderReview.cmdCreateWO.Visible(False)
Gui.FrmOrderReview.cmdCreateParts.Create(Button)
Gui.FrmOrderReview.cmdCreateParts.Size(2070,375)
Gui.FrmOrderReview.cmdCreateParts.Position(30,1050)
Gui.FrmOrderReview.cmdCreateParts.Caption("Create Parts")
Gui.FrmOrderReview.cmdCreateParts.Event(Click,cmdCreateParts_Click)
Gui.FrmOrderReview.cmdCreateParts.Visible(False)
Gui.FrmOrderReview.cmdCreateRtr.Create(Button)
Gui.FrmOrderReview.cmdCreateRtr.Size(2070,375)
Gui.FrmOrderReview.cmdCreateRtr.Position(2145,1050)
Gui.FrmOrderReview.cmdCreateRtr.Caption("Create Routers")
Gui.FrmOrderReview.cmdCreateRtr.Event(Click,cmdCreateRtr_Click)
Gui.FrmOrderReview.cmdCreateRtr.Visible(False)
Gui.FrmOrderReview.cmdCreateBOM.Create(Button)
Gui.FrmOrderReview.cmdCreateBOM.Size(2070,375)
Gui.FrmOrderReview.cmdCreateBOM.Position(4275,1050)
Gui.FrmOrderReview.cmdCreateBOM.Caption("Create B.O.M.")
Gui.FrmOrderReview.cmdCreateBOM.Event(Click,cmdCreateBOM_Click)
Gui.FrmOrderReview.cmdCreateBOM.Visible(False)
Gui.FrmOrderReview.cmdCreatePO.Create(Button)
Gui.FrmOrderReview.cmdCreatePO.Size(2070,375)
Gui.FrmOrderReview.cmdCreatePO.Position(8505,1050)
Gui.FrmOrderReview.cmdCreatePO.Caption("Create Purchase Order")
Gui.FrmOrderReview.cmdCreatePO.Event(Click,cmdCreatePO_Click)
Gui.FrmOrderReview.cmdCreatePO.Visible(False)
Gui.FrmOrderReview.txt6.Create(TextBox,"5 - Ready to Invc",True,1455,195,0,13605,810,True,0,"Arial",8,15128749,0)
Gui.FrmOrderReview.txt6.Locked(True)
Gui.frmSelectVend..Create
Gui.frmSelectVend..Caption("Select Vendor")
Gui.frmSelectVend..Size(14670,5085)
Gui.frmSelectVend..MinX(0)
Gui.frmSelectVend..MinY(0)
Gui.frmSelectVend..Position(0,0)
Gui.frmSelectVend..BackColor(-2147483633)
Gui.frmSelectVend..MousePointer(0)
Gui.frmSelectVend..Event(UnLoad,frmSelectVend_UnLoad)
Gui.frmSelectVend.gsgcLines.Create(GsGridControl)
Gui.frmSelectVend.gsgcLines.Size(14280,2790)
Gui.frmSelectVend.gsgcLines.Position(90,885)
Gui.frmSelectVend.gsgcLines.Event(RowCellClick,gsgcLines_RowCellClick)
Gui.frmSelectVend.cmdVendBrw.Create(Button)
Gui.frmSelectVend.cmdVendBrw.Size(855,375)
Gui.frmSelectVend.cmdVendBrw.Position(2850,210)
Gui.frmSelectVend.cmdVendBrw.Caption("^")
Gui.frmSelectVend.cmdVendBrw.Event(Click,cmdVendBrw_Click)
Gui.frmSelectVend.cmdNewPO.Create(Button)
Gui.frmSelectVend.cmdNewPO.Size(1500,375)
Gui.frmSelectVend.cmdNewPO.Position(105,3780)
Gui.frmSelectVend.cmdNewPO.Caption("Create PO")
Gui.frmSelectVend.cmdNewPO.Event(Click,cmdNewPO_Click)
Gui.frmSelectVend.txtVendorNo.Create(TextBox,"",True,2640,300,0,105,240,False,0,"Arial",8,-2147483643,1)
Gui.frmSerNo..Create
Gui.frmSerNo..Caption("Serial Numbers")
Gui.frmSerNo..Size(7770,2355)
Gui.frmSerNo..MinX(0)
Gui.frmSerNo..MinY(0)
Gui.frmSerNo..Position(0,0)
Gui.frmSerNo..BackColor(-2147483633)
Gui.frmSerNo..MousePointer(0)
Gui.frmSerNo..Event(UnLoad,frmSerNo_UnLoad)
Gui.frmSerNo.txtSerNo.Create(TextboxM)
Gui.frmSerNo.txtSerNo.Locked(True)
Gui.frmSerNo.txtSerNo.Size(7320,1650)
Gui.frmSerNo.txtSerNo.Position(90,60)
Gui.frmSerNo.txtSerNo.TabStop(True)
Gui.frmSerNo.txtSerNo.TabIndex(2)
Program.Sub.ScreenSU.End

Program.Sub.Preflight.Start
V.Global.bLoadData.Declare
V.Global.bLongPart.Declare
V.Global.bShipOEPermission.Declare
V.Global.bShipSHIPPermission.Declare
V.Global.bShip.Declare
V.Global.iPrintAudit.Declare

'Change Scheduling to be forward!!!
Program.External.Include.Library("175100.lib")
Program.External.Include.Library("300011.lib")
Program.External.Include.Library("500030.lib")
Program.Sub.Preflight.End

Program.Sub.Main.Start
	F.Intrinsic.Control.Try
	'6088
	'TJS Oct 2020
	'Customer: Haskris
	'Modification of 5219, Open SO/WO Dashboard with Auto WO Generation
	
	F.Intrinsic.Control.If(V.Caller.Hook,=,"11560")
		V.Passed.000201.Set("SO/WO Dash.")
	F.Intrinsic.Control.Else
		V.Local.sError.Declare
		
		V.Local.sIcon.Declare
		V.Local.sGssLogo.Declare
		
		F.Intrinsic.String.Build("{0}\ART\gss2.ico",V.Caller.GlobalDir,V.Local.sIcon)
		F.Intrinsic.String.Build("{0}\ART\GAB_GSS_Logo_Green_Dash.png",V.Caller.GlobalDir,V.Local.sGssLogo)
		'Gui.frmWeb..Icon(V.Local.sIcon)
		Gui.FrmOrderReview..Icon(V.Local.sIcon)
		Gui.FrmOrderReview.picGSSLogo.Picture(V.Local.sGssLogo)
		
		F.ODBC.Connection!con.OpenCompanyConnection(500)
		
		F.Intrinsic.Control.CallSub(SetContextMenus)
		F.Intrinsic.Control.CallSub(SetAnchors)
		F.Intrinsic.Control.CallSub(CheckLongPart)
		F.Intrinsic.Control.CallSub(CheckPermissions)
		F.Intrinsic.Control.CallSub(checktable)
		
		'Check Print Audit Option
		F.Global.General.ReadOption(400367,3,0000,V.Global.iPrintAudit)
		
		'Gui.FrmOrderReview.optView.Value(True)
	
		Gui.FrmOrderReview..Show
		F.Intrinsic.Control.CallSub(SetTabAnchors)
		F.Intrinsic.Control.CallSub(loaddtall)
		F.Intrinsic.Control.CallSub(Deserialize)
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.Main.End

Program.Sub.FrmOrderReview_UnLoad.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Control.If(V.Global.bLoadData)
		F.Intrinsic.Control.CallSub(Serialize)
	F.Intrinsic.Control.EndIf
	
	F.ODBC.Connection!con.Close
	F.Intrinsic.Control.End
	
F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
F.Intrinsic.Control.EndTry
Program.Sub.FrmOrderReview_UnLoad.End

Program.Sub.SetAnchors.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	'0 - None
	'1 - Top
	'2 - Bottom
	'4 - Left
	'8 - Right

	Gui.FrmOrderReview.picGSSLogo.Anchor(1)
	Gui.FrmOrderReview.lblStatus.Anchor(5)
	'Gui.FrmOrderReview.cmdCreateWO.anchor(9)
	'Gui.FrmOrderReview.cmdCreateParts.anchor(9)
	'Gui.FrmOrderReview.cmdCreateRtr.anchor(9)
	'Gui.FrmOrderReview.cmdCreateBOM.anchor(9)
	'Gui.FrmOrderReview.cmdCreatePO.anchor(9)
	Gui.FrmOrderReview.progressBar1.Anchor(5)
	'Gui.FrmOrderReview.frameButtons.Anchor(9)
	Gui.FrmOrderReview.framePermissions.Anchor(9)
	Gui.FrmOrderReview.txt1.Anchor(9)
	Gui.FrmOrderReview.txt2.Anchor(9)
	Gui.FrmOrderReview.txt3.Anchor(9)
	Gui.FrmOrderReview.txt4.Anchor(9)
	Gui.FrmOrderReview.txt5.Anchor(9)
	Gui.FrmOrderReview.txt6.anchor(9)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.SetAnchors.End

Program.Sub.SetTabAnchors.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	'0 - None
	'1 - Top
	'2 - Bottom
	'4 - Left
	'8 - Right

	Gui.FrmOrderReview.GsGCAllOpen.Anchor(15)
	'Gui.FrmOrderReview.GsGCPastDue.Anchor(15)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.SetTabAnchors.End

Program.Sub.CheckLongPart.Start
	F.Global.General.ReadOption("400861",0,False,"0000",V.Global.bLongPart)
	F.Intrinsic.Control.If(V.Global.bLongPart,=,False)
		F.Global.General.ReadOption("400861",0,False,"0004",V.Global.bLongPart)
	F.Intrinsic.Control.EndIf
Program.Sub.CheckLongPart.End

Program.Sub.LoadDTAll.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	V.Local.sMark.Declare
	V.Local.sCMarkFile.Declare
	V.Local.sSearch.Declare
	V.Local.sret.Declare
	V.Local.i.Declare
	V.Local.iCnt.Declare
	V.Local.sSQL.Declare
	V.Local.sFilter.Declare
	
	F.Intrinsic.String.Concat(V.Caller.GasDir,"GCG_6088_COMPLETION.txt",V.Local.sCMarkFile)
	F.Intrinsic.File.File2String(V.Local.sCMarkFile,V.Local.sMark)
	
	Gui.FrmOrderReview.lblStatus.Caption("Loading Sales Orders....")
	Gui.FrmOrderReview.lblStatus.Visible(True)
	Gui.FrmOrderReview.progressBar1.Value(0)
	Gui.FrmOrderReview.progressBar1.Visible(True)
	
	F.Intrinsic.Control.If(V.DataTable.dtMaster.Exists)
		F.Data.DataTable.Close("dtMaster")
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.DataTable.dtAll.Exists)
		F.Data.DataTable.Close("dtAll")
	F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.If(V.DataTable.dtMulti.Exists)
		F.Data.DataTable.Close("dtMulti")
	F.Intrinsic.Control.EndIf
	
	V.Global.bLoadData.Set(True)	
	'6088 - Creating parent datatable (dtMaster)
	F.Data.DataTable.CreateFromSQL("dtMaster","con","Select CONVERT(0,SQL_BIT)  as ScheduleWO, ' ' as PrtDocCntrl, ' ' as PartExists, ' ' as RtrCompl, ' ' as BomCompl, ' ' as StatusMsg, A.Date_Order as SOOrderDate, B.Name_Customer as Name_Customer, C.Customer_PO as Customer_PO , C.CODE_SORT as CODE_SORT, A.Order_No as SO, Left(A.Record_No,3) as SOLine,A.ORDER_NO+A.RECORD_NO as SO_SOLine, RTRIM(A.Part) as SOPart, A.Description, A.Qty_Ordered As SOQty, A.PRICE, A.EXTENSION, A.UM_ORDER, ' ' as SODueDate, CONVERT(0,SQL_INTEGER) as QTY_ONHAND, A.QTY_SHIPPED as ShipQTY, ' ' as WO, ' ' as Suffix , ' ' as WODueDate , Rtrim(A.User_1) as User_1, Rtrim(A.User_2) as PO, rtrim(A.User_3) as POLine, ' ' as PODueDate, C.Salesperson as Salesperson , rtrim(A.Part) as PartFriendly, E.Notes as Notes , A.User_4, ' ' as Printed, ' ' as Released,' ' JobDocCntrl, CONVERT(0,SQL_BIT) as WOCreated, ' ' as CODE_SOURCE, C.ORDER_SORT_2 as ORDER_SORT_2 , RTrim(D.Name) as SPName, A.Line_Type   As SOType, A.Location    As SOLoc, A.Product_Line, Cast(Case A.Flag_Use_Mqd When 'Y'Then 1 Else 0 End As Bit)  As SOShipSched, ' ' as WOPart, ' ' as WOLoc, ' ' as WOQty, ' ' as WOSchedDate, ' ' as WOClsd, ' ' as POPart, ' ' as POLoc, ' ' as POQty, ' ' as POClsd, ' ' as POType, ' ' as Status, A.User_5, rtrim(A.Part) as GSSPart, A.Customer, ' ' as SOBOQty, RTRIM(A.FLAG_COGS) AS FLAG_COGS, ' '  as Ser_No,RTRIM(A.USER_2)+RTRIM(A.USER_3) as POREC,A.ORDER_NO+A.RECORD_NO as POREC2,' ' as POPart1,' ' as POLoc1,' ' as POQty1,' ' as POClsd1,' ' as PODueDate1,' ' as POPart2,' ' as POLoc2,' ' as POQty2,' ' as POClsd2,' ' as PODueDate2 From V_ORDER_LINES A left join V_CUSTOMER_MASTER B on A.CUSTOMER = B.CUSTOMER left join V_ORDER_HEADER C on A.ORDER_NO = C.ORDER_NO left join V_SALESPERSONS D on C.SALESPERSON = D.ID left join GAB_4167_SO_NOTES E on A.ORDER_NO = E.SO and A.RECORD_NO = Concat(E.SOLINE,0) Order By A.Date_Item_Prom;",True)
	
	'Regular POs
	F.Data.DataTable.CreateFromSQL("dtRegPO","con","Select A.PURCHASE_ORDER,A.RECORD_NO as PO_LINE,A.DATE_DUE_LINE as PODueDate,A.PART as POPart,A.LOCATION as POLoc,A.QTY_ORDER as POQty,A.FLAG_RECV_CLOSE as LINE_RECV_CLOSE,Cast( Case When If(A.FLAG_RECV_CLOSE = '',B.FLAG_RECV_CLOSED,A.FLAG_RECV_CLOSE) = 'Y' Then 1 End as Bit) as POClsd,B.FLAG_RECV_CLOSED as HEAD_RECV_CLOSE,A.PURCHASE_ORDER+A.RECORD_NO as POREC,' ' as POREC2 from V_PO_LINES A left join V_PO_HEADER B on A.PURCHASE_ORDER = B.PURCHASE_ORDER;")
		'Fill PO Part
		F.Data.Dictionary.CreateFromDatatable("dictPOPart","dtRegPO","POREC","POPart")
		F.Data.Dictionary.SetDefaultReturn("dictPOPart","")
		
		F.Data.DataTable.FillFromDictionary("dtMaster","dictPOPart","POREC","POPart1")
		F.Data.Dictionary.Close("dictPOPart")
		'Fill PO Location
		F.Data.Dictionary.CreateFromDatatable("dictPOPartLoc","dtRegPO","POREC","POLoc")
		F.Data.Dictionary.SetDefaultReturn("dictPOPartLoc","")
		
		F.Data.DataTable.FillFromDictionary("dtMaster","dictPOPartLoc","POREC","POLoc1")
		F.Data.Dictionary.Close("dictPOPartLoc")
		'Fill PO Quantity
		F.Data.Dictionary.CreateFromDatatable("dictPOQty","dtRegPO","POREC","POQty")
		F.Data.Dictionary.SetDefaultReturn("dictPOQty","")
		
		F.Data.DataTable.FillFromDictionary("dtMaster","dictPOQty","POREC","POQty1")
		F.Data.Dictionary.Close("dictPOQty")
		'Fill PO Closed
		F.Data.Dictionary.CreateFromDatatable("dictPOClsd","dtRegPO","POREC","POClsd")
		F.Data.Dictionary.SetDefaultReturn("dictPOClsd","")
		
		F.Data.DataTable.FillFromDictionary("dtMaster","dictPOClsd","POREC","POClsd1")
		F.Data.Dictionary.Close("dictPOClsd")
		'Fill PO Due Date
		F.Data.Dictionary.CreateFromDatatable("dictPODueDate","dtRegPO","POREC","PODueDate")
		F.Data.Dictionary.SetDefaultReturn("dictPODueDate","")
		
		F.Data.DataTable.FillFromDictionary("dtMaster","dictPODueDate","POREC","PODueDate1")
		F.Data.Dictionary.Close("dictPODueDate")
	F.Data.DataTable.Close("dtRegPO")
	
	'Drop Ship POs
	F.Data.DataTable.CreateFromSQL("dtDsPO","con","Select A.ORDER_NO,A.ORDER_LINE,B.PURCHASE_ORDER,B.RECORD_NO as PO_LINE,B.DATE_DUE_LINE PODueDate,B.PART as POPart,B.LOCATION as POLoc,B.QTY_ORDER as POQty,B.FLAG_RECV_CLOSE as LINE_RECV_CLOSE,Cast( Case When If(B.FLAG_RECV_CLOSE = '',C.FLAG_RECV_CLOSED,B.FLAG_RECV_CLOSE) = 'Y' Then 1 End as Bit) as POClsd,C.FLAG_RECV_CLOSED as HEAD_RECV_CLOSE,A.ORDER_NO+A.ORDER_LINE as POREC2 from V_PO_DROP_SHIP A left join V_PO_LINES B on A.PO = B.PURCHASE_ORDER and A.PO_LINE = B.RECORD_NO left join V_PO_HEADER C on B.PURCHASE_ORDER = C.PURCHASE_ORDER;")
		'Fill PO Part
		F.Data.Dictionary.CreateFromDatatable("dictPOPart","dtDsPO","POREC2","POPart")
		F.Data.Dictionary.SetDefaultReturn("dictPOPart","")
		
		F.Data.DataTable.FillFromDictionary("dtMaster","dictPOPart","POREC2","POPart2")
		F.Data.Dictionary.Close("dictPOPart")
		'Fill PO Location
		F.Data.Dictionary.CreateFromDatatable("dictPOPartLoc","dtDsPO","POREC2","POLoc")
		F.Data.Dictionary.SetDefaultReturn("dictPOPartLoc","")
		
		F.Data.DataTable.FillFromDictionary("dtMaster","dictPOPartLoc","POREC2","POLoc2")
		F.Data.Dictionary.Close("dictPOPartLoc")
		'Fill PO Quantity
		F.Data.Dictionary.CreateFromDatatable("dictPOQty","dtDsPO","POREC2","POQty")
		F.Data.Dictionary.SetDefaultReturn("dictPOQty","")
		
		F.Data.DataTable.FillFromDictionary("dtMaster","dictPOQty","POREC2","POQty2")
		F.Data.Dictionary.Close("dictPOQty")
		'Fill PO Closed
		F.Data.Dictionary.CreateFromDatatable("dictPOClsd","dtDsPO","POREC2","POClsd")
		F.Data.Dictionary.SetDefaultReturn("dictPOClsd","")
		
		F.Data.DataTable.FillFromDictionary("dtMaster","dictPOClsd","POREC2","POClsd2")
		F.Data.Dictionary.Close("dictPOClsd")
		'Fill PO Due Date
		F.Data.Dictionary.CreateFromDatatable("dictPODueDate","dtDsPO","POREC2","PODueDate")
		F.Data.Dictionary.SetDefaultReturn("dictPODueDate","")
		
		F.Data.DataTable.FillFromDictionary("dtMaster","dictPODueDate","POREC2","PODueDate2")
		F.Data.Dictionary.Close("dictPODueDate")
	F.Data.DataTable.Close("dtDsPO")
	
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtMaster.RowCount--,1)
		F.Intrinsic.Control.If(V.DataTable.dtMaster(V.Local.iCnt).POPart1!FieldValTrim,<>,"")
			F.Data.DataTable.SetValue("dtMaster",V.Local.iCnt,"POPart",V.DataTable.dtMaster(V.Local.iCnt).POPart1!FieldValTrim,"POLoc",V.DataTable.dtMaster(V.Local.iCnt).POLoc1!FieldValTrim,"POQty",V.DataTable.dtMaster(V.Local.iCnt).POQty1!FieldValTrim,"POClsd",V.DataTable.dtMaster(V.Local.iCnt).POClsd1!FieldValTrim,"PODueDate",V.DataTable.dtMaster(V.Local.iCnt).PODueDate1!FieldValTrim)
		F.Intrinsic.Control.Else
			F.Data.DataTable.SetValue("dtMaster",V.Local.iCnt,"POPart",V.DataTable.dtMaster(V.Local.iCnt).POPart2!FieldValTrim,"POLoc",V.DataTable.dtMaster(V.Local.iCnt).POLoc2!FieldValTrim,"POQty",V.DataTable.dtMaster(V.Local.iCnt).POQty2!FieldValTrim,"POClsd",V.DataTable.dtMaster(V.Local.iCnt).POClsd2!FieldValTrim,"PODueDate",V.DataTable.dtMaster(V.Local.iCnt).PODueDate2!FieldValTrim)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.iCnt)
	
	F.Data.DataTable.RemoveColumn("dtMaster","POPart1")
	F.Data.DataTable.RemoveColumn("dtMaster","POLoc1")
	F.Data.DataTable.RemoveColumn("dtMaster","POQty1")
	F.Data.DataTable.RemoveColumn("dtMaster","POClsd1")
	F.Data.DataTable.RemoveColumn("dtMaster","PODueDate1")
	F.Data.DataTable.RemoveColumn("dtMaster","POREC")
	F.Data.DataTable.RemoveColumn("dtMaster","POPart2")
	F.Data.DataTable.RemoveColumn("dtMaster","POLoc2")
	F.Data.DataTable.RemoveColumn("dtMaster","POQty2")
	F.Data.DataTable.RemoveColumn("dtMaster","POClsd2")
	F.Data.DataTable.RemoveColumn("dtMaster","PODueDate2")
	
	'WO Data
	F.Data.DataTable.CreateFromSQL("dtJobData","con","Select A.ORDER_NO,A.ORDER_LINE,RTRIM(A.JOB) as WO,RTRIM(A.SUFFIX) as SUFFIX,Case B.DATE_DUE When '1900-01-01' Then Null Else B.DATE_DUE End as WODueDate,Cast(Case When B.FLAG_WO_PRTD = 'Y' or B.FLAG_WO_PRTD = 'R' Then 1 Else 0 End As Bit) as PRINTED,Cast(Case When B.FLAG_WO_RELEASED = 'Y' Then 1 Else 0 End As Bit) as RELEASED,A.JOB+A.SUFFIX as JS,B.PART as WOPart,B.LOCATION as WOLoc,B.QTY_ORDER as WOQty,Case B.SCHEDULED_DUE_DATE When '1900-01-01' Then Null Else B.SCHEDULED_DUE_DATE End as WOSchedDate,Cast(Case B.DATE_CLOSED When '1900-01-01' Then 0 Else 1 End as Bit) as WOClsd,A.ORDER_NO+A.ORDER_LINE as POREC2 from V_ORDER_TO_WO A left join V_JOB_HEADER B on RTRIM(A.JOB) = RTRIM(B.JOB) and RTRIM(A.SUFFIX) = RTRIM(B.SUFFIX);")
		'Fill Job
		F.Data.Dictionary.CreateFromDataTable("dictWO","dtJobData","POREC2","WO")
		F.Data.Dictionary.SetDefaultReturn("dictWO","")
		
		F.Data.DataTable.FillFromDictionary("dtMaster","dictWO","POREC2","WO")
		F.Data.Dictionary.Close("dictWO")
		'Fill Suffix
		F.Data.Dictionary.CreateFromDataTable("dictWOSuff","dtJobData","POREC2","SUFFIX")
		F.Data.Dictionary.SetDefaultReturn("dictWOSuff","")
		
		F.Data.DataTable.FillFromDictionary("dtMaster","dictWOSuff","POREC2","Suffix")
		F.Data.Dictionary.Close("dictWOSuff")
		'Fill WO Due Date
		F.Data.Dictionary.CreateFromDataTable("dictWODueDate","dtJobData","POREC2","WODueDate")
		F.Data.Dictionary.SetDefaultReturn("dictWODueDate","")
		
		F.Data.DataTable.FillFromDictionary("dtMaster","dictWODueDate","POREC2","WODueDate")
		F.Data.Dictionary.Close("dictWODueDate")
		'Fill WOPart
		F.Data.Dictionary.CreateFromDataTable("dictWOPart","dtJobData","POREC2","WOPart")
		F.Data.Dictionary.SetDefaultReturn("dictWOPart","")
		
		F.Data.DataTable.FillFromDictionary("dtMaster","dictWOPart","POREC2","WOPart")
		F.Data.Dictionary.Close("dictWOPart")		
		'Fill WOLoc
		F.Data.Dictionary.CreateFromDataTable("dictWOLoc","dtJobData","POREC2","WOLoc")
		F.Data.Dictionary.SetDefaultReturn("dictWOLoc","")
		
		F.Data.DataTable.FillFromDictionary("dtMaster","dictWOLoc","POREC2","WOLoc")
		F.Data.Dictionary.Close("dictWOLoc")		
		'Fill WOQty
		F.Data.Dictionary.CreateFromDataTable("dictWOQty","dtJobData","POREC2","WOQty")
		F.Data.Dictionary.SetDefaultReturn("dictWOQty","")
		
		F.Data.DataTable.FillFromDictionary("dtMaster","dictWOQty","POREC2","WOQty")
		F.Data.Dictionary.Close("dictWOQty")
		'Fill Printed
		F.Data.Dictionary.CreateFromDataTable("dictPrnt","dtJobData","POREC2","PRINTED")
		F.Data.Dictionary.SetDefaultReturn("dictPrnt","")
		
		F.Data.DataTable.FillFromDictionary("dtMaster","dictPrnt","POREC2","PRINTED")
		F.Data.Dictionary.Close("dictPrnt")
		'Fill Released
		F.Data.Dictionary.CreateFromDataTable("dictRlse","dtJobData","POREC2","RELEASED")
		F.Data.Dictionary.SetDefaultReturn("dictRlse","")
		
		F.Data.DataTable.FillFromDictionary("dtMaster","dictRlse","POREC2","RELEASED")
		F.Data.Dictionary.Close("dictRlse")
		'Fill WOSchedDate
		F.Data.Dictionary.CreateFromDataTable("dictSchDD","dtJobData","POREC2","WOSchedDate")
		F.Data.Dictionary.SetDefaultReturn("dictSchDD","")
		
		F.Data.DataTable.FillFromDictionary("dtMaster","dictSchDD","POREC2","WOSchedDate")
		F.Data.Dictionary.Close("dictSchDD")
		'Fill WOClsd
		F.Data.Dictionary.CreateFromDataTable("dictWOClsd","dtJobData","POREC2","WOClsd")
		F.Data.Dictionary.SetDefaultReturn("dictWOClsd","")
		
		F.Data.DataTable.FillFromDictionary("dtMaster","dictWOClsd","POREC2","WOClsd")
		F.Data.Dictionary.Close("dictWOClsd")
	F.Data.DataTable.Close("dtJobData")
	
	F.Data.DataTable.AddExpressionColumn("dtMaster","JS","String","WO+SUFFIX")
	
	'SODueDate and SOBOQty
	F.Data.DataTable.CreateFromSQL("dtSOData","con","Select A.ORDER_NO,A.RECORD_NO,Case A.FLAG_USE_MQD When 'Y' Then Case When B.CUST_DUE_DATE = '1900-01-01' Then Null Else B.CUST_DUE_DATE End Else Case When A.DATE_ITEM_PROM = '1900-01-01' Then Null Else A.DATE_ITEM_PROM End End as SODueDate, Case A.FLAG_USE_MQD When 'Y' Then B.QTY_OPEN Else A.QTY_BO End as SOBOQty,A.ORDER_NO+A.RECORD_NO as POREC2 from V_ORDER_LINES A Left join V_OE_SHIP_SCHED B on A.ORDER_NO = B.ORDER_NO and A.RECORD_NO = B.ORDER_LINE and B.FLAG_CLOSED <> 'Y';")
	
		F.Data.Dictionary.CreateFromDataTable("dictSODD","dtSOData","POREC2","SODueDate")
		F.Data.Dictionary.SetDefaultReturn("dictSODD","")
		
		F.Data.DataTable.FillFromDictionary("dtMaster","dictSODD","POREC2","SODueDate")
		F.Data.Dictionary.Close("dictSODD")
		
		F.Data.Dictionary.CreateFromDataTable("dictSOBOQty","dtSOData","POREC2","SOBOQty")
		F.Data.Dictionary.SetDefaultReturn("dictSOBOQty","")
		
		F.Data.DataTable.FillFromDictionary("dtMaster","dictSOBOQty","POREC2","SOBOQty")
		F.Data.Dictionary.Close("dictSOBOQty")
	F.Data.DataTable.Close("dtSOData")
	
	F.Data.DataTable.CreateFromSQL("dtSerHist","con","Select ORDER_NO,ORDER_LINE,SERIAL_NUMBER from V_ITEM_HISTORY where CODE_TRANSACTION = 'O35' and SERIAL_NUMBER <> '' and ORDER_LINE <> ''")
	
	F.Data.DataTable.CreateFromSQL("dtSerJob","con","Select JOB,SUFFIX,Min(SERIAL_START) as MIN_SER,Max(SERIAL_START) as MAX_SER from JOB_SERIAL where JOB <> '' group by JOB,SUFFIX")
	
	V.Local.iCnt.Set(0)

	'Adding serial number field
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtMaster.RowCount--,1)
		F.Intrinsic.String.Build("ORDER_NO = '{0}' and ORDER_LINE = '{1}'",V.DataTable.dtMaster(V.Local.iCnt).SO!FieldValTrim,V.DataTable.dtMaster(V.Local.iCnt).SOLine!FieldValTrim,V.Local.sFilter)
		F.Data.DataView.Create("dtSerHist","dvSerHist",22,V.Local.sFilter,"")
		
		F.Intrinsic.Control.If(V.DataView.dtSerHist!dvSerHist.RowCount,=,0)
			F.Intrinsic.String.Build("JOB = '{0}' and SUFFIX = '{1}'",V.DataTable.dtMaster(V.Local.iCnt).WO!FieldValTrim,V.DataTable.dtMaster(V.Local.iCnt).SUFFIX!FieldValTrim,V.Local.sFilter)
			F.Data.DataView.Create("dtSerJob","dvSerJob",22,V.Local.sFilter,"")
			F.Intrinsic.Control.If(V.DataView.dtSerJob!dvSerJob.RowCount,<>,0)
				F.Intrinsic.Control.If(V.DataView.dtSerJob!dvSerJob(0).MIN_SER!FieldValTrim,=,V.DataView.dtSerJob!dvSerJob(0).MAX_SER!FieldValTrim)
					F.Data.DataTable.SetValue("dtMaster",V.Local.iCnt,"Ser_No",V.DataView.dtSerJob!dvSerJob(0).MIN_SER!FieldValTrim)
				F.Intrinsic.Control.Else
					F.Data.DataTable.SetValue("dtMaster",V.Local.iCnt,"Ser_No","MULTIPLE")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			F.Data.DataView.Close("dtSerJob","dvSerJob")
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.DataView.dtSerHist!dvSerHist.RowCount,<=,1)
				F.Data.DataTable.SetValue("dtMaster",V.Local.iCnt,"Ser_No",V.DataView.dtSerHist!dvSerHist(0).SERIAL_NUMBER!FieldValTrim)
			F.Intrinsic.Control.Else
				F.Data.DataTable.SetValue("dtMaster",V.Local.iCnt,"Ser_No","MULTIPLE")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.Data.DataView.Close("dtSerHist","dvSerHist")
		
	F.Intrinsic.Control.Next(V.Local.iCnt)
	
	V.Local.iCnt.Set(0)

	F.Data.DataTable.CreateFromSQL("dtMulti","con","SELECT * FROM JOB_MULT_PARTS_LN",True)		
	
	'Fill in PO Type
	F.Data.DataTable.AddExpressionColumn("dtMaster","POKey",String,"PO+POLine")
	F.Intrinsic.Control.If(V.Global.bLongPart)
		F.Data.DataTable.AddDisplayPartColumn("dtMaster",0,"SOPart","DISPLAY_PART")
		F.Data.DataTable.CopyColumn("dtMaster","Display_part","PartFriendly")
		F.Data.DataTable.CopyColumn("dtMaster","Display_part","SOPart")
		F.Data.DataTable.CopyColumn("dtMaster","Display_part","WOPart")
	F.Intrinsic.Control.Else
		F.Data.DataTable.AddDisplayPartColumn("dtMaster",0,"SOPart","DISPLAY_PART")
	F.Intrinsic.Control.EndIf
	
	F.Data.Dictionary.CreateFromSQL("dSrc","con","SELECT rtrim(PART), if(CODE_SOURCE='P','PS',IF(CODE_SOURCE='J','PJ',IF(CODE_SOURCE='F','MJ',IF(CODE_SOURCE='M','MS','')))) AS 'CODE_SOURCE' FROM V_INVENTORY_MST2")
	F.Data.Dictionary.SetDefaultReturn("dSrc","")
	F.Data.DataTable.FillFromDictionary("dtMaster","dSRC","GSSPART","CODE_SOURCE")
	F.Data.Dictionary.Close("dSrc")
	'Part ExistsF
	'F.Data.DataTable.AddColumn("dtMaster","PartExists",Boolean,false)
	F.Data.Dictionary.CreateFromSQL("dINVE","con","SELECT rtrim(PART) as 'Part', CONVERT(1,SQL_BIT) as 'Exists' FROM V_INVENTORY_MSTR")
	F.Data.Dictionary.SetDefaultReturn("dINVE","")
	F.Data.DataTable.FillFromDictionary("dtMaster","dINVE","GSSPART","PartExists")
	F.Data.Dictionary.Close("dINVE")
	'Part Onhand quantity
	'F.Data.DataTable.AddColumn("dtMaster","QTY_ONHAND",float,0)
	F.Data.Dictionary.CreateFromSQL("dInv","con","SELECT rtrim(PART) as 'Part', QTY_ONHAND FROM V_INVENTORY_MSTR")
	F.Data.Dictionary.SetDefaultReturn("dInv","0")
	F.Data.DataTable.FillFromDictionary("dtMaster","dInv","GSSPART","QTY_ONHAND")
	F.Data.Dictionary.Close("dInv")
	'Router Complete, need to be on 2017.1
	'F.Data.DataTable.AddColumn("dtMaster","RtrCompl",Boolean,False)
	F.Data.Dictionary.CreateFromSQL("dRtrCompl","con","Select rtrim(Rtr_Num) as 'Rtr-Num',Complete From V_Router_Supp_Hdr Where Complete = 1;")
	F.Data.Dictionary.SetDefaultReturn("dRtrCompl","")
	F.Data.DataTable.FillFromDictionary("dtMaster","dRtrCompl","GSSPART","RtrCompl")
	F.Data.Dictionary.Close("dRtrCompl")
	'Bom Complete
	'F.Data.DataTable.AddColumn("dtMaster","BomCompl",Boolean,False)
	F.Data.Dictionary.CreateFromSQL("dBomCompl","con","Select rtrim(Parent) as 'Parent',Cast(1 As Bit) As Bom_Compl From V_Bom_Mstr Where Sequence_Bom = '0000' And Bom_Complete = 'Y';")
	F.Data.Dictionary.SetDefaultReturn("dBomCompl","")
	F.Data.DataTable.FillFromDictionary("dtMaster","dBomCompl","GSSPART","BomCompl")
	F.Data.Dictionary.Close("dBomCompl")
	'Doc control for part
	F.Data.DataTable.SetValue("dtMaster",-1,"PrtDocCntrl","DCS-OFF")
	F.Data.Dictionary.CreateFromSQL("dDCC","con","Select rtrim(ID) As Part,'DCS-ON' As DCC From Link_Data Where Type = '00030'")
	F.Data.Dictionary.SetDefaultReturn("dDCC","DCS-OFF")
	F.Data.DataTable.FillFromDictionary("dtMaster","dDCC","GSSPart","PrtDocCntrl")
	F.Data.Dictionary.Close("dDCC")
	'Doc control for Job
	F.Data.DataTable.SetValue("dtMaster",-1,"JobDocCntrl","DCS-OFF")
	F.Data.Dictionary.CreateFromSQL("dDCC","con","Select RTRIM(ID) As Part,'DCS-ON' As DCC From Link_Data Where Type = '00020'")
	F.Data.Dictionary.SetDefaultReturn("dDCC","DCS-OFF")
	F.Data.DataTable.FillFromDictionary("dtMaster","dDCC","JS","JobDocCntrl")
	F.Data.Dictionary.Close("dDCC")
	 
	F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.dtMaster.RowCount--,1)
		'Check if there are multi part work orders out there
		F.Intrinsic.String.Build("SO='{0}' AND SO_LINE='{1}0'",V.DataTable.dtMaster(V.Local.i).SO!FieldValTrim,V.DataTable.dtMaster(V.Local.i).SOLINE!FieldValTrim,V.Local.sSearch)
		F.Data.DataTable.Select("dtMulti",V.Local.sSearch,V.Local.sret)
		F.Intrinsic.Control.If(V.Local.sret.Trim,<>,"***NORETURN***")
			F.Intrinsic.String.Split(V.Local.sret,"*!*",V.Local.sret)
			F.Intrinsic.Control.If(V.Local.sret.UBound,>,0)
				F.Data.DataTable.SetValue("dtMaster",V.Local.i,"WO","MULTI")
				F.Data.DataTable.SetValue("dtMaster",V.Local.i,"SUFFIX","CHK")
				F.Data.DataTable.SetValue("dtMaster",V.Local.i,"WOQTY","1")
			F.Intrinsic.Control.Else
				F.Data.DataTable.SetValue("dtMaster",V.Local.i,"WO",V.DataTable.dtMulti(V.Local.sret(0)).WO!FieldValTrim)
				F.Data.DataTable.SetValue("dtMaster",V.Local.i,"SUFFIX",V.DataTable.dtMulti(V.Local.sret(0)).WO_SUFFIX!FieldValTrim)
				F.Data.DataTable.SetValue("dtMaster",V.Local.i,"WOQTY",V.DataTable.dtMulti(V.Local.sret(0)).QTY!FieldValTrim)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		
		'Update the fields with checkmarks
		F.Intrinsic.Control.If(V.DataTable.dtMaster(V.Local.i).PartExists!fieldvaltrim,=,"True")
			F.Data.DataTable.SetValue("dtMaster",V.Local.i,"PartExists",V.Local.sMark)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.DataTable.dtMaster(V.Local.i).RtrCompl!fieldvaltrim,=,"True")
			F.Data.DataTable.SetValue("dtMaster",V.Local.i,"RtrCompl",V.Local.sMark)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.DataTable.dtMaster(V.Local.i).BomCompl!fieldvaltrim,=,"True")
			F.Data.DataTable.SetValue("dtMaster",V.Local.i,"BomCompl",V.Local.sMark)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.i)
	
	F.Data.DataTable.Close("dtMulti")
	
	'6088 - Demoting dtAll to child 
	F.Data.DataTable.CreateFromSQL("dtAll","con","Select CONVERT(0,SQL_BIT) as 'ScheduleWO', '' as 'PrtDocCntrl',   ' ' as 'PartExists', ' ' as 'RtrCompl', ' ' as 'BomCompl', ' ' as 'StatusMsg', A.Date_Order As SOOrderDate, RTrim(B.Name_Customer) As Name_Customer, C.Customer_PO, C.CODE_SORT AS 'CODE_SORT',A.Order_No As SO,Left(A.Record_No,3) As SOLine,A.ORDER_NO+A.RECORD_NO as SO_SOLINE,  RTRIM(A.Part) As SOPart,A.Description, A.Qty_Ordered As SOQty, A.PRICE, A.EXTENSION, A.UM_ORDER, Case A.Flag_Use_Mqd When 'Y' Then E.Cust_Due_Date Else A.Date_Item_Prom End As SODueDate, CONVERT(0,SQL_INTEGER) as 'QTY_ONHAND',  A.QTY_SHIPPED as ShipQTY, G.Job As WO, G.Suffix, Case G.Date_Due When '1900-01-01' Then Null Else G.Date_Due End As WODueDate, Rtrim(A.User_1) as 'User_1', Rtrim(A.User_2) as 'PO', rtrim(A.User_3) as 'POLine', Case When If(J.Date_Due_Line Is Null,M.Date_Due_Line,J.Date_Due_Line) = '1900-01-01' Then Null Else If(J.Date_Due_Line Is Null,M.Date_Due_Line,J.Date_Due_Line) End As PODueDate, C.Salesperson, rtrim(A.Part) as 'PartFriendly', H.Notes,   A.User_4, CAST(CASE WHEN G.FLAG_WO_PRTD = 'Y' OR G.FLAG_WO_PRTD = 'R' THEN 1 ELSE 0 END AS BIT) AS PRINTED, CAST(CASE WHEN G.FLAG_WO_RELEASED = 'Y' THEN 1 ELSE 0 END AS BIT) AS RELEASED, '' as 'JobDocCntrl',  CONVERT(0,SQL_BIT) as 'WOCreated',  '' as 'CODE_SOURCE',  concat(G.JOB,G.SUFFIX) as 'JS',   C.ORDER_SORT_2,RTrim(D.Name) As SPName,A.Line_Type As SOType,A.Location As SOLoc, A.Product_Line, Cast(Case A.Flag_Use_Mqd When 'Y' Then 1 Else 0 End As Bit) As SOShipSched,G.Part As WOPart,G.Location As WOLoc,G.Qty_Order As WOQty,Case G.Scheduled_Due_Date When '1900-01-01' Then Null Else G.Scheduled_Due_Date End As WOSchedDate, Cast(Case G.Date_Closed When '1900-01-01' Then 0 Else 1 End As Bit) As WOClsd,If(J.Part Is Null,M.Part,J.Part) As POPart,If(J.Location Is Null,M.Location,J.Location) As POLoc,ifnull(If(J.Qty_Order Is Null,M.Qty_Order,J.Qty_Order),0) As POQty,  Cast(Case When If(J.Flag_Recv_Close Is Null,M.Flag_Recv_Close,J.Flag_Recv_Close) = 'Y' Then 1 When If(K.Flag_Recv_Closed Is Null,N.Flag_Recv_Closed,K.Flag_Recv_Closed) = 'Y' Then 1 Else 0 End As Bit) As POClsd,'' As POType,'' As Status, A.User_5, rtrim(A.Part) as 'GSSPart',A.Customer,Case A.Flag_Use_Mqd When 'Y' Then E.Qty_Open Else A.Qty_BO End As SOBOQty, RTRIM(A.FLAG_COGS) AS FLAG_COGS,' ' as Ser_No From V_Order_Lines A Left Join V_Customer_Master B On A.Customer = B.Customer Left Join V_Order_Header C On A.Order_No = C.Order_No Left Join V_Salespersons D On C.Salesperson = D.ID Left Join V_OE_Ship_Sched E On A.Order_No = E.Order_No And A.Record_No = E.Order_Line And E.Flag_Closed <> 'Y' Left Join V_Order_To_WO F On A.Order_No = F.Order_No And A.Record_No = F.Order_Line Left Join V_Job_Header G On F.Job = G.Job And F.Suffix = G.Suffix Left Join Gab_4167_SO_Notes H On A.Order_No = H.SO And A.Record_No = Concat(H.SOLINE,0) Left Join V_Sales_Ord_Com I On A.Order_No = I.Order_No And A.Record_No = I.Order_Line Left Join V_PO_Lines J On A.USER_2 = J.PURCHASE_ORDER  And A.USER_3 = J.RECORD_NO Left Join V_PO_Header K On A.USER_2 = K.Purchase_Order Left Join V_PO_Drop_Ship L On A.Order_No = L.Order_No And A.Record_No = L.Order_Line Left Join V_PO_Lines M On L.PO = M.Purchase_Order And L.PO_Line = M.Record_No Left Join V_PO_Header N On M.Purchase_Order = N.Purchase_Order Where SOBOQty >= 0 Order By A.Date_Item_Prom;",True)

	'6088 - Adding serial number field
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtAll.RowCount--,1)
		F.Intrinsic.String.Build("ORDER_NO = '{0}' and ORDER_LINE = '{1}'",V.DataTable.dtAll(V.Local.iCnt).SO!FieldValTrim,V.DataTable.dtAll(V.Local.iCnt).SOLine!FieldValTrim,V.Local.sFilter)
		F.Data.DataView.Create("dtSerHist","dvSerHist",22,V.Local.sFilter,"")
		
		F.Intrinsic.Control.If(V.DataView.dtSerHist!dvSerHist.RowCount,=,0)
			F.Intrinsic.String.Build("JOB = '{0}' and SUFFIX = '{1}'",V.DataTable.dtAll(V.Local.iCnt).WO!FieldValTrim,V.DataTable.dtAll(V.Local.iCnt).SUFFIX!FieldValTrim,V.Local.sFilter)
			F.Data.DataView.Create("dtSerJob","dvSerJob",22,V.Local.sFilter,"")
			F.Intrinsic.Control.If(V.DataView.dtSerJob!dvSerJob.RowCount,<>,0)
				F.Intrinsic.Control.If(V.DataView.dtSerJob!dvSerJob(0).MIN_SER!FieldValTrim,=,V.DataView.dtSerJob!dvSerJob(0).MAX_SER!FieldValTrim)
					F.Data.DataTable.SetValue("dtAll",V.Local.iCnt,"Ser_No",V.DataView.dtSerJob!dvSerJob(0).MIN_SER!FieldValTrim)
				F.Intrinsic.Control.Else
					F.Data.DataTable.SetValue("dtAll",V.Local.iCnt,"Ser_No","MULTIPLE")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			F.Data.DataView.Close("dtSerJob","dvSerJob")
		F.Intrinsic.Control.Else
			F.Intrinsic.Control.If(V.DataView.dtSerHist!dvSerHist.RowCount,<=,1)
				F.Data.DataTable.SetValue("dtAll",V.Local.iCnt,"Ser_No",V.DataView.dtSerHist!dvSerHist(0).SERIAL_NUMBER!FieldValTrim)
			F.Intrinsic.Control.Else
				F.Data.DataTable.SetValue("dtAll",V.Local.iCnt,"Ser_No","MULTIPLE")
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		F.Data.DataView.Close("dtSerHist","dvSerHist")
		
	F.Intrinsic.Control.Next(V.Local.iCnt)
	
	F.Data.DataTable.CreateFromSQL("dtMulti","con","SELECT * FROM JOB_MULT_PARTS_LN",true)		
	
	'Fill in PO Type
	F.Data.DataTable.AddExpressionColumn("dtAll","POKey",String,"PO+POLine")
	F.Intrinsic.Control.If(V.Global.bLongPart)
		F.Data.DataTable.AddDisplayPartColumn("dtAll",0,"SOPart","DISPLAY_PART")
		F.Data.DataTable.CopyColumn("dtAll","Display_part","PartFriendly")
		F.Data.DataTable.CopyColumn("dtAll","Display_part","SOPart")
		F.Data.DataTable.CopyColumn("dtAll","Display_part","WOPart")
	F.Intrinsic.Control.Else
		F.Data.DataTable.AddDisplayPartColumn("dtAll",0,"SOPart","DISPLAY_PART")
	F.Intrinsic.Control.EndIf
	
	F.Data.Dictionary.CreateFromSQL("dSrc","con","SELECT rtrim(PART), if(CODE_SOURCE='P','PS',IF(CODE_SOURCE='J','PJ',IF(CODE_SOURCE='F','MJ',IF(CODE_SOURCE='M','MS','')))) AS 'CODE_SOURCE' FROM V_INVENTORY_MST2")
	F.Data.Dictionary.SetDefaultReturn("dSrc","")
	F.Data.DataTable.FillFromDictionary("dtAll","dSRC","GSSPART","CODE_SOURCE")
	F.Data.Dictionary.Close("dSrc")
	'Part ExistsF
	'F.Data.DataTable.AddColumn("dtAll","PartExists",Boolean,false)
	F.Data.Dictionary.CreateFromSQL("dINVE","con","SELECT rtrim(PART) as 'Part', CONVERT(1,SQL_BIT) as 'Exists' FROM V_INVENTORY_MSTR")
	F.Data.Dictionary.SetDefaultReturn("dINVE","")
	F.Data.DataTable.FillFromDictionary("dtAll","dINVE","GSSPART","PartExists")
	F.Data.Dictionary.Close("dINVE")
	'Part Onhand quantity
	'F.Data.DataTable.AddColumn("dtAll","QTY_ONHAND",float,0)
	F.Data.Dictionary.CreateFromSQL("dInv","con","SELECT rtrim(PART) as 'Part', QTY_ONHAND FROM V_INVENTORY_MSTR")
	F.Data.Dictionary.SetDefaultReturn("dInv","0")
	F.Data.DataTable.FillFromDictionary("dtAll","dInv","GSSPART","QTY_ONHAND")
	F.Data.Dictionary.Close("dInv")
	'Router Complete, need to be on 2017.1
	'F.Data.DataTable.AddColumn("dtAll","RtrCompl",Boolean,False)
	F.Data.Dictionary.CreateFromSQL("dRtrCompl","con","Select rtrim(Rtr_Num) as 'Rtr-Num',Complete From V_Router_Supp_Hdr Where Complete = 1;")
	F.Data.Dictionary.SetDefaultReturn("dRtrCompl","")
	F.Data.DataTable.FillFromDictionary("dtAll","dRtrCompl","GSSPART","RtrCompl")
	F.Data.Dictionary.Close("dRtrCompl")
	'Bom Complete
	'F.Data.DataTable.AddColumn("dtAll","BomCompl",Boolean,False)
	F.Data.Dictionary.CreateFromSQL("dBomCompl","con","Select rtrim(Parent) as 'Parent',Cast(1 As Bit) As Bom_Compl From V_Bom_Mstr Where Sequence_Bom = '0000' And Bom_Complete = 'Y';")
	F.Data.Dictionary.SetDefaultReturn("dBomCompl","")
	F.Data.DataTable.FillFromDictionary("dtAll","dBomCompl","GSSPART","BomCompl")
	F.Data.Dictionary.Close("dBomCompl")
	'Doc control for part
	F.Data.DataTable.SetValue("dtAll",-1,"PrtDocCntrl","DCS-OFF")
	F.Data.Dictionary.CreateFromSQL("dDCC","con","Select rtrim(ID) As Part,'DCS-ON' As DCC From Link_Data Where Type = '00030'")
	F.Data.Dictionary.SetDefaultReturn("dDCC","DCS-OFF")
	F.Data.DataTable.FillFromDictionary("dtAll","dDCC","GSSPart","PrtDocCntrl")
	F.Data.Dictionary.Close("dDCC")
	'Doc control for Job
	F.Data.DataTable.SetValue("dtAll",-1,"JobDocCntrl","DCS-OFF")
	F.Data.Dictionary.CreateFromSQL("dDCC","con","Select RTRIM(ID) As Part,'DCS-ON' As DCC From Link_Data Where Type = '00020'")
	F.Data.Dictionary.SetDefaultReturn("dDCC","DCS-OFF")
	F.Data.DataTable.FillFromDictionary("dtAll","dDCC","JS","JobDocCntrl")
	F.Data.Dictionary.Close("dDCC")
	 
	F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.dtAll.RowCount--,1)
		'Check if there are multi part work orders out there
		F.Intrinsic.String.Build("SO='{0}' AND SO_LINE='{1}0'",V.DataTable.dtAll(V.Local.i).SO!FieldValTrim,V.DataTable.dtAll(V.Local.i).SOLINE!FieldValTrim,V.Local.sSearch)
		F.Data.DataTable.Select("dtMulti",V.Local.sSearch,V.Local.sret)
		F.Intrinsic.Control.If(V.Local.sret.Trim,<>,"***NORETURN***")
			F.Intrinsic.String.Split(V.Local.sret,"*!*",V.Local.sret)
			F.Intrinsic.Control.If(V.Local.sret.UBound,>,0)
				F.Data.DataTable.SetValue("dtAll",V.Local.i,"WO","MULTI")
				F.Data.DataTable.SetValue("dtAll",V.Local.i,"SUFFIX","CHK")
				F.Data.DataTable.SetValue("dtAll",V.Local.i,"WOQTY","1")
			F.Intrinsic.Control.Else
				F.Data.DataTable.SetValue("dtAll",V.Local.i,"WO",V.DataTable.dtMulti(V.Local.sret(0)).WO!FieldValTrim)
				F.Data.DataTable.SetValue("dtAll",V.Local.i,"SUFFIX",V.DataTable.dtMulti(V.Local.sret(0)).WO_SUFFIX!FieldValTrim)
				F.Data.DataTable.SetValue("dtAll",V.Local.i,"WOQTY",V.DataTable.dtMulti(V.Local.sret(0)).QTY!FieldValTrim)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		
		'Update the fields with checkmarks
		F.Intrinsic.Control.If(V.DataTable.dtAll(V.Local.i).PartExists!FieldValTrim,=,"True")
			F.Data.DataTable.SetValue("dtAll",V.Local.i,"PartExists",V.Local.sMark)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.DataTable.dtAll(V.Local.i).RtrCompl!FieldValTrim,=,"True")
			F.Data.DataTable.SetValue("dtAll",V.Local.i,"RtrCompl",V.Local.sMark)
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.If(V.DataTable.dtAll(V.Local.i).BomCompl!FieldValTrim,=,"True")
			F.Data.DataTable.SetValue("dtAll",V.Local.i,"BomCompl",V.Local.sMark)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.i)
	
	F.Data.DataTable.Close("dtMulti")
	
	F.Data.DataTable.RemoveColumn("dtMaster","POREC2")
	
	F.Data.DataView.Create("dtAll","dvAll",22,"SOShipSched = 1","")
	
	F.Data.DataView.ToDataTable("dtall","dvAll","dtMaster$dtAll",True)
	
	'6088 Creating Parent/Child datatable relationship
	F.Data.Datatable.AddRelation("dtMaster","SO_SOLine","dtMaster$dtAll","SO_SOLine","dtMasterAll")
	
	F.Data.DataView.Create("dtMaster","dvMasterAll",22)
	
	F.Data.DataView.Create("dtMaster$dtAll","dvCombined",22)

	F.Intrinsic.Control.CallSub(LoadGVAll)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadDTAll.End

Program.Sub.LoadGVAll.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iCnt.Declare
	V.Local.sStatus.Declare
	V.Local.sStatus2.Declare
	V.Local.sSelect.Declare
	V.Local.sStatusMSG.Declare
	V.Local.lret.Declare
	V.Local.lCol.Declare
	V.Local.dtempdate.Declare
	
	'6088
	Gui.FrmOrderReview.GsGCAllOpen.AddGridviewFromDataview("gvMaster","dtMaster","dvMasterAll")
	Gui.FrmOrderReview.GsGCAllOpen.AddGridViewFromDataView("gvAll","dtMaster","dvCombined")
	Gui.FrmOrderReview.GsGCAllOpen.SuspendLayout()
	Gui.FrmOrderReview.GsGCAllOpen.SetGridViewProperty("gvMaster","OptionsViewShowGroupPanel",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetGridViewProperty("gvMaster","MultiSelect",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetGridViewProperty("gvMaster","AllowSort",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetGridViewProperty("gvMaster","AllowFilter",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetGridViewProperty("gvMaster","OptionsDetailShowDetailTabs",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetGridViewProperty("gvMaster","OptionsViewColumnAutoWidth",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetGridviewProperty("gvMaster","OptionsFindAlwaysVisible",True)
	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","ScheduleWO","Fixed","Left")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PrtDocCntrl","Fixed","Left")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PartExists","Fixed","Left")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","RtrCompl","Fixed","Left")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","BomCompl","Fixed","Left")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","StatusMsg","Fixed","Left")
	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Customer","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Salesperson","Visible",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOClsd","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POClsd","Visible",False)
'	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","RtrCompl","Visible",False)
'	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","BomCompl","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","DISPLAY_PART","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","GSSPart","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOLOC","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Product_Line","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOShipSched","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOPart","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOLoc","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOQty","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOSchedDate","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WODueDate","Visible",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POPart","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POLoc","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POQty","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PODueDate","Visible",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POClsd","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POType","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Status","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","User_4","Visible",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","User_5","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOBOQty","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOType","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","UM_ORDER","Visible",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PRINTED","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","CODE_SOURCE","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","RELEASED","Visible",False)
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PROC","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOCreated","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POKEY","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","JS","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","ORDER_SORT_2","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SPNAME","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","FLAG_COGS","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SO_SOLine","Visible",False)
	
	Gui.FrmOrderReview.GsGCAllOpen.ColumnEdit("gvMaster","Printed","EditorButton","Print")
	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Customer","Caption","Customer")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Name_Customer","Caption","Customer Name")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Customer_PO","Caption","Customer PO")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SO","Caption","SO")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOLine","Caption","SO Line")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Salesperson","Caption","Salesperson")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SPName","Caption","SP Name")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOType","Caption","SO Type")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOPart","Caption","SO Part")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOLoc","Caption","SO Loc")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Product_Line","Caption","PL")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Description","Caption","Description")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOQty","Caption","SO Qty")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOBOQty","Caption","SO BO Qty")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOOrderDate","Caption","SO Entered")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SODueDate","Caption","SO Due Date")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOShipSched","Caption","SO Ship Sched")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WO","Caption","WO")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Printed","Caption","Print WO")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Released","Caption","Released")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Price","Caption","Price")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Extension","Caption","Extension")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","FLAG_COGS","Caption","COGS")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Ser_No","Caption","Serial Number")
	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Suffix","Caption","Suffix")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOPart","Caption","WO Part")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOLoc","Caption","WO Loc")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOQty","Caption","WO Qty")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOSchedDate","Caption","WO Sched Date")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WODueDate","Caption","WO Due Date")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOClsd","Caption","WO Clsd")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PO","Caption","PO")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POLine","Caption","PO Line")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POPart","Caption","PO Part")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POLoc","Caption","PO Loc")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POQty","Caption","PO Qty")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PODueDate","Caption","PO Due Date")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POClsd","Caption","PO Clsd")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POType","Caption","PO Type")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Status","Caption","Code")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Notes","Caption","Notes")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","User_1","Caption","User 1")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","User_4","Caption","User 4")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","User_5","Caption","User 5")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","RtrCompl","Caption","Rtr")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","BomCompl","Caption","Bom")	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PartFriendly","Caption","Part Friendly")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","ScheduleWO","Caption","Select")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOCreated","Caption","Proc.")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Description","Caption","SO Line Description")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","CODE_SORT","Caption","SO Description")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","ORDER_SORT_2","Caption","Description 2")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","CODE_SOURCE","Caption","Source")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","QTY_ONHAND","Caption","QOH")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PartExists","Caption","Part")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","UM_ORDER","Caption","UM SO")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","ShipQTY","Caption","Shipped")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","StatusMsg","Caption","Status")
	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","ScheduleWO","MinWidth","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOOrderDate","Width","125")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOOrderDate","MinWidth","125")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","ScheduleWO","Width","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Customer","MinWidth","65")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Name_Customer","MinWidth","150")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Name_Customer","Width","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Customer_PO","MinWidth","120")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Customer_PO","Width","120")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SO","MinWidth","65")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOLine","MinWidth","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Salesperson","MinWidth","65")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SPName","MinWidth","150")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOType","MinWidth","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOPart","MinWidth","150")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOPart","Width","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOLoc","MinWidth","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Product_Line","MinWidth","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Description","MinWidth","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOQty","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOBOQty","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOOrderDate","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SODueDate","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOShipSched","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WO","MinWidth","65")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Suffix","MinWidth","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOPart","MinWidth","150")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOLoc","MinWidth","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOQty","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOSchedDate","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WODueDate","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOClsd","MinWidth","65")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PO","MinWidth","65")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POLine","MinWidth","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POPart","MinWidth","150")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POLoc","MinWidth","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POQty","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PODueDate","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POClsd","MinWidth","65")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POType","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Status","MinWidth","65")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Notes","MinWidth","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","User_1","MinWidth","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","User_4","MinWidth","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","User_5","MinWidth","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","RtrCompl","MinWidth","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","RtrCompl","Width","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","BomCompl","MinWidth","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","BomCompl","Width","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","ScheduleWO","MinWidth","40")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PartFriendly","MinWidth","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOCreated","MinWidth","45")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOCreated","Width","45")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","CODE_SORT","MinWidth","150")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","ORDER_SORT_2","MinWidth","150")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","CODE_SOURCE","MinWidth","75")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","QTY_ONHAND","MinWidth","65")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","ShipQty","Width","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","ShipQty","MinWidth","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PartExists","MinWidth","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PartExists","Width","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Printed","MinWidth","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Printed","Width","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Released","MinWidth","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Released","Width","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","UM_ORDER","MinWidth","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","UM_ORDER","Width","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","StatusMsg","MinWidth","75")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","StatusMsg","Width","75")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","FLAG_COGS","MinWidth","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","FLAG_COGS","Width","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Ser_No","MinWidth","150")

	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Customer","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Name_Customer","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Customer_PO","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SO","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOLine","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Salesperson","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SPName","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOType","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOPart","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOLoc","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Product_Line","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Description","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOQty","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOBOQty","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOOrderDate","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SODueDate","AllowEdit",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOShipSched","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WO","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Suffix","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOPart","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOLoc","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOQty","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOSchedDate","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WODueDate","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOClsd","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PO","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POLine","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POPart","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POLoc","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POQty","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PODueDate","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POClsd","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POType","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Status","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Notes","AllowEdit",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","User_1","AllowEdit",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","User_4","AllowEdit",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","User_5","AllowEdit",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","RtrCompl","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","BomCompl","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","ScheduleWO","AllowEdit",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","CODE_SORT","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","ORDER_SORT_2","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","CODE_SOURCE","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","QTY_ONHAND","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PartExists","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Released","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Printed","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","UM_ORDER","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","StatusMsg","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PRICE","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","EXTENSION","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","FLAG_COGS","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Ser_No","AllowEdit",False)

	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Notes","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","User_1","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","User_4","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","User_5","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","ScheduleWO","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SODueDate","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","CODE_SORT","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","ORDER_SORT_2","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","CODE_SOURCE","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","QTY_ONHAND","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PartExists","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Printed","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Released","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","StatusMsg","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PRICE","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","EXTENSION","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Ser_No","ReadOnly",True)

	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Customer","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Name_Customer","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Customer_PO","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SO","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOLine","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Salesperson","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SPName","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOType","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOPart","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOLoc","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Product_Line","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Description","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOQty","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOBOQty","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOOrderDate","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SODueDate","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOShipSched","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WO","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Suffix","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOPart","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOLoc","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOQty","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOSchedDate","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WODueDate","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOClsd","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PO","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POLine","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POPart","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POLoc","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POQty","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PODueDate","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POClsd","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POType","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Status","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Notes","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","User_1","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","User_4","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","User_5","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","RtrCompl","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","BomCompl","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","ScheduleWO","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PartFriendly","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOCreated","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","CODE_SORT","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","ORDER_SORT_2","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","CODE_SOURCE","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","QTY_ONHAND","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","ShipQTY","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PartExists","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","RELEASED","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PRINTED","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","UM_ORDER","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","StatusMsg","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PRICE","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","EXTENSION","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","FLAG_COGS","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Ser_No","HeaderFontBold",True)

	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Customer","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Name_Customer","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Customer_PO","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SO","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOLine","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Salesperson","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SPName","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOType","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOPart","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOLoc","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Product_Line","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Description","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOQty","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOBOQty","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOOrderDate","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SODueDate","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOShipSched","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WO","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Suffix","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOPart","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOLoc","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOQty","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOSchedDate","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WODueDate","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOClsd","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PO","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POLine","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POPart","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POLoc","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POQty","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PODueDate","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POClsd","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POType","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Status","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Notes","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","User_1","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","User_4","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","User_5","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","RtrCompl","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","BomCompl","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","ScheduleWO","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PartFriendly","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOCreated","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","CODE_SORT","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","ORDER_SORT_2","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","CODE_SOURCE","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","QTY_ONHAND","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PartExists","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","ShipQty","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Printed","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Released","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","UM_ORDER","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","StatusMsg","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PRICE","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","EXTENSION","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","FLAG_COGS","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Ser_No","HeaderHAlignment","Center")

	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Customer","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SO","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOLine","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOQty","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Salesperson","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SPName","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOType","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOLoc","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Product_Line","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOOrderDate","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SODueDate","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOShipSched","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WO","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Suffix","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOLoc","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOSchedDate","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WODueDate","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOClsd","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PO","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POLine","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POLoc","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PODueDate","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POClsd","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POType","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Status","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","RtrCompl","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","BomCompl","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Code_source","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PartExists","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PRINTED","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","RELEASED","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","UM_ORDER","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","QTY_ONHAND","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","ShipQty","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","FLAG_COGS","CellHAlignment","Center")

	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SO","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOPart","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOLoc","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WO","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Suffix","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOPart","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOLoc","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PO","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POLine","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POPart","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POLoc","CellForeColor","Blue")
	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","Notes","CellBackColor","LightYellow")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","User_1","CellBackColor","LightYellow")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","User_4","CellBackColor","LightYellow")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","User_5","CellBackColor","LightYellow")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SODueDate","CellBackColor","LightYellow")

	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOOrderDate","DisplayCustomDatetime","d")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SODueDate","DisplayCustomDatetime","d")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOShipSched","DisplayCustomDatetime","d")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOSchedDate","DisplayCustomDatetime","d")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WODueDate","DisplayCustomDatetime","d")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PODueDate","DisplayCustomDatetime","d")
	
'	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PRICE","DisplayCustomNumeric","$#,###,###,##0.00")
'	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","EXTENSION","DisplayCustomNumeric","$#,###,###,##0.00")
'	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOQty","DisplayCustomNumeric","#,###,###,##0.00")
'	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","SOBOQty","DisplayCustomNumeric","#,###,###,##0.00")
'	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","QTY_ONHAND","DisplayCustomNumeric","#,###,###,##0.00")
'	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","WOQty","DisplayCustomNumeric","#,###,###,##0.00")
'	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","POQty","DisplayCustomNumeric","#,###,###,##0.00")
'	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","ShipQty","DisplayCustomNumeric","#,###,###,##0.00")
	
	Gui.FrmOrderReview.GsGCAllOpen.AddSummaryItem("gvMaster","EXTENSION","SUM_EXTENSION","Sum","","","n")
	
	'Gui.FrmOrderReview.GsGCAll.GetColumnIndexByName("gvMaster","RtrCompl",V.Local.lCol)
	
	'Part Document Control
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PrtDocCntrl","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PrtDocCntrl","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PrtDocCntrl","Icon","DCS-OFF")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PrtDocCntrl","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PrtDocCntrl","Caption","Part Doc")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PrtDocCntrl","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PrtDocCntrl","MinWidth","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PrtDocCntrl","Width","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","PrtDocCntrl","Visible",True)
	F.Data.DataTable.Select("dtMaster$dtAll","PrtDocCntrl = 'DCS-ON'",V.Local.sSelect)
	F.Intrinsic.Control.If(V.Local.sSelect.IsNotNoReturn)
		F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sSelect.UBound,1)
			Gui.FrmOrderReview.GsGCAllOpen.GetColumnIndexByName("gvMaster","PrtDocCntrl",V.Local.lret)
			Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvMaster",V.Local.lret,V.Local.sSelect(V.Local.iCnt),"Icon","DCS-ON")
		F.Intrinsic.Control.Next(V.Local.iCnt)
	F.Intrinsic.Control.EndIf
	
	'Job Document Control
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","JobDocCntrl","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","JobDocCntrl","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","JobDocCntrl","Icon","DCS-OFF")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","JobDocCntrl","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","JobDocCntrl","Caption","Job Doc")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","JobDocCntrl","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","JobDocCntrl","MinWidth","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","JobDocCntrl","Width","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvMaster","JobDocCntrl","Visible",False)
	F.Data.DataTable.Select("dtMaster$dtAll","JobDocCntrl = 'DCS-ON'",V.Local.sSelect)
	F.Intrinsic.Control.If(V.Local.sSelect.IsNotNoReturn)
		F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sSelect.UBound,1)
			Gui.FrmOrderReview.GsGCAllOpen.GetColumnIndexByName("gvMaster","JobDocCntrl",V.Local.lret)
			Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvMaster",V.Local.lret,V.Local.sSelect(V.Local.iCnt),"Icon","DCS-ON")
		F.Intrinsic.Control.Next(V.Local.iCnt)
	F.Intrinsic.Control.EndIf
	
	Gui.FrmOrderReview.GsGCAllOpen.GetColumnIndexByName("gvMaster","StatusMsg",V.Local.lCol)
	'Gui.FrmOrderReview.progressBar1.Min(0)
	'Gui.FrmOrderReview.progressBar1.Max(V.DataTable.dtMaster$dtAll.RowCount)
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtMaster$dtAll.RowCount--,1)
		'Gui.FrmOrderReview.progressBar1.Value(V.Local.iCnt)
		V.Local.sStatus.Set("")
		F.Intrinsic.Control.If(V.DataTable.dtMaster$dtAll(V.Local.iCnt).WO!FieldValTrim,=,"")
		F.Intrinsic.Control.AndIf(V.DataTable.dtMaster$dtAll(V.Local.iCnt).PO!FieldValTrim,=,"")
			V.Local.sStatus.Set("1")
			V.Local.sStatusMSG.Set("No WO/PO")
			Gui.FrmOrderReview.GsGCAllOpen.setcellappearance("gvMaster",V.Local.lCol,V.Local.iCnt,"BackColor","White")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvMaster",V.Local.lCol,V.Local.iCnt,"HAlignment","Center")
		F.Intrinsic.Control.ElseIf(V.DataTable.dtMaster$dtAll(V.Local.iCnt).WO!FieldValTrim,<>,"")
		F.Intrinsic.Control.AndIf(V.DataTable.dtMaster$dtAll(V.Local.iCnt).PO!FieldValTrim,=,"")
			'Part
			F.Intrinsic.Control.If(V.DataTable.dtMaster$dtAll(V.Local.iCnt).SOPart!FieldValTrim,<>,V.DataTable.dtMaster$dtAll(V.Local.iCnt).WOPart!FieldValTrim)
			F.Intrinsic.Control.AndIf(V.DataTable.dtMaster$dtAll(V.Local.iCnt).SOLoc!FieldValTrim,<>,V.DataTable.dtMaster$dtAll(V.Local.iCnt).WOLoc!FieldValTrim)
				V.Local.sStatus.Set("2")
				V.Local.sStatusMSG.Set("Part Mismatch")
				Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvMaster",V.Local.lCol,V.Local.iCnt,"BackColor","LightYellow")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvMaster",V.Local.lCol,V.Local.iCnt,"HAlignment","Center")
				'Gui.FrmOrderReview.GsGCAllOpen.SetRowAppearance("gvMaster",V.Local.iCnt,"BackColor","LightYellow")
			F.Intrinsic.Control.EndIf
			'Due Date
			F.Intrinsic.Control.If(V.DataTable.dtMaster$dtAll(V.Local.iCnt).WODueDate!FieldVal,=,"")
				F.Data.DataTable.SetValue("dtMaster$dtAll",V.Local.iCnt,"WODueDate",V.Local.dtempdate)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.DataTable.dtMaster$dtAll(V.Local.iCnt).SODueDate!FieldVal,<,V.DataTable.dtMaster$dtAll(V.Local.iCnt).WODueDate!FieldVal)
				F.Intrinsic.Control.If(V.Local.sStatus,=,"")
					V.Local.sStatus.Set("3")
					V.Local.sStatusMSG.Set("Date Mismatch")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvMaster",V.Local.lCol,V.Local.iCnt,"BackColor","Plum")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvMaster",V.Local.lCol,V.Local.iCnt,"HAlignment","Center")
					'Gui.FrmOrderReview.GsGCAllOpen.SetRowAppearance("gvMaster",V.Local.iCnt,"BackColor","Plum")
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("{0}*!*3",V.Local.sStatus,V.Local.sStatus)
				F.Intrinsic.Control.EndIf
				
			F.Intrinsic.Control.EndIf
			'Qty
			F.Intrinsic.Control.If(V.DataTable.dtMaster$dtAll(V.Local.iCnt).SOQty!FieldVal,<>,V.DataTable.dtMaster$dtAll(V.Local.iCnt).WOQty!FieldVal)
				F.Intrinsic.Control.If(V.Local.sStatus,=,"")
					V.Local.sStatus.Set("4")
					V.Local.sStatusMSG.Set("Qty Mismatch")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvMaster",V.Local.lCol,V.Local.iCnt,"BackColor","LightPink")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvMaster",V.Local.lCol,V.Local.iCnt,"HAlignment","Center")
					'Gui.FrmOrderReview.GsGCAllOpen.SetRowAppearance("gvMaster",V.Local.iCnt,"BackColor","LightPink")
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("{0}*!*4",V.Local.sStatus,V.Local.sStatus)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			'No Issues
			F.Intrinsic.Control.If(V.Local.sStatus,=,"")
				V.Local.sStatus.Set("0")
				V.Local.sStatusMSG.Set("No Issues")
				Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvMaster",V.Local.lCol,V.Local.iCnt,"BackColor","LightGreen")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvMaster",V.Local.lCol,V.Local.iCnt,"HAlignment","Center")
				'Gui.FrmOrderReview.GsGCAllOpen.SetRowAppearance("gvMaster",V.Local.iCnt,"BackColor","LightGreen")
			F.Intrinsic.Control.Else
				'Multiple Issues
				F.Intrinsic.String.Split(V.Local.sStatus,"*!*",V.Local.sStatus2)
				F.Intrinsic.Control.If(V.Local.sStatus2.UBound,>,0)
					V.Local.sStatusMSG.Set("Multi Issue")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvMaster",V.Local.lCol,V.Local.iCnt,"BackColor","Red")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvMaster",V.Local.lCol,V.Local.iCnt,"HAlignment","Center")
					'Gui.FrmOrderReview.GsGCAllOpen.SetRowAppearance("gvMaster",V.Local.iCnt,"BackColor","Red")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.ElseIf(V.DataTable.dtMaster$dtAll(V.Local.iCnt).WO!FieldValTrim,=,"")
		F.Intrinsic.Control.AndIf(V.DataTable.dtMaster$dtAll(V.Local.iCnt).PO!FieldValTrim,<>,"")
			'Part
			F.Intrinsic.Control.If(V.DataTable.dtMaster$dtAll(V.Local.iCnt).SOPart!FieldValTrim,<>,V.DataTable.dtMaster$dtAll(V.Local.iCnt).POPart!FieldValTrim)
			F.Intrinsic.Control.AndIf(V.DataTable.dtMaster$dtAll(V.Local.iCnt).SOLoc!FieldValTrim,<>,V.DataTable.dtMaster$dtAll(V.Local.iCnt).POLoc!FieldValTrim)
				V.Local.sStatus.Set("2")
				V.Local.sStatusMSG.Set("Part Mismatch")
				Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvMaster",V.Local.lCol,V.Local.iCnt,"BackColor","LightYellow")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvMaster",V.Local.lCol,V.Local.iCnt,"HAlignment","Center")
				'Gui.FrmOrderReview.GsGCAllOpen.SetRowAppearance("gvMaster",V.Local.iCnt,"BackColor","LightYellow")
			F.Intrinsic.Control.EndIf
			'Due Date
			F.Intrinsic.Control.If(V.DataTable.dtMaster$dtAll(V.Local.iCnt).PODueDate!FieldValTRIM,<>,"")
				F.Intrinsic.Control.If(V.DataTable.dtMaster$dtAll(V.Local.iCnt).SODueDate!FieldVal,<,V.DataTable.dtMaster$dtAll(V.Local.iCnt).PODueDate!FieldVal)
					F.Intrinsic.Control.If(V.Local.sStatus,=,"")
						V.Local.sStatus.Set("3")
						V.Local.sStatusMSG.Set("Date Mismatch")
						'Gui.FrmOrderReview.GsGCAllOpen.SetRowAppearance("gvMaster",V.Local.iCnt,"BackColor","Plum")
						Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvMaster",V.Local.lCol,V.Local.iCnt,"BackColor","Plum")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvMaster",V.Local.lCol,V.Local.iCnt,"HAlignment","Center")
					F.Intrinsic.Control.Else
						F.Intrinsic.String.Build("{0}*!*3",V.Local.sStatus,V.Local.sStatus)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			'Qty
			F.Intrinsic.Control.If(V.DataTable.dtMaster$dtAll(V.Local.iCnt).SOQty!FieldVal,<>,V.DataTable.dtMaster$dtAll(V.Local.iCnt).POQty!FieldVal)
				F.Intrinsic.Control.If(V.Local.sStatus,=,"")
					V.Local.sStatus.Set("4")
					V.Local.sStatusMSG.Set("Qty Mismatch")
					'Gui.FrmOrderReview.GsGCAllOpen.SetRowAppearance("gvMaster",V.Local.iCnt,"BackColor","LightPink")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvMaster",V.Local.lCol,V.Local.iCnt,"BackColor","LightPink")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvMaster",V.Local.lCol,V.Local.iCnt,"HAlignment","Center")
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("{0}*!*4",V.Local.sStatus,V.Local.sStatus)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			'No Issues
			F.Intrinsic.Control.If(V.Local.sStatus,=,"")
				V.Local.sStatus.Set("0")
				V.Local.sStatusMSG.Set("No Issues")
				'Gui.FrmOrderReview.GsGCAllOpen.SetRowAppearance("gvMaster",V.Local.iCnt,"BackColor","LightGreen")
				Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvMaster",V.Local.lCol,V.Local.iCnt,"BackColor","LightGreen")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvMaster",V.Local.lCol,V.Local.iCnt,"HAlignment","Center")
			F.Intrinsic.Control.Else
				'Multiple Issues
				F.Intrinsic.String.Split(V.Local.sStatus,"*!*",V.Local.sStatus2)
				F.Intrinsic.Control.If(V.Local.sStatus2.UBound,>,0)
					'Gui.FrmOrderReview.GsGCAllOpen.SetRowAppearance("gvMaster",V.Local.iCnt,"BackColor","Red")
					V.Local.sStatusMSG.Set("Multi Issue")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvMaster",V.Local.lCol,V.Local.iCnt,"BackColor","Red")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvMaster",V.Local.lCol,V.Local.iCnt,"HAlignment","Center")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		'Shipped > SO QTY trumps all
		F.Intrinsic.Control.If(V.DataTable.dtMaster$dtAll(V.Local.iCnt).ShipQty!FieldVal,>=,V.DataTable.dtMaster$dtAll(V.Local.iCnt).SOQty!FieldVal)
			V.Local.sStatus.Set("5")
			V.Local.sStatusMSG.Set("Ready to Invoice")
			'Gui.FrmOrderReview.GsGCAllOpen.SetRowAppearance("gvMaster",V.Local.iCnt,"BackColor","LightBlue")
			Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvMaster",V.Local.lCol,V.Local.iCnt,"BackColor","LightBlue")
			Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvMaster",V.Local.lCol,V.Local.iCnt,"HAlignment","Center")
		F.Intrinsic.Control.EndIf
		F.Data.DataTable.SetValue("dtMaster$dtAll",V.Local.iCnt,"Status",V.Local.sStatus)
		F.Data.DataTable.SetValue("dtMaster$dtAll",V.Local.iCnt,"StatusMsg",V.Local.sStatusMSG)

	F.Intrinsic.Control.Next(V.Local.iCnt)
	
	Gui.FrmOrderReview.GsGCAllOpen.SetGridViewProperty("gvAll","OptionsViewShowGroupPanel",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetGridViewProperty("gvAll","MultiSelect",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetGridViewProperty("gvAll","AllowSort",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetGridViewProperty("gvAll","AllowFilter",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetGridViewProperty("gvAll","OptionsDetailShowDetailTabs",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetGridViewProperty("gvAll","OptionsViewColumnAutoWidth",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetGridviewProperty("gvall","OptionsFindAlwaysVisible",True)
	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ScheduleWO","Fixed","Left")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PrtDocCntrl","Fixed","Left")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartExists","Fixed","Left")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RtrCompl","Fixed","Left")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","BomCompl","Fixed","Left")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","StatusMsg","Fixed","Left")
	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Salesperson","Visible",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOClsd","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POClsd","Visible",False)
'	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RtrCompl","Visible",False)
'	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","BomCompl","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","DISPLAY_PART","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","GSSPart","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLOC","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Product_Line","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOShipSched","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOPart","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOLoc","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOQty","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOSchedDate","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WODueDate","Visible",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POPart","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLoc","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POQty","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PODueDate","Visible",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POClsd","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POType","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Status","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_4","Visible",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_5","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOBOQty","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOType","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","UM_ORDER","Visible",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PRINTED","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SOURCE","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RELEASED","Visible",False)
	'Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PROC","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOCreated","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POKEY","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","JS","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ORDER_SORT_2","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SPNAME","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","FLAG_COGS","Visible",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SO_SOLine","Visible",False)
	
	Gui.FrmOrderReview.GsGCAllOpen.ColumnEdit("gvAll","Printed","EditorButton","Print")
	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer","Caption","Customer")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Name_Customer","Caption","Customer Name")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer_PO","Caption","Customer PO")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SO","Caption","SO")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLine","Caption","SO Line")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Salesperson","Caption","Salesperson")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SPName","Caption","SP Name")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOType","Caption","SO Type")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOPart","Caption","SO Part")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLoc","Caption","SO Loc")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Product_Line","Caption","PL")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Description","Caption","Description")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOQty","Caption","SO Qty")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOBOQty","Caption","SO BO Qty")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOOrderDate","Caption","SO Entered")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SODueDate","Caption","SO Due Date")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOShipSched","Caption","SO Ship Sched")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WO","Caption","WO")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Printed","Caption","Print WO")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Released","Caption","Released")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Price","Caption","Price")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Extension","Caption","Extension")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","FLAG_COGS","Caption","COGS")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Ser_No","Caption","Serial Number")
	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Suffix","Caption","Suffix")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOPart","Caption","WO Part")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOLoc","Caption","WO Loc")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOQty","Caption","WO Qty")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOSchedDate","Caption","WO Sched Date")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WODueDate","Caption","WO Due Date")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOClsd","Caption","WO Clsd")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PO","Caption","PO")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLine","Caption","PO Line")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POPart","Caption","PO Part")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLoc","Caption","PO Loc")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POQty","Caption","PO Qty")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PODueDate","Caption","PO Due Date")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POClsd","Caption","PO Clsd")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POType","Caption","PO Type")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Status","Caption","Code")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Notes","Caption","Notes")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_1","Caption","User 1")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_4","Caption","User 4")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_5","Caption","User 5")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RtrCompl","Caption","Rtr")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","BomCompl","Caption","Bom")	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartFriendly","Caption","Part Friendly")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ScheduleWO","Caption","Select")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOCreated","Caption","Proc.")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Description","Caption","SO Line Description")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SORT","Caption","SO Description")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ORDER_SORT_2","Caption","Description 2")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SOURCE","Caption","Source")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","QTY_ONHAND","Caption","QOH")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartExists","Caption","Part")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","UM_ORDER","Caption","UM SO")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ShipQTY","Caption","Shipped")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","StatusMsg","Caption","Status")
	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ScheduleWO","MinWidth","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOOrderDate","Width","125")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOOrderDate","MinWidth","125")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ScheduleWO","Width","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer","MinWidth","65")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Name_Customer","MinWidth","150")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Name_Customer","Width","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer_PO","MinWidth","120")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer_PO","Width","120")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SO","MinWidth","65")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLine","MinWidth","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Salesperson","MinWidth","65")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SPName","MinWidth","150")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOType","MinWidth","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOPart","MinWidth","150")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOPart","Width","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLoc","MinWidth","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Product_Line","MinWidth","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Description","MinWidth","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOQty","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOBOQty","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOOrderDate","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SODueDate","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOShipSched","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WO","MinWidth","65")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Suffix","MinWidth","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOPart","MinWidth","150")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOLoc","MinWidth","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOQty","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOSchedDate","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WODueDate","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOClsd","MinWidth","65")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PO","MinWidth","65")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLine","MinWidth","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POPart","MinWidth","150")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLoc","MinWidth","55")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POQty","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PODueDate","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POClsd","MinWidth","65")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POType","MinWidth","95")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Status","MinWidth","65")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Notes","MinWidth","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_1","MinWidth","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_4","MinWidth","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_5","MinWidth","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RtrCompl","MinWidth","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RtrCompl","Width","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","BomCompl","MinWidth","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","BomCompl","Width","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ScheduleWO","MinWidth","40")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartFriendly","MinWidth","200")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOCreated","MinWidth","45")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOCreated","Width","45")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SORT","MinWidth","150")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ORDER_SORT_2","MinWidth","150")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SOURCE","MinWidth","75")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","QTY_ONHAND","MinWidth","65")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ShipQty","Width","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ShipQty","MinWidth","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartExists","MinWidth","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartExists","Width","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Printed","MinWidth","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Printed","Width","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Released","MinWidth","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Released","Width","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","UM_ORDER","MinWidth","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","UM_ORDER","Width","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","StatusMsg","MinWidth","75")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","StatusMsg","Width","75")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","FLAG_COGS","MinWidth","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","FLAG_COGS","Width","50")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Ser_No","MinWidth","150")

	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Name_Customer","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer_PO","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SO","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLine","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Salesperson","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SPName","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOType","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOPart","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLoc","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Product_Line","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Description","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOQty","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOBOQty","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOOrderDate","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SODueDate","AllowEdit",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOShipSched","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WO","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Suffix","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOPart","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOLoc","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOQty","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOSchedDate","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WODueDate","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOClsd","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PO","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLine","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POPart","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLoc","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POQty","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PODueDate","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POClsd","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POType","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Status","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Notes","AllowEdit",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_1","AllowEdit",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_4","AllowEdit",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_5","AllowEdit",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RtrCompl","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","BomCompl","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ScheduleWO","AllowEdit",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SORT","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ORDER_SORT_2","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SOURCE","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","QTY_ONHAND","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartExists","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Released","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Printed","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","UM_ORDER","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","StatusMsg","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PRICE","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","EXTENSION","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","FLAG_COGS","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Ser_No","AllowEdit",False)

	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Notes","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_1","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_4","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_5","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ScheduleWO","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SODueDate","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SORT","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ORDER_SORT_2","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SOURCE","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","QTY_ONHAND","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartExists","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Printed","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Released","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","StatusMsg","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PRICE","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","EXTENSION","ReadOnly",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Ser_No","ReadOnly",True)

	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Name_Customer","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer_PO","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SO","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLine","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Salesperson","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SPName","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOType","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOPart","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLoc","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Product_Line","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Description","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOQty","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOBOQty","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOOrderDate","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SODueDate","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOShipSched","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WO","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Suffix","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOPart","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOLoc","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOQty","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOSchedDate","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WODueDate","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOClsd","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PO","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLine","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POPart","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLoc","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POQty","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PODueDate","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POClsd","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POType","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Status","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Notes","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_1","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_4","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_5","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RtrCompl","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","BomCompl","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ScheduleWO","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartFriendly","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOCreated","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SORT","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ORDER_SORT_2","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SOURCE","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","QTY_ONHAND","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ShipQTY","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartExists","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RELEASED","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PRINTED","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","UM_ORDER","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","StatusMsg","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PRICE","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","EXTENSION","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","FLAG_COGS","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Ser_No","HeaderFontBold",True)

	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Name_Customer","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer_PO","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SO","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLine","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Salesperson","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SPName","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOType","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOPart","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLoc","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Product_Line","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Description","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOQty","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOBOQty","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOOrderDate","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SODueDate","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOShipSched","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WO","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Suffix","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOPart","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOLoc","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOQty","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOSchedDate","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WODueDate","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOClsd","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PO","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLine","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POPart","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLoc","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POQty","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PODueDate","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POClsd","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POType","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Status","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Notes","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_1","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_4","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_5","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RtrCompl","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","BomCompl","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ScheduleWO","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartFriendly","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOCreated","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SORT","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ORDER_SORT_2","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","CODE_SOURCE","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","QTY_ONHAND","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartExists","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ShipQty","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Printed","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Released","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","UM_ORDER","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","StatusMsg","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PRICE","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","EXTENSION","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","FLAG_COGS","HeaderHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Ser_No","HeaderHAlignment","Center")

	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Customer","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SO","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLine","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOQty","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Salesperson","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SPName","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOType","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLoc","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Product_Line","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOOrderDate","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SODueDate","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOShipSched","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WO","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Suffix","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOLoc","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOSchedDate","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WODueDate","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOClsd","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PO","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLine","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLoc","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PODueDate","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POClsd","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POType","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Status","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RtrCompl","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","BomCompl","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Code_source","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PartExists","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PRINTED","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","RELEASED","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","UM_ORDER","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","QTY_ONHAND","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ShipQty","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","FLAG_COGS","CellHAlignment","Center")

	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SO","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOPart","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOLoc","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WO","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Suffix","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOPart","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOLoc","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PO","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLine","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POPart","CellForeColor","Blue")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POLoc","CellForeColor","Blue")
	
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","Notes","CellBackColor","LightYellow")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_1","CellBackColor","LightYellow")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_4","CellBackColor","LightYellow")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","User_5","CellBackColor","LightYellow")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SODueDate","CellBackColor","LightYellow")

	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOOrderDate","DisplayCustomDatetime","d")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SODueDate","DisplayCustomDatetime","d")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOShipSched","DisplayCustomDatetime","d")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOSchedDate","DisplayCustomDatetime","d")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WODueDate","DisplayCustomDatetime","d")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PODueDate","DisplayCustomDatetime","d")
	
'	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PRICE","DisplayCustomNumeric","$#,###,###,##0.00")
'	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","EXTENSION","DisplayCustomNumeric","$#,###,###,##0.00")
'	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOQty","DisplayCustomNumeric","#,###,###,##0.00")
'	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","SOBOQty","DisplayCustomNumeric","#,###,###,##0.00")
'	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","QTY_ONHAND","DisplayCustomNumeric","#,###,###,##0.00")
'	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","WOQty","DisplayCustomNumeric","#,###,###,##0.00")
'	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","POQty","DisplayCustomNumeric","#,###,###,##0.00")
'	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","ShipQty","DisplayCustomNumeric","#,###,###,##0.00")
	
	Gui.FrmOrderReview.GsGCAllOpen.AddSummaryItem("GVALL","EXTENSION","SUM_EXTENSION","Sum","","","n")
	
	'Gui.FrmOrderReview.GsGCAll.GetColumnIndexByName("gvall","RtrCompl",V.Local.lCol)
	
	'Part Document Control
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PrtDocCntrl","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PrtDocCntrl","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PrtDocCntrl","Icon","DCS-OFF")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PrtDocCntrl","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PrtDocCntrl","Caption","Part Doc")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PrtDocCntrl","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PrtDocCntrl","MinWidth","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PrtDocCntrl","Width","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","PrtDocCntrl","Visible",True)
	F.Data.DataTable.Select("dtMaster$dtAll","PrtDocCntrl = 'DCS-ON'",V.Local.sSelect)
	F.Intrinsic.Control.If(V.Local.sSelect.IsNotNoReturn)
		F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sSelect.UBound,1)
			Gui.FrmOrderReview.GsGCAllOpen.GetColumnIndexByName("gvall","PrtDocCntrl",V.Local.lret)
			Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvAll",V.Local.lret,V.Local.sSelect(V.Local.iCnt),"Icon","DCS-ON")
		F.Intrinsic.Control.Next(V.Local.iCnt)
	F.Intrinsic.Control.EndIf
	
	'Job Document Control
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","JobDocCntrl","CellHAlignment","Center")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","JobDocCntrl","HeaderFontBold",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","JobDocCntrl","Icon","DCS-OFF")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","JobDocCntrl","AllowEdit",False)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","JobDocCntrl","Caption","Job Doc")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","JobDocCntrl","ReadOnly",True)
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","JobDocCntrl","MinWidth","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","JobDocCntrl","Width","35")
	Gui.FrmOrderReview.GsGCAllOpen.SetColumnProperty("gvAll","JobDocCntrl","Visible",False)
	F.Data.DataTable.Select("dtMaster$dtAll","JobDocCntrl = 'DCS-ON'",V.Local.sSelect)
	F.Intrinsic.Control.If(V.Local.sSelect.IsNotNoReturn)
		F.Intrinsic.String.Split(V.Local.sSelect,"*!*",V.Local.sSelect)
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.sSelect.UBound,1)
			Gui.FrmOrderReview.GsGCAllOpen.GetColumnIndexByName("gvall","JobDocCntrl",V.Local.lret)
			Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvAll",V.Local.lret,V.Local.sSelect(V.Local.iCnt),"Icon","DCS-ON")
		F.Intrinsic.Control.Next(V.Local.iCnt)
	F.Intrinsic.Control.EndIf
	
	
	Gui.FrmOrderReview.GsGCAllOpen.GetColumnIndexByName("gvall","StatusMsg",V.Local.lCol)
	'Gui.FrmOrderReview.progressBar1.Min(0)
	'Gui.FrmOrderReview.progressBar1.Max(V.DataTable.dtMaster$dtAll.RowCount)
	F.Intrinsic.Control.For(V.Local.iCnt,0,V.DataTable.dtMaster$dtAll.RowCount--,1)
		'Gui.FrmOrderReview.progressBar1.Value(V.Local.iCnt)
		V.Local.sStatus.Set("")
		F.Intrinsic.Control.If(V.DataTable.dtMaster$dtAll(V.Local.iCnt).WO!FieldValTrim,=,"")
		F.Intrinsic.Control.AndIf(V.DataTable.dtMaster$dtAll(V.Local.iCnt).PO!FieldValTrim,=,"")
			V.Local.sStatus.Set("1")
			V.Local.sStatusMSG.Set("No WO/PO")
			Gui.FrmOrderReview.GsGCAllOpen.setcellappearance("gvAll",V.Local.lCol,V.Local.iCnt,"BackColor","White")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvall",V.Local.lCol,V.Local.iCnt,"HAlignment","Center")
		F.Intrinsic.Control.ElseIf(V.DataTable.dtMaster$dtAll(V.Local.iCnt).WO!FieldValTrim,<>,"")
		F.Intrinsic.Control.AndIf(V.DataTable.dtMaster$dtAll(V.Local.iCnt).PO!FieldValTrim,=,"")
			'Part
			F.Intrinsic.Control.If(V.DataTable.dtMaster$dtAll(V.Local.iCnt).SOPart!FieldValTrim,<>,V.DataTable.dtMaster$dtAll(V.Local.iCnt).WOPart!FieldValTrim)
			F.Intrinsic.Control.AndIf(V.DataTable.dtMaster$dtAll(V.Local.iCnt).SOLoc!FieldValTrim,<>,V.DataTable.dtMaster$dtAll(V.Local.iCnt).WOLoc!FieldValTrim)
				V.Local.sStatus.Set("2")
				V.Local.sStatusMSG.Set("Part Mismatch")
				Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvall",V.Local.lCol,V.Local.iCnt,"BackColor","LightYellow")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvall",V.Local.lCol,V.Local.iCnt,"HAlignment","Center")
				'Gui.FrmOrderReview.GsGCAllOpen.SetRowAppearance("gvAll",V.Local.iCnt,"BackColor","LightYellow")
			F.Intrinsic.Control.EndIf
			'Due Date
			F.Intrinsic.Control.If(V.DataTable.dtMaster$dtAll(V.Local.iCnt).WODueDate!FieldVal,=,"")
				F.Data.DataTable.SetValue("dtMaster$dtAll",V.Local.iCnt,"WODueDate",V.Local.dtempdate)
			F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.If(V.DataTable.dtMaster$dtAll(V.Local.iCnt).SODueDate!FieldVal,<,V.DataTable.dtMaster$dtAll(V.Local.iCnt).WODueDate!FieldVal)
				F.Intrinsic.Control.If(V.Local.sStatus,=,"")
					V.Local.sStatus.Set("3")
					V.Local.sStatusMSG.Set("Date Mismatch")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvall",V.Local.lCol,V.Local.iCnt,"BackColor","Plum")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvall",V.Local.lCol,V.Local.iCnt,"HAlignment","Center")
					'Gui.FrmOrderReview.GsGCAllOpen.SetRowAppearance("gvAll",V.Local.iCnt,"BackColor","Plum")
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("{0}*!*3",V.Local.sStatus,V.Local.sStatus)
				F.Intrinsic.Control.EndIf
				
			F.Intrinsic.Control.EndIf
			'Qty
			F.Intrinsic.Control.If(V.DataTable.dtMaster$dtAll(V.Local.iCnt).SOQty!FieldVal,<>,V.DataTable.dtMaster$dtAll(V.Local.iCnt).WOQty!FieldVal)
				F.Intrinsic.Control.If(V.Local.sStatus,=,"")
					V.Local.sStatus.Set("4")
					V.Local.sStatusMSG.Set("Qty Mismatch")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvall",V.Local.lCol,V.Local.iCnt,"BackColor","LightPink")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvall",V.Local.lCol,V.Local.iCnt,"HAlignment","Center")
					'Gui.FrmOrderReview.GsGCAllOpen.SetRowAppearance("gvAll",V.Local.iCnt,"BackColor","LightPink")
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("{0}*!*4",V.Local.sStatus,V.Local.sStatus)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			'No Issues
			F.Intrinsic.Control.If(V.Local.sStatus,=,"")
				V.Local.sStatus.Set("0")
				V.Local.sStatusMSG.Set("No Issues")
				Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvall",V.Local.lCol,V.Local.iCnt,"BackColor","LightGreen")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvall",V.Local.lCol,V.Local.iCnt,"HAlignment","Center")
				'Gui.FrmOrderReview.GsGCAllOpen.SetRowAppearance("gvAll",V.Local.iCnt,"BackColor","LightGreen")
			F.Intrinsic.Control.Else
				'Multiple Issues
				F.Intrinsic.String.Split(V.Local.sStatus,"*!*",V.Local.sStatus2)
				F.Intrinsic.Control.If(V.Local.sStatus2.UBound,>,0)
					V.Local.sStatusMSG.Set("Multi Issue")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvall",V.Local.lCol,V.Local.iCnt,"BackColor","Red")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvall",V.Local.lCol,V.Local.iCnt,"HAlignment","Center")
					'Gui.FrmOrderReview.GsGCAllOpen.SetRowAppearance("gvAll",V.Local.iCnt,"BackColor","Red")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.ElseIf(V.DataTable.dtMaster$dtAll(V.Local.iCnt).WO!FieldValTrim,=,"")
		F.Intrinsic.Control.AndIf(V.DataTable.dtMaster$dtAll(V.Local.iCnt).PO!FieldValTrim,<>,"")
			'Part
			F.Intrinsic.Control.If(V.DataTable.dtMaster$dtAll(V.Local.iCnt).SOPart!FieldValTrim,<>,V.DataTable.dtMaster$dtAll(V.Local.iCnt).POPart!FieldValTrim)
			F.Intrinsic.Control.AndIf(V.DataTable.dtMaster$dtAll(V.Local.iCnt).SOLoc!FieldValTrim,<>,V.DataTable.dtMaster$dtAll(V.Local.iCnt).POLoc!FieldValTrim)
				V.Local.sStatus.Set("2")
				V.Local.sStatusMSG.Set("Part Mismatch")
				Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvall",V.Local.lCol,V.Local.iCnt,"BackColor","LightYellow")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvall",V.Local.lCol,V.Local.iCnt,"HAlignment","Center")
				'Gui.FrmOrderReview.GsGCAllOpen.SetRowAppearance("gvAll",V.Local.iCnt,"BackColor","LightYellow")
			F.Intrinsic.Control.EndIf
			'Due Date
			F.Intrinsic.Control.If(V.DataTable.dtMaster$dtAll(V.Local.iCnt).PODueDate!FieldValTRIM,<>,"")
				F.Intrinsic.Control.If(V.DataTable.dtMaster$dtAll(V.Local.iCnt).SODueDate!FieldVal,<,V.DataTable.dtMaster$dtAll(V.Local.iCnt).PODueDate!FieldVal)
					F.Intrinsic.Control.If(V.Local.sStatus,=,"")
						V.Local.sStatus.Set("3")
						V.Local.sStatusMSG.Set("Date Mismatch")
						'Gui.FrmOrderReview.GsGCAllOpen.SetRowAppearance("gvAll",V.Local.iCnt,"BackColor","Plum")
						Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvall",V.Local.lCol,V.Local.iCnt,"BackColor","Plum")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvall",V.Local.lCol,V.Local.iCnt,"HAlignment","Center")
					F.Intrinsic.Control.Else
						F.Intrinsic.String.Build("{0}*!*3",V.Local.sStatus,V.Local.sStatus)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			'Qty
			F.Intrinsic.Control.If(V.DataTable.dtMaster$dtAll(V.Local.iCnt).SOQty!FieldVal,<>,V.DataTable.dtMaster$dtAll(V.Local.iCnt).POQty!FieldVal)
				F.Intrinsic.Control.If(V.Local.sStatus,=,"")
					V.Local.sStatus.Set("4")
					V.Local.sStatusMSG.Set("Qty Mismatch")
					'Gui.FrmOrderReview.GsGCAllOpen.SetRowAppearance("gvAll",V.Local.iCnt,"BackColor","LightPink")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvall",V.Local.lCol,V.Local.iCnt,"BackColor","LightPink")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvall",V.Local.lCol,V.Local.iCnt,"HAlignment","Center")
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Build("{0}*!*4",V.Local.sStatus,V.Local.sStatus)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			'No Issues
			F.Intrinsic.Control.If(V.Local.sStatus,=,"")
				V.Local.sStatus.Set("0")
				V.Local.sStatusMSG.Set("No Issues")
				'Gui.FrmOrderReview.GsGCAllOpen.SetRowAppearance("gvAll",V.Local.iCnt,"BackColor","LightGreen")
				Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvall",V.Local.lCol,V.Local.iCnt,"BackColor","LightGreen")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvall",V.Local.lCol,V.Local.iCnt,"HAlignment","Center")
			F.Intrinsic.Control.Else
				'Multiple Issues
				F.Intrinsic.String.Split(V.Local.sStatus,"*!*",V.Local.sStatus2)
				F.Intrinsic.Control.If(V.Local.sStatus2.UBound,>,0)
					'Gui.FrmOrderReview.GsGCAllOpen.SetRowAppearance("gvAll",V.Local.iCnt,"BackColor","Red")
					V.Local.sStatusMSG.Set("Multi Issue")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvAll",V.Local.lCol,V.Local.iCnt,"BackColor","Red")
					Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvall",V.Local.lCol,V.Local.iCnt,"HAlignment","Center")
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
		'Shipped > SO QTY trumps all
		F.Intrinsic.Control.If(V.DataTable.dtMaster$dtAll(V.Local.iCnt).ShipQty!FieldVal,>=,V.DataTable.dtMaster$dtAll(V.Local.iCnt).SOQty!FieldVal)
			V.Local.sStatus.Set("5")
			V.Local.sStatusMSG.Set("Ready to Invoice")
			'Gui.FrmOrderReview.GsGCAllOpen.SetRowAppearance("gvAll",V.Local.iCnt,"BackColor","LightBlue")
			Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvAll",V.Local.lCol,V.Local.iCnt,"BackColor","LightBlue")
			Gui.FrmOrderReview.GsGCAllOpen.SetCellAppearance("gvall",V.Local.lCol,V.Local.iCnt,"HAlignment","Center")
		F.Intrinsic.Control.EndIf
		F.Data.DataTable.SetValue("dtMaster$dtAll",V.Local.iCnt,"Status",V.Local.sStatus)
		F.Data.DataTable.SetValue("dtMaster$dtAll",V.Local.iCnt,"StatusMsg",V.Local.sStatusMSG)

	F.Intrinsic.Control.Next(V.Local.iCnt)

	Gui.FrmOrderReview.GsGCAllOpen.ResumeLayout()
	Gui.FrmOrderReview.GsGCAllOpen.MainView("gvMaster")
	Gui.FrmOrderReview.progressBar1.Value(0)
	Gui.FrmOrderReview.progressBar1.Visible(false)
	Gui.FrmOrderReview.lblStatus.Visible(false)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.LoadGVAll.End

Program.Sub.cmdRefresh_Click.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Control.If(V.Global.bLoadData)
		F.Intrinsic.Control.CallSub(Serialize)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.CallSub(loaddtall)
	F.Intrinsic.Control.CallSub(Deserialize)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.cmdRefresh_Click.End

Program.Sub.GsGCAllOpen_RowCellClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSQL.Declare
	V.Local.sRet.Declare
	V.Local.sJob.Declare
	V.Local.sSO.Declare
	V.Local.sSOLine.Declare
	V.Local.sWO.Declare
	V.Local.sSuffix.Declare
	V.Local.sPO.Declare
	V.Local.sPOLine.Declare
	V.Local.sPart.Declare
	V.Local.sLoc.Declare
	V.Local.sParams.Declare
	V.Local.sShortRet.declare
	V.Local.sLinkID.Declare
	V.Local.sMsg.Declare
	V.Local.sGSSPart.Declare
	V.Local.sPartReV.Declare
	
	V.Local.iRet.Declare
	V.Local.iPID.Declare
	V.Local.bEdit.Declare
	V.Local.bRel.Declare
	V.Local.lRet.Declare
	V.Local.iRefID.Declare
	V.Local.iLinkID.Declare
	V.Local.sOrderNo.Declare
	V.Local.sOrderLine.Declare
	V.Local.sCaption.Declare
	V.Local.sGV.Declare
	
	F.Global.Security.CheckUserAccessIPM(136,2,V.Global.bShipOEPermission)	
	F.Global.Security.CheckUserAccessIPM(661,2,V.Global.bShipSHIPPermission)
	
	Gui.FrmOrderReview.GsGCAllOpen.GetFocusedGridview(V.Local.sGV)
	F.Intrinsic.String.Replace(V.Local.sGV,"dt","gv",V.Local.sGV)
	
	F.Intrinsic.Control.SelectCase(V.Args.column)
			
		F.Intrinsic.Control.CaseAny("Released","RELEASED")
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"WO",V.Args.RowIndex,V.Local.sJob)
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"SUFFIX",V.Args.RowIndex,V.Local.sSuffix)
			F.Intrinsic.Control.If(V.Args.CellValue,=,"False")
				F.Intrinsic.String.Build("UPDATE JOB_HEADER SET FLAG_WO_RELEASED = 'Y', DATE_RELEASED = '{0}' WHERE JOB = '{1}' AND SUFFIX = '{2}';",V.Ambient.Date.FormatMMDDYY,V.Local.sJob,V.Local.sSuffix,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
				Gui.FrmOrderReview.GsGCAllOpen.SetCellValueByColumnName(V.Local.sGV,"RELEASED",V.Args.RowIndex,True)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("UPDATE JOB_HEADER SET FLAG_WO_RELEASED = '', DATE_RELEASED = '000000' WHERE JOB = '{0}' AND SUFFIX = '{1}';",V.Local.sJob,V.Local.sSuffix,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
				Gui.FrmOrderReview.GsGCAllOpen.SetCellValueByColumnName(V.Local.sGV,"RELEASED",V.Args.RowIndex,False)
			F.Intrinsic.Control.EndIf
			
		F.Intrinsic.Control.CaseAny("Printed","PRINTED","Print","PRINT")
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"WO",V.Args.RowIndex,V.Local.sJob)
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"SUFFIX",V.Args.RowIndex,V.Local.sSuffix)
			'F.Intrinsic.Control.If(V.Args.CellValue,=,"False")
				'Gui.FrmOrderReview.GsGCAllOpen.SetCellValueByColumnName(V.Local.sGV,"PRINTED",V.Args.RowIndex,true)
				F.Intrinsic.Control.If(V.Local.sJob.Trim,<>,"")
					F.Intrinsic.String.Build("UPDATE JOB_HEADER SET FLAG_WO_PRTD = 'Y' WHERE JOB = '{0}' AND SUFFIX = '{1}';",V.Local.sJob,V.Local.sSuffix,V.Local.sSQL)
					F.ODBC.Connection!con.Execute(V.Local.sSQL)
					F.Intrinsic.String.Build("{0}!*!{1}!*!1811",V.Local.sJob,V.Local.sSuffix,V.Local.sParams)
					F.Global.General.CallWrapperSync(900100,V.Local.sParams)
				F.Intrinsic.Control.Else
					F.Intrinsic.UI.Msgbox("No work order for the selected line")
				F.Intrinsic.Control.EndIf
'			F.Intrinsic.Control.Else
'				Gui.FrmOrderReview.GsGCAllOpen.SetCellValueByColumnName(V.Local.sGV,"PRINTED",V.Args.RowIndex,false)
'				F.Intrinsic.String.Build("UPDATE JOB_HEADER SET FLAG_WO_PRTD = '' WHERE JOB = '{0}' AND SUFFIX = '{1}';",V.Local.sJob,V.Local.sSuffix,V.Local.sSQL)
'				F.ODBC.Connection!con.Execute(V.Local.sSQL)
'			F.Intrinsic.Control.EndIf
			
		F.Intrinsic.Control.caseany("PrtDocCntrl","PRTDOCCONTROL")
			V.Local.sPart.Set(V.DataTable.dtMaster$dtAll(V.Args.RowIndex).GSSPart!FieldValTRIM)
			F.Global.DocumentControl.GetLinkID(V.Local.sPart.Trim,30,V.Local.iRefID)
			F.Intrinsic.Control.If(V.Local.irefid,=,-1)
				F.ODBC.Connection!con.ExecuteAndReturn("SELECT MAX(LINK_ID) AS 'LinkID' FROM LINK_DATA",V.Local.sLinkID)
				F.Intrinsic.Math.ConvertToLong(V.Local.sLinkID,V.Local.iLinkID)
				F.Intrinsic.Math.Add(V.Local.iLinkID,1,V.Local.iLinkID)
				F.Intrinsic.string.LPad(V.Local.iLinkID,"0",9,V.Local.sLinkID)
				'F.Intrinsic.String.Build("INSERT INTO LINK_DATA (LINK_ID,TYPE,ID) VALUES('{0}','{1}','{2}')",V.Local.sLinkID,"00030",V.Local.spart,V.Local.ssql)
				'F.ODBC.Connection!con.execute(V.Local.ssql)
				V.Local.iRefID.Set(V.Local.iLinkID)
				F.Global.DocumentControl.CreateReference(V.Local.sPart,"00030",V.Local.iRefID)
			F.Intrinsic.Control.EndIf
			F.Global.DocumentControl.Invoke(V.Local.sPart,30,"(Inventory Master)",V.Local.iPID)
			
		F.Intrinsic.Control.caseany("JobDocCntrl","JOBDOCCONTROL")
			V.Local.sJob.Set(V.DataTable.dtMaster$dtAll(V.Args.RowIndex).JS!FieldValTRIM)
			F.Intrinsic.Control.If(V.Local.sJob.Trim,=,"")
				F.Intrinsic.UI.Msgbox("Work Order not created for this line.")
			F.Intrinsic.Control.Else
				F.Global.DocumentControl.GetLinkID(V.Local.sJob.Trim,30,V.Local.iRefID)
				F.Intrinsic.Control.If(V.Local.irefid,=,-1)
					F.ODBC.Connection!con.ExecuteAndReturn("SELECT MAX(LINK_ID) AS 'LinkID' FROM LINK_DATA",V.Local.sLinkID)
					F.Intrinsic.Math.ConvertToLong(V.Local.sLinkID,V.Local.iLinkID)
					F.Intrinsic.Math.Add(V.Local.iLinkID,1,V.Local.iLinkID)
					F.Intrinsic.string.LPad(V.Local.iLinkID,"0",9,V.Local.sLinkID)
					'F.Intrinsic.String.Build("INSERT INTO LINK_DATA (LINK_ID,TYPE,ID) VALUES('{0}','{1}','{2}')",V.Local.sLinkID,"00020",V.Local.spart,V.Local.ssql)
					'F.ODBC.Connection!con.execute(V.Local.ssql)
					V.Local.iRefID.Set(V.Local.iLinkID)
					F.Global.DocumentControl.CreateReference(V.Local.sJob,"00020",V.Local.iRefID)
				F.Intrinsic.Control.EndIf
				F.Global.DocumentControl.Invoke(V.Local.sJob,20,"(Job Master)",V.Local.iPID)
			F.Intrinsic.Control.EndIf
			
		F.Intrinsic.Control.CaseAny("SO")
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"SO",V.Args.RowIndex,V.Local.sSO)
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"SOLINE",V.Args.RowIndex,V.Local.sSOLINE)
			F.Intrinsic.Control.If(V.Local.sSO,<>,"")	
				F.Intrinsic.Control.If(V.Screen.FrmOrderReview!optEdit.Value,=,True,"OR",V.Screen.FrmOrderReview!optIssue.Value,=,True,V.Screen.FrmOrderReview!optWipToFG.Value,=,True)				
					Function.Global.Security.CheckUserAccessIPM(132,1,V.Local.bEdit)
					F.Intrinsic.Control.If(V.Local.bEdit)
						F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sSO,"O","*!*ZDR*!*",V.Local.sParams)
						F.Global.General.CallWrapperAsync(200000,V.Local.sParams)
					F.Intrinsic.Control.Else
						F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sSO,"V","*!*ZDR*!*",V.Local.sParams)
						F.Global.General.CallWrapperAsync(200000,V.Local.sParams)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.ElseIf(V.Screen.FrmOrderReview!optShip.Value,=,True)
					F.Intrinsic.Control.If(V.Global.bShipOEPermission,=,True,or,V.Global.bShipSHIPPermission,=,True)
						Gui.FrmOrderReview.GsGCAllOpen.Enabled(False)
						F.Global.Callwrapper.New("Ship","Sales.NewShipments")
						F.Global.Callwrapper.SetProperty("Ship","OrderNumber",V.Local.sSO)
						F.Global.Callwrapper.SetProperty("Ship","OrderLine",V.Local.sSOLine)
						F.Global.CallWrapper.Run("Ship")
						Gui.FrmOrderReview.GsGCAllOpen.Enabled(True)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.Else
					F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sSO,"V","*!*ZDR*!*",V.Local.sParams)
					F.Global.General.CallWrapperAsync(200000,V.Local.sParams)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf

		F.Intrinsic.Control.CaseAny("WO","Suffix","SUFFIX")
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"WO",V.Args.RowIndex,V.Local.sWO)
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"Suffix",V.Args.RowIndex,V.Local.sSuffix)
			F.Intrinsic.Control.If(V.Local.sWO,<>,"")
				F.Intrinsic.Control.If(V.Screen.FrmOrderReview!optEdit.Value,=,True)
					Function.Global.Security.CheckUserAccessIPM(527,1,V.Local.bEdit)
					F.Intrinsic.Control.If(V.Local.bEdit)
						F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sWO,V.Local.sSuffix,"O",V.Local.sParams)
						F.Global.General.CallWrapperAsync(2009,V.Local.sParams)
					F.Intrinsic.Control.Else
						F.Intrinsic.String.ConcatCallWrapperArgs("7",V.Local.sWO,V.Local.sSuffix,"A",V.Local.sParams)
						F.Global.General.CallWrapperAsync(450000,V.Local.sParams)
					F.Intrinsic.Control.EndIf					
				F.Intrinsic.Control.ElseIf(V.Screen.FrmOrderReview!optIssue.Value,=,True)								
					F.Intrinsic.String.Build("{0}!*!{1}!*! !*! !*! !*! !*! ",V.Local.sWO,V.Local.sSuffix,V.Local.sParams)
					F.Global.General.CallWrapperSync(450150,V.Local.sParams)
					F.Intrinsic.Control.SelectCase(V.Global.iPrintAudit)
						F.Intrinsic.Control.Case(1)
							F.Global.General.CallWrapperSync(50,"JB0057")
						F.Intrinsic.Control.Case(2)
							'Do Not Print
						F.Intrinsic.Control.Case(3)
							'F.Intrinsic.UI.Msgbox("Print Audit Trail?","Print",4,V.Local.iRet)
							'F.Intrinsic.Control.If(V.Local.iRet,=,6)
								F.Global.General.CallWrapperSync(50,"JB0057")
							'F.Intrinsic.Control.EndIf
					F.Intrinsic.Control.EndSelect
				F.Intrinsic.Control.ElseIf(V.Screen.FrmOrderReview!optWiptoFG.Value,=,True)
					F.Intrinsic.String.Build("{0}!*!{1}!*!{2}!*!OS!*!!*!!*!!*!!*!!*!!*!{3}!*!{4}!*!16!*!03!*!02!*!!*!!*!!*!!*!!*!!*!!*!!*!!*!",V.Caller.CompanyCode,V.Caller.Terminal,V.Caller.Caller,V.Local.sWO,V.Local.sSuffix,V.Local.sParams)
					F.Global.General.CallWrapperSync(2003,V.Local.sParams)
					F.Intrinsic.Control.SelectCase(V.Global.iPrintAudit)
						F.Intrinsic.Control.Case(1)
							F.Global.General.CallWrapperSync(50,"JB0057/C")
						F.Intrinsic.Control.Case(2)
							'Do Not Print
						F.Intrinsic.Control.Case(3)
							F.Global.General.CallWrapperSync(50,"JB0057/C")
					F.Intrinsic.Control.EndSelect
				F.Intrinsic.Control.Else
					F.Intrinsic.String.ConcatCallWrapperArgs("7",V.Local.sWO,V.Local.sSuffix,"A",V.Local.sParams)
					F.Global.General.CallWrapperAsync(450000,V.Local.sParams)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			
		F.Intrinsic.Control.CaseAny("PO","POLine")
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"PO",V.Args.RowIndex,V.Local.sPO)
			F.Intrinsic.Control.If(V.Local.sPO,<>,"")
				F.Intrinsic.Control.If(V.Screen.FrmOrderReview!optEdit.Value,=,True,"OR",V.Screen.FrmOrderReview!optIssue.Value,=,True,V.Screen.FrmOrderReview!optWipToFG.Value,=,True)
					Function.Global.Security.CheckUserAccessIPM(265,1,V.Local.bEdit)
					F.Intrinsic.Control.If(V.Local.bEdit)
						F.Intrinsic.String.ConcatCallWrapperArgs("O",V.Local.sPO,"",V.Local.sParams)
					F.Intrinsic.Control.Else
						F.Intrinsic.String.ConcatCallWrapperArgs("V",V.Local.sPO,"",V.Local.sParams)
					F.Intrinsic.Control.EndIf					
				F.Intrinsic.Control.Else
					F.Intrinsic.String.ConcatCallWrapperArgs("V",V.Local.sPO,"",V.Local.sParams)
				F.Intrinsic.Control.EndIf
				F.Global.General.CallWrapperASync(175200,V.Local.sParams)
			F.Intrinsic.Control.EndIf				
		
		F.Intrinsic.Control.CaseAny("SOPart","SOLoc")
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"DISPLAY_PART",V.Args.RowIndex,V.Local.sPart.Trim)
			
			F.Intrinsic.Control.If(V.Global.bLongPart)
				F.Global.Inventory.GetGSSPart(V.Local.sPart.Trim,V.Local.sPartReV.Trim,V.Local.sShortRet)
			F.Intrinsic.Control.Else
				V.Local.sShortRet.Set(V.Local.sPart.Trim)
			F.Intrinsic.Control.EndIf
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"SOLoc",V.Args.RowIndex,V.Local.sLoc)
			F.Intrinsic.Control.If(V.Local.sPart,<>,"")
				F.Intrinsic.Control.If(V.Screen.FrmOrderReview!optView.Value,=,True)				
					F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sShortRet.Trim,V.Local.sLoc,"O",V.Local.sParams)
				F.Intrinsic.Control.Else
					Function.Global.Security.CheckUserAccessIPM(371,0,V.Local.bEdit)
					F.Intrinsic.Control.If(V.Local.bEdit)
						F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sShortRet.Trim,V.Local.sLoc,"M",V.Local.sParams)
					F.Intrinsic.Control.Else
						F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sShortRet.Trim,V.Local.sLoc,"O",V.Local.sParams)
					F.Intrinsic.Control.EndIf					
				F.Intrinsic.Control.EndIf
				F.Global.General.CallWrapperSync(300011,V.Local.sParams)
			F.Intrinsic.Control.EndIf
		
		F.Intrinsic.Control.CaseAny("WOPart","WOLoc")			
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"GSSPart",V.Args.RowIndex,V.Local.sPart)
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"WOLoc",V.Args.RowIndex,V.Local.sLoc)
			F.Intrinsic.Control.If(V.Local.sPart,<>,"")
				F.Intrinsic.Control.If(V.Screen.FrmOrderReview!optView.Value,=,True)
					F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sPart,V.Local.sLoc,"O",V.Local.sParams)
				F.Intrinsic.Control.Else
					Function.Global.Security.CheckUserAccessIPM(371,0,V.Local.bEdit)
					F.Intrinsic.Control.If(V.Local.bEdit)
						F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sPart,V.Local.sLoc,"M",V.Local.sParams)
					F.Intrinsic.Control.Else
						F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sPart,V.Local.sLoc,"O",V.Local.sParams)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Global.General.CallWrapperSync(300011,V.Local.sParams)
			F.Intrinsic.Control.EndIf
	
		F.Intrinsic.Control.CaseAny("POPart","POLoc")			
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"GSSPart",V.Args.RowIndex,V.Local.sPart)
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"POLoc",V.Args.RowIndex,V.Local.sLoc)
			F.Intrinsic.Control.If(V.Local.sPart,<>,"")
				F.Intrinsic.Control.If(V.Screen.FrmOrderReview!optView.Value,=,True)					
					F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sPart,V.Local.sLoc,"O",V.Local.sParams)
				F.Intrinsic.Control.Else
					Function.Global.Security.CheckUserAccessIPM(371,0,V.Local.bEdit)
					F.Intrinsic.Control.If(V.Local.bEdit)
						F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sPart,V.Local.sLoc,"M",V.Local.sParams)
					F.Intrinsic.Control.Else
						F.Intrinsic.String.ConcatCallWrapperArgs(V.Local.sPart,V.Local.sLoc,"O",V.Local.sParams)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
				F.Global.General.CallWrapperSync(300011,V.Local.sParams)
			F.Intrinsic.Control.EndIf
		'6088
		F.Intrinsic.Control.Case("Ser_No")
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"SO",V.Args.RowIndex,V.Local.sOrderNo)
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"SOLine",V.Args.RowIndex,V.Local.sOrderLine)
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"WO",V.Args.RowIndex,V.Local.sWO)
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"Suffix",V.Args.RowIndex,V.Local.sSuffix)
			F.Intrinsic.String.Build("Select SERIAL_NUMBER from V_ITEM_HISTORY where ORDER_NO = '{0}' and ORDER_LINE = '{1}' and CODE_TRANSACTION = 'O35' and SERIAL_NUMBER <> ''",V.Local.sOrderNo,V.Local.sOrderLine,V.Local.sSQL)
			F.ODBC.Connection!conts.OpenCompanyConnection
			F.ODBC.Connection!conts.ExecuteAndReturn(V.Local.sSQL,V.Local.sSQL)
			F.Intrinsic.Control.If(V.Local.sSQL.Trim,=,"")
				F.Intrinsic.String.Build("Select SERIAL_START from JOB_SERIAL where JOB = '{0}' and SUFFIX = '{1}'",V.Local.sWO.Trim,V.Local.sSuffix.Trim,V.Local.sSQL)
				F.ODBC.Connection!conts.ExecuteAndReturn(V.Local.sSQL,V.Local.sSQL)
				F.Intrinsic.String.Replace(V.Local.sSQL,"#$#",V.Ambient.NewLine,V.Local.sSQL)
				F.Intrinsic.String.Build("Serial numbers assigned to WO# {0}-{1}",V.Local.sWO.Trim,V.Local.sSuffix.Trim,V.Local.sCaption)
				Gui.frmSerNo..Caption(V.Local.sCaption)
				Gui.frmSerNo.txtSerNo.Text(V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Replace(V.Local.sSQL,"#$#",V.Ambient.NewLine,V.Local.sSQL)
				F.Intrinsic.String.Build("Serial numbers assigned to Order# {0}, Line# {1}",V.Local.sOrderNo,V.Local.sOrderLine,V.Local.sCaption)
				Gui.frmSerNo..Caption(V.Local.sCaption)
				Gui.frmSerNo.txtSerNo.Text(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.Connection!conts.Close
			Gui.frmSerNo..Show
'		'Need to figure out this review column function....
'		F.Intrinsic.Control.Case("Review")
'			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName("gvAll","GSSPart",V.Args.RowIndex,V.Local.sPart)
'			F.Intrinsic.String.Build("SELECT * FROM V_BOM_MSTR WHERE PARENT='{0}'",V.Local.sPart.Trim,V.Local.sSQL)
'			F.ODBC.Connection!con.executeandreturn(V.Local.sSQL,V.Local.sRet)
'			F.Intrinsic.Control.If(V.Local.sRet.Trim,<>,"")
'				'F.Global.General.CallWrapperAsync(50,"BM0020GI/O")
'			F.Intrinsic.Control.Else
'				F.Intrinsic.String.ConcatCallWrapperArgs("O",V.Local.sPart,V.Local.sParams)
'				F.Global.General.CallWrapperAsync(400000,V.Local.sParams)
'			F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndSelect
	
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCAllOpen_RowCellClick.End

Program.Sub.GsGCAllOpen_CellValueChanged.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSQL.Declare
	V.Local.sOrder.Declare
	V.Local.sSOLine.Declare
	V.Local.sLine.Declare
	V.Local.sText.Declare
	V.Local.sTextTbl.Declare
	V.Local.sJob.Declare
	V.Local.sSuF.Declare
	V.Local.sParams.Declare
	V.Local.sDate.Declare
	V.Local.sDateLong.Declare
	V.Local.sDateUS.Declare
	V.Local.sdatesched.Declare
	
	V.Local.dDateSched.Declare
	V.Local.dDate.Declare
	V.Local.sGV.Declare
	
	Gui.FrmOrderReview.GsGCAllOpen.GetFocusedGridview(V.Local.sGV)
	F.Intrinsic.String.Replace(V.Local.sGV,"dt","gv",V.Local.sGV)
	
	Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"SO",V.Args.RowIndex,V.Local.sOrder)
	Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"SOLine",V.Args.RowIndex,V.Local.sLine)
	F.Intrinsic.String.RPad(V.Local.sLine,"0",4,V.Local.sSOLine)
	
	'F.Intrinsic.Debug.ShowCallerInfo
	F.Intrinsic.Control.SelectCase(V.Args.column)
		F.Intrinsic.Control.CaseAny("SODueDate","SODUEDATE")
			'Select the row
			F.Data.DataTable.SetValue("dtMaster$dtAll",V.Args.rowindex,"ScheduleWO",true)
			
			'Update line item due date
			V.Local.ddate.set(V.DataTable.dtMaster$dtAll(V.args.rowindex).SODueDate!FieldValString)
			F.Intrinsic.String.Format(V.Local.ddate,"dd/mm/yyyy",V.Local.sdatesched)
			F.Intrinsic.String.Format(V.Local.ddate,"MMDDYY",V.Local.sdate)
			F.Intrinsic.String.Format(V.Local.ddate,"YYYYMMDD",V.Local.SDATELong)
			F.Intrinsic.String.Format(V.Local.ddate,"DD/MM/YY",V.Local.SDATEUS)
			F.Intrinsic.String.Concat("UPDATE ORDER_LINES SET DATE_ITEM_PROM='",V.Local.SDATELong,"', ITEM_PROMISE_DT='",V.Local.sdate,"' WHERE Order_No='",V.DataTable.dtMaster$dtAll(V.Args.rowindex).SO!fieldvaltrim,"' and Record_No='",V.DataTable.dtMaster$dtAll(V.args.rowindex).SOLine!fieldvaltrim,"0'",V.Local.sSQL)
			F.ODBC.Connection!con.Execute(V.Local.ssql)
						
			'Update line item due date
			V.Local.sJob.Set(V.DataTable.dtMaster$dtAll(V.Args.rowindex).WO!FIELDVALTRIM)
			V.Local.sSuF.Set(V.DataTable.dtMaster$dtAll(V.Args.rowindex).SUFFIX!FIELDVALTRIM)
			F.Intrinsic.String.Format(V.Local.ddate,"MMDDYY",V.Local.sdate)
			F.Intrinsic.String.Concat("UPDATE JOB_HEADER SET DATE_DUE='",V.Local.sdate,"' WHERE JOB='",V.Local.sJob,"' and SUFFIX='",V.Local.sSuf,"'",V.Local.sSQL)
			F.ODBC.Connection!con.Execute(V.Local.ssql)
			
		F.Intrinsic.Control.CaseAny("NOTES","Notes")
			F.Intrinsic.String.Replace(V.Args.Value,"'","''",V.Local.sTextTbl)
			F.Intrinsic.String.Build("SELECT * FROM GAB_4167_SO_NOTES WHERE SO = '{0}' AND SOLINE = '{1}';",V.Local.sOrder,V.Local.sLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
				F.Intrinsic.String.Build("INSERT INTO GAB_4167_SO_NOTES(SO,SOLINE,NOTES) VALUES('{0}','{1}','{2}');",V.Local.sOrder,V.Local.sLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("UPDATE GAB_4167_SO_NOTES SET NOTES = '{0}' WHERE SO = '{1}' AND SOLINE = '{2}';",V.Local.sTextTbl,V.Local.sOrder,V.Local.sLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close
			F.Intrinsic.Control.CallSub(checknote,"SO",V.Local.sOrder,"Line",V.Local.sLine,"Note",V.Args.Value,"GV",V.Local.sGV,"SO_Note","NOTES")
	
		F.Intrinsic.Control.CaseAny("USER_4","User_4")
			Function.Intrinsic.Debug.InvokeDebugger
			Function.Intrinsic.Debug.Stop
			
			F.Intrinsic.String.Left(V.Args.Value,30,V.Local.sText)
			F.Intrinsic.String.Replace(V.Local.sText,"'","''",V.Local.sTextTbl)
			F.Intrinsic.String.Build("SELECT * FROM ORDER_LINES WHERE ORDER_NO = '{0}' AND RECORD_NO = '{1}';",V.Local.sOrder,V.Local.sSOLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
				F.Intrinsic.String.Build("INSERT INTO ORDER_LINES(ORDER_NO,RECORD_NO,USER_4) VALUES('{0}','{1}','{2}');",V.Local.sOrder,V.Local.sSOLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("UPDATE ORDER_LINES SET USER_4 = '{0}' WHERE ORDER_NO = '{1}' AND RECORD_NO = '{2}';",V.Local.sTextTbl,V.Local.sOrder,V.Local.sSOLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close
			F.Intrinsic.Control.CallSub(checknote,"SO",V.Local.sOrder,"Line",V.Local.sLine,"Note",V.Local.sText,"GV",V.Local.sGV,"SO_Note","USER_4")
	
		F.Intrinsic.Control.CaseAny("USER_5","User_5")
			F.Intrinsic.String.Left(V.Args.Value,30,V.Local.sText)
			F.Intrinsic.String.Replace(V.Local.sText,"'","''",V.Local.sTextTbl)
			F.Intrinsic.String.Build("SELECT * FROM ORDER_LINES WHERE ORDER_NO = '{0}' AND RECORD_NO = '{1}';",V.Local.sOrder,V.Local.sSOLine,V.Local.sSQL)
			F.ODBC.Connection!con.OpenRecordsetRW("rstNotes",V.Local.sSQL)
			F.Intrinsic.Control.If(V.ODBC.con!rstNotes.EOF,=,True)
				F.Intrinsic.String.Build("INSERT INTO ORDER_LINES(ORDER_NO,RECORD_NO,USER_5) VALUES('{0}','{1}','{2}');",V.Local.sOrder,V.Local.sSOLine,V.Local.sTextTbl,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.Else
				F.Intrinsic.String.Build("UPDATE ORDER_LINES SET USER_5 = '{0}' WHERE ORDER_NO = '{1}' AND RECORD_NO = '{2}';",V.Local.sTextTbl,V.Local.sOrder,V.Local.sSOLine,V.Local.sSQL)
				F.ODBC.Connection!con.Execute(V.Local.sSQL)
			F.Intrinsic.Control.EndIf
			F.ODBC.con!rstNotes.Close
			F.Intrinsic.Control.CallSub(checknote,"SO",V.Local.sOrder,"Line",V.Local.sLine,"Note",V.Local.sText,"GV",V.Local.sGV,"SO_Note","USER_5")
	F.Intrinsic.Control.EndSelect
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.GsGCAllOpen_CellValueChanged.End

Program.Sub.CheckTable.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.bExists.Declare

	F.ODBC.Connection!con.TableExists("GAB_4167_SO_NOTES",V.Local.bExists)
	F.Intrinsic.Control.If(V.Local.bExists,!=,true)
		F.ODBC.Connection!con.Execute("CREATE TABLE GAB_4167_SO_NOTES(SO CHAR(7),SOLINE CHAR(3),NOTES LONGVARCHAR);")
		F.ODBC.Connection!con.Execute("CREATE INDEX GAB_4167_SO_NOTES01 USING 1 ON GAB_4167_SO_NOTES(SO);")
		F.ODBC.Connection!con.Execute("CREATE INDEX GAB_4167_SO_NOTES02 USING 2 ON GAB_4167_SO_NOTES(SOLINE);")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.CheckTable.End

Program.Sub.CheckNote.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSO.Declare
	V.Local.sLine.Declare
	V.Local.iRows.Declare
	V.Local.iCnt.Declare
	V.Local.sGV.Declare
	
	V.Local.sGV.Set(V.Args.GV)

	F.Intrinsic.Control.If(V.Args.SO_Note,=,"NOTES")
		'Gui.FrmOrderReview.GsGCPastDue.GetRowCount("gvPastDue",V.Local.iRows)
		F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
			'Gui.FrmOrderReview.GsGCPastDue.GetCellValueByColumnName("gvPastDue","SO",V.Local.iCnt,V.Local.sSO)
			'Gui.FrmOrderReview.GsGCPastDue.GetCellValueByColumnName("gvPastDue","SOLine",V.Local.iCnt,V.Local.sLine)
			F.Intrinsic.Control.If(V.Local.sSO,=,V.Args.SO)
			F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
				'Gui.FrmOrderReview.GsGCPastDue.SetCellValueByColumnName("gvPastDue","NOTES",V.Local.iCnt,V.Args.Note)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.iCnt)

		Gui.FrmOrderReview.GsGCAllOpen.GetRowCount(V.Local.sGV,V.Local.iRows)
		F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
		F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"SO",V.Local.iCnt,V.Local.sSO)
			Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"SOLine",V.Local.iCnt,V.Local.sLine)
			F.Intrinsic.Control.If(V.Local.sSO,=,V.Args.SO)
			F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
				Gui.FrmOrderReview.GsGCAllOpen.SetCellValueByColumnName(V.Local.sGV,"NOTES",V.Local.iCnt,V.Args.Note)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.iCnt)

	F.Intrinsic.Control.ElseIf(V.Args.SO_Note,=,"USER_4")
'		F.Intrinsic.Control.If(V.Args.GV,=,"gvAll")
			'Gui.FrmOrderReview.GsGCPastDue.GetRowCount("gvPastDue",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				'Gui.FrmOrderReview.GsGCPastDue.GetCellValueByColumnName("gvPastDue","SO",V.Local.iCnt,V.Local.sSO)
				'Gui.FrmOrderReview.GsGCPastDue.GetCellValueByColumnName("gvPastDue","SOLine",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sSO,=,V.Args.SO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					'Gui.FrmOrderReview.GsGCPastDue.SetCellValueByColumnName("gvPastDue","USER_4",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)
'		F.Intrinsic.Control.Else
			Gui.FrmOrderReview.GsGCAllOpen.GetRowCount(V.Local.sGV,V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"SO",V.Local.iCnt,V.Local.sSO)
				Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"SOLine",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sSO,=,V.Args.SO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmOrderReview.GsGCAllOpen.SetCellValueByColumnName(V.Local.sGV,"USER_4",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)
'		F.Intrinsic.Control.EndIf

	F.Intrinsic.Control.ElseIf(V.Args.SO_Note,=,"USER_5")
'		F.Intrinsic.Control.If(V.Args.GV,=,"gvAll")
			'Gui.FrmOrderReview.GsGCPastDue.GetRowCount("gvPastDue",V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				'Gui.FrmOrderReview.GsGCPastDue.GetCellValueByColumnName("gvPastDue","SO",V.Local.iCnt,V.Local.sSO)
				'Gui.FrmOrderReview.GsGCPastDue.GetCellValueByColumnName("gvPastDue","SOLine",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sSO,=,V.Args.SO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					'Gui.FrmOrderReview.GsGCPastDue.SetCellValueByColumnName("gvPastDue","USER_5",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)
'		F.Intrinsic.Control.Else
			Gui.FrmOrderReview.GsGCAllOpen.GetRowCount(V.Local.sGV,V.Local.iRows)
			F.Intrinsic.Math.Sub(V.Local.iRows,1,V.Local.iRows)
			F.Intrinsic.Control.For(V.Local.iCnt,0,V.Local.iRows,1)
				Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"SO",V.Local.iCnt,V.Local.sSO)
				Gui.FrmOrderReview.GsGCAllOpen.GetCellValueByColumnName(V.Local.sGV,"SOLine",V.Local.iCnt,V.Local.sLine)
				F.Intrinsic.Control.If(V.Local.sSO,=,V.Args.SO)
				F.Intrinsic.Control.AndIf(V.Local.sLine,=,V.Args.Line)
					Gui.FrmOrderReview.GsGCAllOpen.SetCellValueByColumnName(V.Local.sGV,"USER_5",V.Local.iCnt,V.Args.Note)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.iCnt)
'		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.CheckNote.End

Program.Sub.CheckPermissions.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.bEditInventory.Declare
	V.Local.bEditWO.Declare
	V.Local.bEditPO.Declare
	V.Local.bEditSO.Declare
	V.Local.bIssueGrp.Declare
	V.Local.bWiptoFG.Declare
	V.Local.bChecked.Declare
	
	'Check if any of the menu items have edit permissions
	F.Global.Security.CheckUserAccessIPM(371,0,V.Local.bEditInventory)
	F.Global.Security.CheckUserAccessIPM(527,1,V.Local.bEditWO)
	F.Global.Security.CheckUserAccessIPM(265,1,V.Local.bEditPO)
	F.Global.Security.CheckUserAccessIPM(132,1,V.Local.bEditSO)
	F.Global.Security.CheckUserAccessIPM(136,2,V.Global.bShipOEPermission)
	F.Global.Security.CheckUserAccessIPM(661,2,V.Global.bShipSHIPPermission)
	Gui.FrmOrderReview.optView.Value(True)
	
	F.Intrinsic.Control.If(V.Local.bEditInventory,=,True,or,V.Local.bEditWO,=,True,V.Local.bEditPO,=,True,V.Local.bEditSO,=,True)
		Gui.FrmOrderReview.optEdit.Enabled(True)	
		Gui.FrmOrderReview.optEdit.Value(True)
	F.Intrinsic.Control.EndIf

	Function.Global.Security.CheckUserAccessIPM(533,0,V.Local.bIssueGrp)
	F.Intrinsic.Control.If(V.Local.bIssueGrp,=,True)
		Gui.FrmOrderReview.optIssue.Enabled(True)
	F.Intrinsic.Control.EndIf

	Function.Global.Security.CheckUserAccessIPM(544,0,V.Local.bWiptoFG)
	F.Intrinsic.Control.If(V.Local.bWiptoFG,=,True)
		Gui.FrmOrderReview.optWiptoFG.Enabled(True)
	F.Intrinsic.Control.EndIf
	
	'Ship Radio button
	F.Intrinsic.Control.If(V.Global.bShipOEPermission,=,True,OR,V.Global.bShipSHIPPermission,=,True)
		Gui.FrmOrderReview.optShip.Enabled(1)
		V.Global.bShip.Set(True)
		F.Intrinsic.Control.If(V.Local.bChecked,=,False)
			Gui.FrmOrderReview.optShip.Value(True)
			V.Local.bChecked.Set(True)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		Gui.FrmOrderReview.optShip.Enabled(0)
		V.Global.bShip.Set(False)
		Gui.FrmOrderReview.optShip.Value(False)
		V.Local.bChecked.Set(False)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.CheckPermissions.End

Program.Sub.SetContextMenus.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare	
	V.Local.bEditSO.Declare	
	V.Local.bEditWO.Declare
	
	Gui.FrmOrderReview..ContextMenuCreate("ctxAll")
	Gui.FrmOrderReview.GsGCAllOpen.ContextMenuAttach("ctxAll")
	Gui.FrmOrderReview..ContextMenuAddItem("ctxAll","AutoWO",0,"Auto WO Gen.")
	Gui.FrmOrderReview..ContextMenuAddItem("ctxAll","AutoPO",0,"Auto PO Gen.")
	Gui.FrmOrderReview..ContextMenuAddItem("ctxAll","CreatePart",0,"Create/Verify parts")
	Gui.FrmOrderReview..ContextMenuAddItem("ctxAll","CreateRtr",0,"Create/Verify routers")
	Gui.FrmOrderReview..ContextMenuAddItem("ctxAll","CreateBOM",0,"Create/Verify BOM")
	Gui.FrmOrderReview..ContextMenuAddItem("ctxAll","OpenDoc",0,"Open Documents for Parts")
	Gui.FrmOrderReview..ContextMenuAddItem("ctxAll","PrintDoc",0,"Print Documents for WO")
	Gui.FrmOrderReview..ContextMenuAddItem("ctxAll","Resched",0,"Reschedule")
	Gui.FrmOrderReview..ContextMenuAddItem("ctxAll","Refresh",0,"Refresh")
	Gui.FrmOrderReview..ContextMenuAddItem("ctxAll","Export",0,"Export")		
	Gui.FrmOrderReview..ContextMenuAddItem("ctxAll","ResetColumns",0,"Reset Columns")
	Gui.FrmOrderReview..ContextMenuSetItemEventHandler("ctxAll","Refresh","MenuClickRefresh")
	Gui.FrmOrderReview..ContextMenuSetItemEventHandler("ctxAll","Export","MenuClickExport")
	Gui.FrmOrderReview..ContextMenuSetItemEventHandler("ctxAll","ResetColumns","MenuClickResetColumns")
	Gui.FrmOrderReview..ContextMenuSetItemEventHandler("ctxAll","AutoWO","cmdBWDSched_Click")
	Gui.FrmOrderReview..ContextMenuSetItemEventHandler("ctxAll","Resched","cmdResched_Click")
	Gui.FrmOrderReview..ContextMenuSetItemEventHandler("ctxAll","PrintDoc","cmdPrintDoc_Click")
	Gui.FrmOrderReview..ContextMenuSetItemEventHandler("ctxAll","OpenDoc","cmdOpenDoc_Click")
	Gui.FrmOrderReview..ContextMenuSetItemEventHandler("ctxAll","AutoPO","cmdCreatePO_click")
	Gui.FrmOrderReview..ContextMenuSetItemEventHandler("ctxAll","CreatePart","cmdCreateParts_Click")
	Gui.FrmOrderReview..ContextMenuSetItemEventHandler("ctxAll","CreateRtr","cmdCreateRtr_Click")
	Gui.FrmOrderReview..ContextMenuSetItemEventHandler("ctxAll","CreateBOM","cmdCreateBOM_Click")
		
	Gui.FrmOrderReview..ContextMenuCreate("ctxPastDue")
	'Gui.FrmOrderReview.GsGCPastDue.ContextMenuAttach("ctxPastDue")
	Gui.FrmOrderReview..ContextMenuAddItem("ctxPastDue","Refresh",0,"Refresh")
	Gui.FrmOrderReview..ContextMenuAddItem("ctxPastDue","Export",0,"Export")		
	Gui.FrmOrderReview..ContextMenuAddItem("ctxPastDue","ResetColumns",0,"Reset Columns")
	Gui.FrmOrderReview..ContextMenuSetItemEventHandler("ctxPastDue","Refresh","MenuClickRefresh")
	Gui.FrmOrderReview..ContextMenuSetItemEventHandler("ctxPastDue","Export","MenuClickExport")
	Gui.FrmOrderReview..ContextMenuSetItemEventHandler("ctxPastDue","ResetColumns","MenuClickResetColumns")	
		
	Function.Global.Security.CheckUserAccessIPM(132,1,V.Local.bEditSO)
	F.Intrinsic.Control.If(V.Local.bEditSO)
		Gui.FrmOrderReview..ContextMenuAddItem("ctxAll","NewSO",0,"New SO")
		Gui.FrmOrderReview..ContextMenuSetItemEventHandler("ctxAll","NewSO","MenuClickNewSO")
		Gui.FrmOrderReview..ContextMenuAddItem("ctxPastDue","NewSO",0,"New SO")
		Gui.FrmOrderReview..ContextMenuSetItemEventHandler("ctxPastDue","NewSO","MenuClickNewSO")
	F.Intrinsic.Control.EndIf	
	
	Function.Global.Security.CheckUserAccessIPM(527,1,V.Local.bEditWO)
	F.Intrinsic.Control.If(V.Local.bEditWO)
		Gui.FrmOrderReview..ContextMenuAddItem("ctxAll","NewWO",0,"New WO")
		Gui.FrmOrderReview..ContextMenuSetItemEventHandler("ctxAll","NewWO","MenuClickNewWO")
		Gui.FrmOrderReview..ContextMenuAddItem("ctxPastDue","NewWO",0,"New WO")
		Gui.FrmOrderReview..ContextMenuSetItemEventHandler("ctxPastDue","NewWO","MenuClickNewWO")		
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.SetContextMenus.End

Program.Sub.MenuClickRefresh.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.FrmOrderReview.GsGCAllOpen.enabled(false)
	F.Intrinsic.Control.CallSub(cmdRefresh_Click)
	Gui.FrmOrderReview.GsGCAllOpen.enabled(true)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickRefresh.End

Program.Sub.MenuClickExport.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sFileExport.Declare
	V.Local.bExcel.Declare
	V.Local.bFileLocked.Declare
	V.Local.sMsg.Declare
	V.Local.sControl.Declare
	
	F.Intrinsic.Control.SelectCase(V.Args.MenuName)
		F.Intrinsic.Control.Case("CTXALL")
			V.Local.sControl.Set("GsGCAllOpen")
		F.Intrinsic.Control.Case("CTXPASTDUE")
			V.Local.sControl.Set("GsGCPastDue")
	F.Intrinsic.Control.EndSelect

	F.Automation.MSExcel.CheckPresence(V.Local.bExcel)
	F.Intrinsic.Control.If(V.Local.bExcel)
		F.Intrinsic.String.Build("{0}\GCG_6088_{1}_Export.xlsx",V.Caller.LocalGssTempDir,V.Local.sControl,V.Local.sFileExport)
		F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
		F.Intrinsic.Control.If(V.Local.bFileLocked)
			F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
			F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
		F.Intrinsic.Control.Else
			Gui.FrmOrderReview.[V.Local.sControl].Export(V.Local.sFileExport,"xlsx")
			F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Else
		F.Intrinsic.String.Build("{0}\GCG_6088_{1}_Export.csv",V.Caller.LocalGssTempDir,V.Local.sControl,V.Local.sFileExport)
		F.Intrinsic.File.IsFileLocked(V.Local.sFileExport,V.Local.bFileLocked)
		F.Intrinsic.Control.If(V.Local.bFileLocked)
			F.Intrinsic.String.Build("File is already open. Please close and export again.{0}File: {1}",V.Ambient.NewLine,V.Local.sFileExport,V.Local.sMsg)
			F.Intrinsic.UI.Msgbox(V.Local.sMsg,"File In Use")
		F.Intrinsic.Control.Else
			Gui.FrmOrderReview.[V.Local.sControl].Export(V.Local.sFileExport,"csv")
		F.Intrinsic.Control.EndIf
		F.Intrinsic.Task.ShellExec(0,"",V.Local.sFileExport,"","",1)
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickExport.End

Program.Sub.MenuClickResetColumns.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Control.SelectCase(V.Args.MenuName)
		F.Intrinsic.Control.Case("CTXALL")
			F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVALL",6088,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,"")
		F.Intrinsic.Control.Case("CTXPASTDUE")
			F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVPASTDUE",6088,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,"")
	F.Intrinsic.Control.EndSelect
	
	V.Global.bLoadData.Set(False)
	F.Intrinsic.Control.CallSub(cmdRefresh_Click)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickResetColumns.End

Program.Sub.MenuClickNewSO.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare	
	V.Local.iRowCnt.Declare
	V.Local.iRowCnt2.Declare
	
	F.ODBC.Connection!con.ExecuteAndReturn("SELECT COUNT(*) FROM V_ORDER_HEADER;",V.Local.iRowCnt)
				
	'Gui.FrmOrderReview.tabSO.Enabled(False)
	Gui.FrmOrderReview.GsGCAllOpen.enabled(False)
	F.Global.General.CallWrapperSync(200000,"*!*ZDR*!*!*!N!*!*!*ZDR*!*")	
	'Gui.FrmOrderReview.tabSO.Enabled(True)
	Gui.FrmOrderReview.GsGCAllOpen.enabled(True)

	F.ODBC.Connection!con.ExecuteAndReturn("SELECT COUNT(*) FROM V_ORDER_HEADER;",V.Local.iRowCnt2)

	F.Intrinsic.Control.If(V.Local.iRowCnt,<>,V.Local.iRowCnt2)
		F.Intrinsic.Control.CallSub(cmdrefresh_click)	
	F.Intrinsic.Control.EndIf
		
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickNewSO.End

Program.Sub.MenuClickNewWO.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.iRowCnt.Declare
	V.Local.iRowCnt2.Declare
	V.Local.iPID.Declare
	V.Local.bPID.Declare
	
	F.ODBC.Connection!con.ExecuteAndReturn("SELECT COUNT(*) FROM JOB_HEADER;",V.Local.iRowCnt)

	'Gui.FrmOrderReview.tabSO.Enabled(False)
	Gui.FrmOrderReview.GsGCAllOpen.enabled(False)
	F.Global.General.LaunchMenuTask(527,2,V.Local.iPID)
	F.Intrinsic.Task.PIDRunning(V.Local.iPID,V.Local.bPID)
	F.Intrinsic.Control.DoUntil(V.Local.bPID,=,False)
	F.Intrinsic.UI.SleepMS(10)
	F.Intrinsic.Task.PIDRunning(V.Local.iPID,V.Local.bPID)
	F.Intrinsic.Control.Loop
	Gui.FrmOrderReview.GsGCAllOpen.enabled(True)
	'Gui.FrmOrderReview.tabSO.Enabled(True)

	F.ODBC.Connection!con.ExecuteAndReturn("SELECT COUNT(*) FROM JOB_HEADER;",V.Local.iRowCnt2)

	F.Intrinsic.Control.If(V.Local.iRowCnt,<>,V.Local.iRowCnt2)
		F.Intrinsic.Control.CallSub(cmdrefresh_click)
	F.Intrinsic.Control.EndIf
		
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.MenuClickNewWO.End

Program.Sub.picGSSLogo_DblClick.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	F.Intrinsic.Task.ShellExec(0,"Open","http://www.globalshopsolutions.com/login-customer","","",0)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End 
	F.Intrinsic.Control.EndTry
Program.Sub.picGSSLogo_DblClick.End

Program.Sub.Serialize.Start
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	V.Local.sSerialize.Declare
	
	'gvAll
	Gui.FrmOrderReview.GsGCAllOpen.Serialize("gvAll",V.Local.sSerialize)
	F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVALL",6088,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
	'gvMaster
	Gui.FrmOrderReview.GsGCAllOpen.Serialize("gvMaster",V.Local.sSerialize)
	F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVMASTER",6088,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
	'gvPastDue
	'Gui.FrmOrderReview.GsGCPastDue.Serialize("gvPastDue",V.Local.sSerialize)
	'F.Global.Registry.AddValue(V.Caller.User,V.Caller.CompanyCode,"GVPASTDUE",6088,1000,False,"Serialize",False,0,-999.0,1/1/1980,12:00:00 AM,V.Local.sSerialize)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.Serialize.End

Program.Sub.Deserialize.Start
	F.Intrinsic.Control.Try
		V.Local.sError.Declare
		
		V.Local.sSerialize.Declare
		
		'Delete old registry records
		F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVALL",6088,0,5,"",V.Local.sSerialize)
		F.Intrinsic.Control.If(V.Local.sSerialize.Trim,<>,"")
			F.ODBC.Connection!common.OpenConnection(V.Ambient.Ccon,V.Ambient.Cuser,V.Ambient.Cpass)
			F.ODBC.Connection!common.Execute("Delete From Gs_Registry Where Reg_ID = 6088 And Seq < 1000;")
			F.ODBC.Connection!common.Close
		F.Intrinsic.Control.EndIf
	
		'gvAll
		F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVALL",6088,1000,6,"",V.Local.sSerialize)
		F.Intrinsic.Control.If(V.Local.sSerialize.Trim,<>,"")
			Gui.FrmOrderReview.GsGCAllOpen.Deserialize(V.Local.sSerialize)
		F.Intrinsic.Control.EndIf
		'gvMaster
		F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVMASTER",6088,1000,6,"",V.Local.sSerialize)
		F.Intrinsic.Control.If(V.Local.sSerialize.Trim,<>,"")
			Gui.FrmOrderReview.GsGCAllOpen.Deserialize(V.Local.sSerialize)
		F.Intrinsic.Control.EndIf
		'gvPastDue
		'F.Global.Registry.ReadValue(V.Caller.User,V.Caller.CompanyCode,"GVPASTDUE",6088,1000,6,"",V.Local.sSerialize)
		'F.Intrinsic.Control.If(V.Local.sSerialize.Trim,<>,"")
			'Gui.FrmOrderReview.GsGCPastDue.Deserialize(V.Local.sSerialize)
		'F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.Deserialize.End

Program.Sub.cmdCreateWO_Click.Start
F.Intrinsic.Control.CallSub(cmdBWDSched_Click)
Program.Sub.cmdCreateWO_Click.End

Program.Sub.cmdOpenDoc_Click.Start
F.Intrinsic.Control.Try

	Gui.FrmOrderReview.GsGCAllOpen.enabled(False)
	V.Local.i.Declare(long)
	V.Local.j.Declare(long)
	V.Local.k.Declare(long)
	V.Local.ssql.Declare(string)
	V.Local.sjob.Declare(string)
	V.Local.sSuF.Declare(string)
	V.Local.sret.Declare(string)
	V.Local.sPart.Declare(string)
	V.Local.sMessage.Declare(string)
	V.Local.sShortRet.Declare(string)
	V.Local.sTemp.Declare(string)
	V.Local.iLinkID.Declare(long)
	V.Local.lRet.Declare(long)
	
	F.Intrinsic.Control.If(V.DataTable.dtPrint.Exists)
		F.Data.DataTable.Close("dtPrint")
	F.Intrinsic.Control.EndIf	
	
	F.Data.DataTable.Create("dtPrint","true")
	F.Data.DataTable.AddColumn("dtPrint","Part","String")
	F.Data.DataTable.AddColumn("dtPrint","Job","String")
	F.Data.DataTable.AddColumn("dtPrint","Suffix","String")
	
	'Verify if the user wants to do this.
	F.Intrinsic.String.Concat("Open Documents for: ",V.Ambient.NewLine,V.Local.sMessage)
	F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.dtAll.RowCount--,1)
		F.Intrinsic.Control.If(V.DataTable.dtAll(V.Local.i).ScheduleWO!fieldval,=,"True")
			V.Local.spart.Set(V.DataTable.dtAll(V.Local.i).SOPart!fieldvaltrim)
			F.Intrinsic.String.Concat(V.Local.sMessage," ",V.DataTable.dtAll(V.Local.i).SOPart!fieldval," --- ",V.DataTable.dtAll(V.Local.i).Description!fieldval,V.Ambient.NewLine,V.Local.sMessage)
			F.Data.DataTable.AddRow("dtPrint","Part",V.Local.spart)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.i)
	
	'Reset i before continuing on
	V.Local.i.Set(0)
	F.Intrinsic.Control.If(V.DataTable.dtPrint.RowCount,<>,0)
		F.Intrinsic.UI.Msgbox(V.Local.sMessage,"Open Documents?",4,V.Local.lret)
	F.Intrinsic.Control.Else
		F.Intrinsic.UI.Msgbox("No valid lines selected.")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Local.lret,=,6)
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.dtPrint.RowCount--,1)
			V.Local.spart.Set(V.DataTable.dtPrint(V.Local.i).Part!fieldvaltrim)		
			F.Global.Inventory.GetGSSPart(V.Local.sPart,"",V.Local.sShortRet)
			F.Global.DocumentControl.CreateReference(V.Local.sShortRet,30,V.Local.iLinkID)
			F.Intrinsic.Control.If(V.Local.iLinkID,>,0)
				'Grab the files
				F.Intrinsic.String.Build("SELECT * FROM ATG_DOC_ASSOC WHERE LINK_ID = {0}",V.Local.iLinkID,V.Local.ssql)
				F.Intrinsic.Control.If(V.DataTable.dtFiles.Exists)
					F.Data.DataTable.Close("dtFiles")
				F.Intrinsic.Control.EndIf
				F.Data.DataTable.CreateFromSQL("dtFiles",con,V.Local.ssql,true)
				
				F.Intrinsic.Control.If(V.DataTable.dtFiles.RowCount,<>,0)
					F.Intrinsic.Control.For(V.Local.k,0,V.DataTable.dtFiles.RowCount--,1)
						
						F.Intrinsic.String.Right(V.DataTable.dtFiles(V.Local.k).PATH!FieldvalTrim,1,V.Local.stemp)
						F.Intrinsic.Control.If(V.Local.sTemp,=,"\")
							F.Intrinsic.String.Concat(V.DataTable.dtFiles(V.Local.k).PATH!FieldvalTrim,V.DataTable.dtFiles(V.Local.k).FILE!FieldvalTrim,V.Local.stemp)
						F.Intrinsic.Control.Else
							F.Intrinsic.String.Concat(V.DataTable.dtFiles(V.Local.k).PATH!FieldvalTrim,"\",V.DataTable.dtFiles(V.Local.k).FILE!FieldvalTrim,V.Local.stemp)
						F.Intrinsic.Control.EndIf
						
						'If it cannot print a document, catch it
						F.Intrinsic.Control.Try
							F.Intrinsic.task.ShellExec(V.Caller.Handle,"OPEN",V.local.sTemp,"","",5)
						F.Intrinsic.Control.Catch
						F.Intrinsic.Control.EndTry
						F.Intrinsic.UI.SleepMS(3000)
					F.Intrinsic.Control.Next(V.Local.k)
				F.Intrinsic.Control.Else
					F.Intrinsic.String.Concat("No documents found for part: ",V.Local.sPart,V.Local.sMessage)
					F.Intrinsic.UI.Msgbox(V.Local.sMessage)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.Next(V.Local.i)
		
		F.Intrinsic.Control.CallSub(cmdrefresh_click)
	F.Intrinsic.Control.EndIf
	
	Gui.FrmOrderReview.GsGCAllOpen.enabled(True)
F.Intrinsic.Control.Catch
	F.Intrinsic.UI.Msgbox(V.Ambient.ErrorDescription)
	F.Intrinsic.Control.CallSub(FrmOrderReview_UnLoad)
F.Intrinsic.Control.EndTry
Program.Sub.cmdOpenDoc_Click.End

Program.Sub.cmdPrintDoc_Click.Start
F.Intrinsic.Control.Try

	Gui.FrmOrderReview.GsGCAllOpen.enabled(False)
	V.Local.i.Declare(long)
	V.Local.j.Declare(long)
	V.Local.k.Declare(long)
	V.Local.ssql.Declare(string)
	V.Local.sjob.Declare(string)
	V.Local.sSuF.Declare(string)
	V.Local.sret.Declare(string)
	V.Local.sPart.Declare(string)
	V.Local.sMessage.Declare(string)
	V.Local.sShortRet.Declare(string)
	V.Local.sTemp.Declare(string)
	V.Local.iLinkID.Declare(long)
	V.Local.lRet.Declare(long)
	
	F.Intrinsic.Control.If(V.DataTable.dtPrint.Exists)
		F.Data.DataTable.Close("dtPrint")
	F.Intrinsic.Control.EndIf	
	
	F.Data.DataTable.Create("dtPrint","true")
	F.Data.DataTable.AddColumn("dtPrint","Part","String")
	F.Data.DataTable.AddColumn("dtPrint","Job","String")
	F.Data.DataTable.AddColumn("dtPrint","Suffix","String")
	
	'Verify if the user wants to do this.
	F.Intrinsic.String.Concat("Print Documents for: ",V.Ambient.NewLine,V.Local.sMessage)
	F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.dtMaster$dtAll.RowCount--,1)
		F.Intrinsic.Control.If(V.DataTable.dtMaster$dtAll(V.Local.i).ScheduleWO!fieldval,=,"True")
			F.Intrinsic.Control.If(V.DataTable.dtMaster$dtAll(V.Local.i).CODE_SOURCE!fieldvaltrim,=,"MJ","or",V.DataTable.dtMaster$dtAll(V.Local.i).CODE_SOURCE!fieldvaltrim,=,"MS")
				V.Local.spart.Set(V.DataTable.dtMaster$dtAll(V.Local.i).SOPart!fieldvaltrim)
				V.Local.sJob.Set(V.DataTable.dtMaster$dtAll(V.Local.i).WO!fieldvaltrim)
				V.Local.sSuF.Set(V.DataTable.dtMaster$dtAll(V.Local.i).SUFFIX!FIELDVALTRIM)	
				F.Intrinsic.String.Concat(V.Local.sMessage," ",V.DataTable.dtMaster$dtAll(V.Local.i).SOPart!fieldval," --- ",V.DataTable.dtMaster$dtAll(V.Local.i).Description!fieldval,V.Ambient.NewLine,V.Local.sMessage)
				F.Data.DataTable.AddRow("dtPrint","Part",V.Local.spart,"Job",V.Local.sJob,"Suffix",V.Local.sSuf)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.i)
	
	'Reset i before continuing on
	V.Local.i.Set(0)
	F.Intrinsic.Control.If(V.DataTable.dtPrint.RowCount,<>,0)
		F.Intrinsic.UI.Msgbox(V.Local.sMessage,"Print Documents?",4,V.Local.lret)
	F.Intrinsic.Control.Else
		F.Intrinsic.UI.Msgbox("No valid lines selected.  Please double check that the source code is Manufactured (M or F).")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Local.lret,=,6)
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.dtPrint.RowCount--,1)
			V.Local.spart.Set(V.DataTable.dtPrint(V.Local.i).Part!fieldvaltrim)
			V.Local.sJob.Set(V.DataTable.dtPrint(V.Local.i).Job!fieldvaltrim)
			V.Local.sSuF.Set(V.DataTable.dtPrint(V.Local.i).Suffix!FIELDVALTRIM)				
			F.Global.Inventory.GetGSSPart(V.Local.sPart,"",V.Local.sShortRet)

			'Grab Ids
			F.Intrinsic.String.Build("Select Part From V_JOB_Header Where Job = '{0}' And Suffix = '{1}'",V.Local.sjob,V.Local.sSuf,V.Local.sSql)
			F.Intrinsic.Control.If(V.DataTable.dtGrab.Exists)
				F.Data.DataTable.Close("dtGrab")
			F.Intrinsic.Control.EndIf
			F.Data.DataTable.CreateFromSQL("dtGrab",con,V.Local.ssql,true)
			F.Intrinsic.Control.For(V.Local.j,0,V.DataTable.dtGrab.RowCount--,1)
				
				F.Global.DocumentControl.CreateReference(V.DataTable.dtGrab(V.Local.j).PART!FIELDVALTRIM,30,V.Local.iLinkID)
				F.Intrinsic.Control.If(V.Local.iLinkID,>,0)
					
					'Grab the files
					F.Intrinsic.String.Build("SELECT * FROM ATG_DOC_ASSOC WHERE LINK_ID = {0}",V.Local.iLinkID,V.Local.ssql)
					F.Intrinsic.Control.If(V.DataTable.dtFiles.Exists)
						F.Data.DataTable.Close("dtFiles")
					F.Intrinsic.Control.EndIf
					F.Data.DataTable.CreateFromSQL("dtFiles",con,V.Local.ssql,true)
					
					F.Intrinsic.Control.If(V.DataTable.dtFiles.RowCount,<>,0)
						F.Intrinsic.Control.For(V.Local.k,0,V.DataTable.dtFiles.RowCount--,1)
							
							F.Intrinsic.String.Right(V.DataTable.dtFiles(V.Local.k).PATH!FieldvalTrim,1,V.Local.stemp)
							F.Intrinsic.Control.If(V.Local.sTemp,=,"\")
								F.Intrinsic.String.Concat(V.DataTable.dtFiles(V.Local.k).PATH!FieldvalTrim,V.DataTable.dtFiles(V.Local.k).FILE!FieldvalTrim,V.Local.stemp)
							F.Intrinsic.Control.Else
								F.Intrinsic.String.Concat(V.DataTable.dtFiles(V.Local.k).PATH!FieldvalTrim,"\",V.DataTable.dtFiles(V.Local.k).FILE!FieldvalTrim,V.Local.stemp)
							F.Intrinsic.Control.EndIf
							
							'If it cannot print a document, catch it
							F.Intrinsic.Control.Try
								F.Intrinsic.task.ShellExec(V.Caller.Handle,"PRINT",V.local.sTemp,"","",5)
							F.Intrinsic.Control.Catch
							F.Intrinsic.Control.EndTry
							F.Intrinsic.UI.SleepMS(3000)
						F.Intrinsic.Control.Next(V.Local.k)
					F.Intrinsic.Control.Else
						F.Intrinsic.String.Concat("No documents found for part: ",V.Local.sPart,V.Local.sMessage)
						F.Intrinsic.UI.Msgbox(V.Local.sMessage)
					F.Intrinsic.Control.EndIf
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.Next(V.Local.j)
		F.Intrinsic.Control.Next(V.Local.i)
		
		F.Intrinsic.Control.CallSub(cmdrefresh_click)
	F.Intrinsic.Control.EndIf
	
	Gui.FrmOrderReview.GsGCAllOpen.enabled(True)
F.Intrinsic.Control.Catch
	F.Intrinsic.UI.Msgbox(V.Ambient.ErrorDescription)
	F.Intrinsic.Control.CallSub(FrmOrderReview_UnLoad)
F.Intrinsic.Control.EndTry
Program.Sub.cmdPrintDoc_Click.End

Program.Sub.cmdCreateParts_Click.Start
F.Intrinsic.Control.Try

	Gui.FrmOrderReview.GsGCAllOpen.enabled(False)
	V.Local.i.Declare(long)
	V.Local.j.Declare(long)
	V.Local.ssql.Declare(string)
	V.Local.spart.Declare(string)
	V.Local.sUm.Declare(string)
	V.Local.sDescription.Declare(string)
	V.Local.sLoc.Declare(string)
	V.Local.sPL.Declare(string)
	V.Local.sSource.Declare(string)
	V.Local.sMessage.Declare(string)
	V.Local.sShortRet.Declare(string)
	V.Local.sParams.Declare(string)
	V.Local.sLongDesc.Declare(string)
	V.Local.fPrice.Declare(float)
	V.Local.lret.Declare(long)
	
	F.Intrinsic.Control.If(V.DataTable.dtParts.Exists)
		F.Data.DataTable.Close("dtParts")
	F.Intrinsic.Control.EndIf	
	
	F.Data.DataTable.Create("dtParts","true")
	F.Data.DataTable.AddColumn("dtParts","Part","String")
	F.Data.DataTable.AddColumn("dtParts","Desc","String")
	F.Data.DataTable.AddColumn("dtParts","PrdL","String")
	F.Data.DataTable.AddColumn("dtParts","UoMs","String")
	F.Data.DataTable.AddColumn("dtParts","Long","String")
	F.Data.DataTable.AddColumn("dtParts","Prce","Float")
	F.Data.DataTable.AddColumn("dtParts","Orig","Long")
	'Verify if the user wants to do this.
	F.Intrinsic.String.Concat("Create/Maintain Parts for: ",V.Ambient.NewLine,V.Local.sMessage)
	F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.dtAll.RowCount--,1)
		F.Intrinsic.Control.If(V.DataTable.dtAll(V.Local.i).ScheduleWO!fieldval,=,"True")
			F.Intrinsic.String.Build("select um_order from V_ORDER_LINES where ORDER_NO='{0}' and RECORD_NO='{1}0'",V.DataTable.dtAll(V.Local.i).SO!FIELDVALTRIM,V.DataTable.dtAll(V.Local.i).SOLine!FIELDVALTRIM,V.Local.ssql)
			F.ODBC.Connection!con.executeandreturn(V.Local.ssql,V.Local.sUm)
			F.Intrinsic.String.Build("select price_order from V_ORDER_LINES where ORDER_NO='{0}' and RECORD_NO='{1}0'",V.DataTable.dtAll(V.Local.i).SO!FIELDVALTRIM,V.DataTable.dtAll(V.Local.i).SOLine!FIELDVALTRIM,V.Local.ssql)
			F.ODBC.Connection!con.executeandreturn(V.Local.ssql,V.Local.fPrice)
			'Get long Description
			F.Intrinsic.String.Build("SELECT text from ORDER_LN_TEXT WHERE ORDER_NUM='{0}' AND ORDER_LINE='{1}0'",V.DataTable.dtAll(V.Local.i).SO!FIELDVALTRIM,V.DataTable.dtAll(V.Local.i).SOLine!fieldvaltrim,V.Local.ssql)
			F.Intrinsic.Control.If(V.DataTable.dtLng.Exists)
				F.Data.DataTable.Close("dtLng")
			F.Intrinsic.Control.EndIf
			F.Data.DataTable.CreateFromSQL("dtLng",con,V.Local.ssql,true)
			F.Intrinsic.Control.For(V.Local.j,0,V.DataTable.dtLng.RowCount--,1)
				F.Intrinsic.String.Concat(V.Local.sLongDesc,V.DataTable.dtLng(V.Local.j).TEXT!FIELDVALTRIM,V.Ambient.NewLine,V.Local.sLongDesc)
			F.Intrinsic.Control.Next(V.Local.j)
			V.Local.spart.Set(V.DataTable.dtAll(V.Local.i).SOPart!fieldvaltrim)
			V.Local.sDescription.Set(V.DataTable.dtAll(V.Local.i).Description!fieldvaltrim)
			V.Local.sPL.Set(V.DataTable.dtAll(V.Local.i).Product_Line!FIELDVALTRIM)	
			F.Intrinsic.String.Concat(V.Local.sMessage," ",V.DataTable.dtAll(V.Local.i).SOPart!fieldval," --- ",V.DataTable.dtAll(V.Local.i).Description!fieldval,V.Ambient.NewLine,V.Local.sMessage)
			F.Data.DataTable.AddRow("dtParts","Part",V.Local.spart,"Desc",V.Local.sDescription,"PrdL",V.Local.sPL,"UoMs",V.Local.sUm,"Prce",V.Local.fPrice,"Orig",V.Local.i,"Long",V.Local.sLongDesc)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.i)
	
	'Reset i before continuing on
	V.Local.i.Set(0)
	F.Intrinsic.UI.Msgbox(V.Local.sMessage,"Create Parts?",4,V.Local.lret)
	F.Intrinsic.Control.If(V.Local.lret,=,6)
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.dtParts.RowCount--,1)
			V.Local.spart.Set(V.DataTable.dtParts(V.Local.i).Part!fieldvaltrim)
			V.Local.sDescription.Set(V.DataTable.dtParts(V.Local.i).Desc!fieldvaltrim)
			V.Local.sPL.Set(V.DataTable.dtParts(V.Local.i).PrdL!FIELDVALTRIM)
			V.Local.sUm.Set(V.DataTable.dtParts(V.Local.i).UoMs!FIELDVALTRIM)		
			V.Local.sLongDesc.Set(V.DataTable.dtParts(V.Local.i).Long!fieldvaltrim)
			V.Local.fPrice.Set(V.DataTable.dtParts(V.Local.i).Prce!fieldval)
			F.Global.Inventory.GetGSSPart(V.Local.sPart,"",V.Local.sShortRet)
			F.Global.Inventory.CreatePart(V.Local.sShortRet,V.Local.sUm,V.Local.sDescription,V.Local.sLoc,V.Local.sPL,"","","",V.Local.fPrice,"INVMAINT")
			F.Intrinsic.Control.CallSub(longdesc,"Part",V.Local.sShortRet,"LongDesc",V.Local.sLongDesc)
			F.Intrinsic.String.ConcatCallWrapperArgs("O","D",V.Local.sShortRet,V.Local.sParams)
			F.Intrinsic.String.Concat(V.Caller.CompanyCode,"!*!","O","!*!","!*!","!*!",V.Local.sShortRet.UCase,"!*!","",V.Local.sParams)
			F.Global.General.CallWrappersync(3500,V.Local.sParams)
			F.Data.DataTable.SetValue("dtAll",V.DataTable.dtParts(V.Local.i).Orig!Fieldval,"ScheduleWO","False")
			F.Data.DataTable.SetValue("dtAll",V.DataTable.dtParts(V.Local.i).Orig!fieldval,"GSSPart",V.Local.sShortRet)
		F.Intrinsic.Control.Next(V.Local.i)
	F.Intrinsic.Control.EndIf
	
	Gui.FrmOrderReview.GsGCAllOpen.enabled(True)
F.Intrinsic.Control.Catch
	F.Intrinsic.UI.Msgbox(V.Ambient.ErrorDescription)
	F.Intrinsic.Control.CallSub(FrmOrderReview_UnLoad)
F.Intrinsic.Control.EndTry
Program.Sub.cmdCreateParts_Click.End

Program.Sub.longDesc.Start
F.Intrinsic.Control.Try
	V.Local.ssql.Declare
	V.Local.sret.Declare
	V.Local.spart.Declare
	V.Local.sLong.Declare
	V.Local.spart.Set(V.Args.part)
	V.Local.sLong.Set(V.Args.longdesc)
	
	F.Intrinsic.String.Build("SELECT PART, TEXT FROM INV_EXTRA_TEXT WHERE PART='{0}'",V.Local.spart,V.Local.ssql)
	F.ODBC.Connection!con.executeandreturn(V.Local.ssql,V.Local.sret)
	F.Intrinsic.Control.If(V.Local.sret.Trim,=,"")
		F.Intrinsic.String.Build("INSERT INTO INV_EXTRA_TEXT VALUES ('{0}','{1}')",V.Local.spart,V.Local.sLong,V.Local.ssql)
		F.ODBC.Connection!con.execute(V.Local.ssql)
	F.Intrinsic.Control.Else
'		F.Intrinsic.String.Build("UPDATE INV_EXTRA_TEXT SET TEXT='{0}' WHERE PART='{1}'",V.Local.sLong,V.Local.spart,V.Local.ssql)
'		F.ODBC.Connection!con.execute(V.Local.ssql)
	F.Intrinsic.Control.EndIf
F.Intrinsic.Control.Catch
	F.Intrinsic.UI.Msgbox(V.Ambient.ErrorDescription)
F.Intrinsic.Control.EndTry
Program.Sub.longDesc.End

Program.Sub.Schedule.Start
F.Intrinsic.Control.Try
	Gui.FrmOrderReview.GsGCAllOpen.enabled(false)
	V.Local.sswitch.Declare
	V.Local.SSQL.Declare
	V.Local.irows.Declare(long)
	V.Local.iRows.Set(0)
	V.Local.i.Declare(long)
	V.Local.ddate.Declare(date)
	V.Local.dToday.Declare(date)
	V.Local.sdate.Declare
	V.Local.SDATELong.declare
	V.Local.sDateUS.Declare
	V.Local.DDATEUS.Declare(date)
	V.Local.SDUE.Declare
	V.Local.sDateSched.declare
	V.Local.sparams.Declare
	V.Local.sMessage.Declare
	V.Local.sret.Declare
	V.Local.lret.Declare(long)
	V.Local.sFileDir.Declare
	V.Local.spart.Declare
	V.Local.spartreV.Declare
	V.Local.fSuffix.Declare(float)
	V.Local.sSuffix.Declare
	V.Local.lID.Declare(long)
	V.Local.lSched.Declare
	V.Local.sNames.Declare
	V.Local.sValues.Declare
	V.Local.sMChk.Declare
	V.Local.x.Declare(long)
	V.Local.y.Declare(long)
	V.Local.bExit.Declare(boolean)
	V.Local.sCMarkFile.Declare
	V.Local.sMark.Declare
	
	F.Intrinsic.String.Concat(V.Caller.GasDir,"\GCG_6088_COMPLETION.txt",V.Local.sCMarkFile)
	F.Intrinsic.File.File2String(V.Local.sCMarkFile,V.Local.sMark)
	
	
	V.Local.dToday.Set(V.Ambient.Date)
	V.Local.sswitch.Set(V.Args.sSwitch)
	F.Intrinsic.Control.If(V.DataTable.dtWO.Exists)
		F.Data.DataTable.Close("dtWO")
	F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.If(V.DataTable.dtWOP.Exists)
		F.Data.DataTable.Close("dtWOP")
	F.Intrinsic.Control.EndIf
	
	'Datatable for storing original work orders' position in the grid control
	F.Data.DataTable.Create("dtWO")
	F.Data.DataTable.AddColumn("dtWO","SO","string")
	F.Data.DataTable.AddColumn("dtWO","SOLine","string")
	F.Data.DataTable.AddColumn("dtWO","SODueDate","string")
	F.Data.DataTable.AddColumn("dtWO","OrigRow","long")
	
	'Datatable for printing work orders
	F.Data.DataTable.Create("dtWOP")
	F.Data.DataTable.AddColumn("dtWOP","WO","String")
	F.Data.DataTable.AddColumn("dtWOP","Suffix","string")
	
	'Start the process of formatting the data for Global Shop
	F.Intrinsic.Control.If(V.Local.sswitch,=,"N")
		F.Intrinsic.String.Concat("Create work orders for sales orders: ",V.Ambient.NewLine,V.Local.sMessage)
	F.Intrinsic.Control.ElseIf(V.Local.sswitch,=,"R")
		F.Intrinsic.String.Concat("Reschedule Work Orders: ",V.Ambient.NewLine,V.Local.sMessage)
	F.Intrinsic.control.EndIf
	
	F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.dtMaster$dtAll.RowCount--,1)
		F.Intrinsic.Control.If(V.DataTable.dtMaster$dtAll(V.Local.i).ScheduleWO!fieldval,=,"True")
			'F.Intrinsic.Debug.ShowCallerInfo
			F.Intrinsic.String.Left(V.DataTable.dtMaster$dtAll(V.Local.i).CODE_SOURCE!fieldvaltrim,1,V.Local.sMChk)
			'F.Intrinsic.Control.If(V.Local.sMChk.Trim,=,"M","or",V.DataTable.dtAll(V.Local.i).RtrCompl!fieldval,=,True)
			'omitted for demo only, put back!!!!
			'F.Intrinsic.Control.If(V.DataTable.dtAll(V.Local.i).RtrCompl!fieldval,=,V.Local.sMark)
				F.Intrinsic.String.Concat(V.Local.sMessage," ",V.DataTable.dtMaster$dtAll(V.Local.i).SO!fieldval,"-",V.DataTable.dtMaster$dtAll(V.Local.i).SOLINE!fieldval," ",V.DataTable.dtMaster$dtAll(V.Local.I).SOQty!FIELDVALTrim," of ",V.DataTable.dtMaster$dtAll(V.Local.I).SOPart!FieldvalTrim," ",V.Ambient.NewLine,V.Local.sMessage)
				F.Intrinsic.String.Mid(V.DataTable.dtMaster$dtAll(V.Local.i).SOPART!FIELDVAL,18,3,V.Local.spartrev)
				F.Intrinsic.String.mid(V.DataTable.dtMaster$dtAll(V.Local.i).SOPART!FIELDVAL,1,17,V.Local.spart)
				F.Data.DataTable.AddRow("dtWO","SO",V.DataTable.dtMaster$dtAll(V.Local.i).SO!FIELDVAL,"SOLine",V.DataTable.dtMaster$dtAll(V.Local.i).SOLINE!Fieldval,"SODueDate",V.DataTable.dtMaster$dtAll(V.Local.i).SODueDate!FIELDVALString,"OrigRow",V.Local.i)
			'F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.i)
	
	'Reset i before continuing on
	V.Local.i.Set(0)
	F.Intrinsic.Control.If(V.DataTable.dtWO.RowCount,<>,0)
		F.Intrinsic.UI.Msgbox(V.Local.sMessage,"Create Work Orders",4,V.Local.lret)
	F.Intrinsic.Control.Else
		F.Intrinsic.UI.Msgbox("No valid orders selected.  Please double check the router is complete.")
	F.Intrinsic.Control.EndIf
	
	'fIND OUT IF FORWARD SCHEDULING IS TURNED ON
	F.ODBC.Connection!con.executeandreturn("SELECT IFNULL(F_LONG,0) FROM OP_HEADER WHERE ID='401162' AND SEQUENCE='0000'",V.Local.lSched)
			
			
	F.Intrinsic.Control.If(V.Local.lret,=,6)
		F.Intrinsic.UI.InvokeWaitDialog("Generating Work Orders and Scheduling.")
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.dtWO.RowCount--,1)
			V.Local.ddate.set(V.DataTable.dtWO(V.Local.i).SODueDate!FieldValString)
			F.Intrinsic.String.Format(V.Local.ddate,"dd/mm/yyyy",V.Local.sdatesched)
			F.Intrinsic.String.Format(V.Local.ddate,"MMDDYY",V.Local.sdate)
			F.Intrinsic.String.Format(V.Local.ddate,"YYYYMMDD",V.Local.SDATELong)
			F.Intrinsic.String.Format(V.Local.ddate,"DD/MM/YY",V.Local.SDATEUS)
			'Create the WO from SO
			F.Intrinsic.Control.If(V.Local.sswitch,=,"N")
				F.Intrinsic.String.Concat("O!*!",V.DataTable.dtWO(V.local.i).SO!fieldvaltrim,"!*!",V.DataTable.dtWO(V.local.i).SOLine!fieldvaltrim,"0!*!1",V.Local.sparams)
				F.Global.General.CallWrappersync(200801,V.Local.sparams)
			F.Intrinsic.Control.EndIf
			
			'Uncheck the boxes
			F.Data.DataTable.SetValue("dtMaster$dtAll",V.DataTable.dtWO(V.Local.i).OrigRow!fieldvallong,"ScheduleWO","False")
			
			'WO Creation set, much faster
			F.Data.DataTable.SetValue("dtMaster$dtAll",V.DataTable.dtWO(V.Local.i).OrigRow!fieldvallong,"WOCreated","True")
		F.Intrinsic.Control.Next(V.Local.i)
		
		'Bumped this out after the fact, let the scheduling happen as is for speed reasons
		'AFter WO creation, grab the WO number
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.dtWO.RowCount--,1)
			F.Intrinsic.String.Build("SELECT JOB, SUFFIX FROM V_ORDER_TO_WO WHERE ORDER_NO='{0}' AND ORDER_LINE='{1}0'",V.DataTable.dtWO(V.local.i).SO!fieldvaltrim,V.DataTable.dtWO(V.local.i).SOLine!fieldvaltrim,V.Local.SSQL)
			F.ODBC.Connection!con.executeandreturn(V.Local.SSQL,V.Local.sret)
			F.Intrinsic.String.Split(V.Local.sret,"*!*",V.Local.sret)
			V.Local.ddate.set(V.DataTable.dtWO(V.Local.i).SODueDate!FieldValString)
			
			'Write the WO/Suffix to the cell
			F.Data.DataTable.SetValue("dtMaster$dtAll",V.DataTable.dtWO(V.Local.i).OrigRow!fieldvallong,"WO",V.Local.sret)
			F.Intrinsic.Control.If(V.Local.sret.UBound,>=,1)
				F.Data.DataTable.SetValue("dtMaster$dtAll",V.DataTable.dtWO(V.Local.i).OrigRow!fieldvallong,"Suffix",V.Local.sret(1))
				'Add it to print table
				F.Data.DataTable.AddRow("dtWOP","WO",V.Local.sret(0),"Suffix",V.Local.sret(1))
			F.Intrinsic.Control.Else
				'Add to print table, this routine should not happen.
				F.Data.DataTable.AddRow("dtWOP","WO",V.Local.sret(0),"Suffix","")
			F.Intrinsic.Control.EndIf
				
			F.Intrinsic.Control.If(V.Local.sswitch,=,"R")
				F.Intrinsic.Control.If(V.Local.lSched,=,"2","or",V.Local.lSched,=,"3")
					F.Global.APS.ScheduleJob(V.Local.sret(0),V.Local.sret(1),"F",V.Local.dToday)
				F.Intrinsic.Control.Else
					F.Global.APS.ScheduleJob(V.Local.sret(0),V.Local.sret(1),"B",V.Local.ddate)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.ElseIf(V.Local.sswitch,=,"N")
				'ONLY FORWARD SCHEDULE IF COMPANY OPTION TURNED ON.
				F.Intrinsic.Control.If(V.Local.lSched,=,"2","or",V.Local.lSched,=,"3")
					F.Global.APS.ScheduleJob(V.Local.sret(0),V.Local.sret(1),"F",V.Local.dToday)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			
			'If Suffix = '000' then it is a BOM and need to grab the others
			F.Intrinsic.Control.If(V.Local.sret.UBound,>=,1)
				F.Intrinsic.Control.If(V.Local.sret(1),=,"000")
					F.Intrinsic.string.Build("select max(suffix) from V_JOB_HEADER  where job='{0}'",V.Local.sret(0),V.Local.SSQL)
					F.ODBC.Connection!con.executeandreturn(V.Local.SSQL,V.Local.fSuffix)
					F.Intrinsic.Control.For(V.Local.x,1,V.Local.fSuffix,1)
						F.Intrinsic.String.LPad(V.Local.x,"0",3,V.Local.sSuffix)
						F.Data.DataTable.AddRow("dtWOP","WO",V.Local.sret(0),"Suffix",V.Local.sSuffix)
					F.Intrinsic.Control.next(V.Local.x)
				F.Intrinsic.Control.EndIf
			F.Intrinsic.Control.EndIf
			V.Local.fSuffix.Set(1)
		F.Intrinsic.Control.Next(V.Local.i)
		F.Intrinsic.Control.CallSub(cmdRefresh_Click)

		F.Intrinsic.UI.CloseWaitDialog
	F.Intrinsic.Control.EndIf
	Gui.FrmOrderReview.GsGCAllOpen.enabled(true)
F.Intrinsic.Control.Catch
	F.Intrinsic.UI.Msgbox(V.Ambient.ErrorDescription)
	F.ODBC.Connection!con.Close
	F.Intrinsic.Control.End
F.Intrinsic.Control.endtry
Program.Sub.Schedule.End

Program.Sub.cmdBWDSched_Click.Start
F.Intrinsic.Control.CallSub(schedule,"sSwitch","N")
Program.Sub.cmdBWDSched_Click.End

Program.Sub.cmdResched_Click.Start
F.Intrinsic.Control.CallSub(schedule,"sSwitch","R")
Program.Sub.cmdResched_Click.End

Program.Sub.cmdCreateRtr_Click.Start
F.Intrinsic.Control.Try

	Gui.FrmOrderReview.GsGCAllOpen.enabled(False)
	V.Local.i.Declare(long)
	V.Local.ssql.Declare(string)
	V.Local.spart.Declare(string)
	V.Local.sUm.Declare(string)
	V.Local.sDescription.Declare(string)
	V.Local.sLoc.Declare(string)
	V.Local.sPL.Declare(string)
	V.Local.sSource.Declare(string)
	V.Local.sMessage.Declare(string)
	V.Local.sShortRet.Declare(string)
	V.Local.sParams.Declare(string)
	V.Local.sret.Declare(string)
	V.Local.fPrice.Declare(float)
	V.Local.lret.Declare(long)
	V.Local.sMChk.Declare(string)
	
	F.Intrinsic.Control.If(V.DataTable.dtRtrs.Exists)
		F.Data.DataTable.Close("dtRtrs")
	F.Intrinsic.Control.EndIf	
	
	F.Data.DataTable.Create("dtRtrs","true")
	F.Data.DataTable.AddColumn("dtRtrs","Part","String")
	F.Data.DataTable.AddColumn("dtRtrs","Desc","String")
	F.Data.DataTable.AddColumn("dtRtrs","PrdL","String")
	F.Data.DataTable.AddColumn("dtRtrs","UoMs","String")
	F.Data.DataTable.AddColumn("dtRtrs","Prce","Float")
	F.Data.DataTable.AddColumn("dtRtrs","Orig","Long")
	'Verify if the user wants to do this.
	F.Intrinsic.String.Concat("Create/Maintain Routers for: ",V.Ambient.NewLine,V.Local.sMessage)
	F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.dtMaster$dtAll.RowCount--,1)
		F.Intrinsic.Control.If(V.DataTable.dtMaster$dtAll(V.Local.i).ScheduleWO!fieldval,=,"True")
			F.Intrinsic.String.Left(V.DataTable.dtMaster$dtAll(V.Local.i).CODE_SOURCE!fieldvaltrim,1,V.Local.sMChk)
			F.Intrinsic.Control.If(V.Local.sMChk,=,"M","or",V.DataTable.dtMaster$dtAll(V.Local.i).RtrCompl!fieldval,=,True)
				F.Intrinsic.String.Build("select um_order from V_ORDER_LINES where ORDER_NO='{0}' and RECORD_NO='{1}0'",V.DataTable.dtMaster$dtAll(V.Local.i).SO!FIELDVALTRIM,V.DataTable.dtMaster$dtAll(V.Local.i).SOLine!FIELDVALTRIM,V.Local.ssql)
				F.ODBC.Connection!con.executeandreturn(V.Local.ssql,V.Local.sUm)
				F.Intrinsic.String.Build("select price_order from V_ORDER_LINES where ORDER_NO='{0}' and RECORD_NO='{1}0'",V.DataTable.dtMaster$dtAll(V.Local.i).SO!FIELDVALTRIM,V.DataTable.dtMaster$dtAll(V.Local.i).SOLine!FIELDVALTRIM,V.Local.ssql)
				F.ODBC.Connection!con.executeandreturn(V.Local.ssql,V.Local.fPrice)
				V.Local.spart.Set(V.DataTable.dtMaster$dtAll(V.Local.i).SOPart!fieldvaltrim)
				V.Local.sDescription.Set(V.DataTable.dtMaster$dtAll(V.Local.i).Description!fieldvaltrim)
				V.Local.sPL.Set(V.DataTable.dtMaster$dtAll(V.Local.i).Product_Line!FIELDVALTRIM)	
				F.Intrinsic.String.Concat(V.Local.sMessage," ",V.DataTable.dtMaster$dtAll(V.Local.i).SOPart!fieldval," --- ",V.DataTable.dtMaster$dtAll(V.Local.i).Description!fieldval,V.Ambient.NewLine,V.Local.sMessage)
				F.Data.DataTable.AddRow("dtRtrs","Part",V.Local.spart,"Desc",V.Local.sDescription,"PrdL",V.Local.sPL,"UoMs",V.Local.sUm,"Prce",V.Local.fPrice,"Orig",V.Local.i)
			F.Intrinsic.Control.EndIf
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.i)
	
	'Reset i before continuing on
	V.Local.i.Set(0)
	F.Intrinsic.Control.If(V.DataTable.dtRtrs.RowCount,<>,0)
		F.Intrinsic.UI.Msgbox(V.Local.sMessage,"Create/Maintain Routers?",4,V.Local.lret)
	F.Intrinsic.Control.Else
		F.Intrinsic.UI.Msgbox("No valid lines selected.  Please double check that the source code is Manufactured (M or F).")
	F.Intrinsic.Control.EndIf
	
	F.Intrinsic.Control.If(V.Local.lret,=,6)
		F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.dtRtrs.RowCount--,1)
			V.Local.spart.Set(V.DataTable.dtRtrs(V.Local.i).Part!fieldvaltrim)
			V.Local.sDescription.Set(V.DataTable.dtRtrs(V.Local.i).Desc!fieldvaltrim)
			V.Local.sPL.Set(V.DataTable.dtRtrs(V.Local.i).PrdL!FIELDVALTRIM)
			V.Local.sUm.Set(V.DataTable.dtRtrs(V.Local.i).UoMs!FIELDVALTRIM)
			
			F.Intrinsic.Control.If(V.Global.bLongPart)
				F.Global.Inventory.GetGSSPart(V.Local.sPart,"",V.Local.sShortRet)
			F.Intrinsic.Control.Else
				V.Local.sShortRet.Set(V.Local.sPart.Trim)
			F.Intrinsic.Control.EndIf
			
			F.Intrinsic.String.Build("SELECT * FROM V_ROUTER_HEADER WHERE ROUTER='{0}'",V.Local.sShortRet,V.Local.ssql)
			F.ODBC.Connection!con.executeandreturn(V.Local.ssql,V.Local.sret)


			F.Intrinsic.Control.If(V.Local.sret.Trim,=,"")
				'Open new router screen
				F.Intrinsic.String.ConcatCallWrapperArgs("N",V.Local.sShortRet,V.Local.sParams)
				F.Global.General.CallWrappersync(400000,V.Local.sParams)
			F.Intrinsic.Control.Else
				'Open existing router screen
				F.Intrinsic.String.ConcatCallWrapperArgs("O",V.Local.sShortRet,V.Local.sParams)
				F.Global.General.CallWrappersync(400000,V.Local.sParams)
			F.Intrinsic.Control.EndIf
			F.Data.DataTable.SetValue("dtMaster$dtAll",V.DataTable.dtRtrs(V.Local.i).Orig!Fieldval,"ScheduleWO","False")
			F.Data.DataTable.SetValue("dtMaster$dtAll",V.DataTable.dtRtrs(V.Local.i).Orig!fieldval,"GSSPart",V.Local.sShortRet)
		F.Intrinsic.Control.Next(V.Local.i)
		F.Intrinsic.Control.CallSub(cmdrefresh_click)
	F.Intrinsic.Control.EndIf
	
	Gui.FrmOrderReview.GsGCAllOpen.enabled(True)
F.Intrinsic.Control.Catch
	F.Intrinsic.UI.Msgbox(V.Ambient.ErrorDescription)
	F.Intrinsic.Control.CallSub(FrmOrderReview_UnLoad)
F.Intrinsic.Control.EndTry
Program.Sub.cmdCreateRtr_Click.End

Program.Sub.cmdCreateBOM_Click.Start
F.Global.General.CallWrapperAsync(50,"BM0020GI/O")
Program.Sub.cmdCreateBOM_Click.End

Program.Sub.cmdCreatePO_Click.Start
F.Intrinsic.Control.Try
	V.Local.i.Declare(long)
	V.Local.ssql.Declare(string)
	V.Local.spart.Declare(string)
	V.Local.sUm.Declare(string)
	V.Local.sDescription.Declare(string)
	V.Local.sLoc.Declare(string)
	V.Local.sPL.Declare(string)
	V.Local.sSource.Declare(string)
	V.Local.sMessage.Declare(string)
	V.Local.sShortRet.Declare(string)
	V.Local.sParams.Declare(string)
	V.Local.sret.Declare(string)
	V.Local.sHold.Declare(string)
	V.Local.sDate.Declare(string)
	V.Local.sGSSPart.Declare(string)
	V.Local.sGLACCOUNT.Declare(string)
	V.Local.sSOHead.Declare(string)
	V.Local.sSOLine.Declare(string)
	V.Local.sVend.Declare(string)
	V.Local.dDate.Declare(date)
	V.Local.fPrice.Declare(float)
	V.Local.fcost.Declare(float)
	V.Local.fACst.Declare(float)
	V.Local.fICst.Declare(float)
	V.Local.fQty.Declare(float)
	V.Local.lret.Declare(long)
	
	F.Intrinsic.Control.If(V.DataTable.dtPO.Exists)
		F.Data.DataTable.Close("dtPO")
	F.Intrinsic.Control.EndIf	
	
	F.Data.DataTable.Create("dtPO","true")
	F.Data.DataTable.AddColumn("dtPO","Part","String")
	F.Data.DataTable.AddColumn("dtPO","Desc","String")
	F.Data.DataTable.AddColumn("dtPO","Vend","String")
	F.Data.DataTable.AddColumn("dtPO","PrdL","String")
	F.Data.DataTable.AddColumn("dtPO","UoMs","String")
	F.Data.DataTable.AddColumn("dtPO","Cost","Float")
	F.Data.DataTable.AddColumn("dtPO","ACst","Float")
	F.Data.DataTable.AddColumn("dtPO","ICst","Float")
	F.Data.DataTable.AddColumn("dtPO","Orig","Long")
	F.Data.DataTable.AddColumn("dtPO","Date","String")
	F.Data.DataTable.AddColumn("dtPO","Qnty","Float")
	F.Data.DataTable.AddColumn("dtPO","Acct","String")
	F.Data.DataTable.AddColumn("dtPO","GPrt","String")
	F.Data.DataTable.AddColumn("dtPO","SOHD","String")
	F.Data.DataTable.AddColumn("dtPO","SOLI","String")
	'Verify if the user wants to do this.
	F.Intrinsic.String.Concat("Create Purchase Order for: ",V.Ambient.NewLine,V.Local.sMessage)
	F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.dtMaster$dtAll.RowCount--,1)
		F.Intrinsic.Control.If(V.DataTable.dtMaster$dtAll(V.Local.i).ScheduleWO!fieldval,=,"True")
			V.Local.sPart.Set(V.DataTable.dtMaster$dtAll(V.Local.i).SOPart!fieldvaltrim)
			V.Local.sDescription.Set(V.DataTable.dtMaster$dtAll(V.Local.i).Description!fieldvaltrim)
			V.Local.sPL.Set(V.DataTable.dtMaster$dtAll(V.Local.i).Product_Line!FIELDVALTRIM)	
			V.Local.dDate.Set(V.DataTable.dtMaster$dtAll(V.Local.i).SODueDate!FIELDVAL)
			V.Local.sUm.Set(V.DataTable.dtMaster$dtAll(V.Local.i).UM_ORDER!FIELDVALTRIM)
			V.Local.fQty.Set(V.DataTable.dtMaster$dtAll(V.Local.i).SOQty!fieldval)
			V.Local.sGSSPart.Set(V.DataTable.dtMaster$dtAll(V.Local.i).GSSPart!FIELDVALTRIM)
			V.Local.sSOHead.Set(V.DataTable.dtMaster$dtAll(V.Local.i).SO!FieldvalTrim)
			V.Local.sSOLine.Set(V.DataTable.dtMaster$dtAll(V.Local.i).SOLine!FieldvalTrim)
			
			F.Intrinsic.String.Format(V.Local.dDate,"YYYYMMDD",V.Local.sDate)
			F.Intrinsic.String.Build("select PURCHASING_ACCOUNT from V_PRODUCT_LINE where PRODUCT_LINE='{0}'",V.Local.sPL,V.Local.ssql)
			F.ODBC.Connection!con.executeandreturn(V.Local.ssql,V.Local.sGLAccount)
			F.Intrinsic.Control.If(V.Local.sGLACCOUNT.Trim,=,"")
				'Need to prepopulate if GL is blank		
			F.Intrinsic.Control.EndIf
			
			'Grab the alt cost
			F.Intrinsic.String.Build("select AMT_ALT_COST from V_INVENTORY_MSTR where PART='{0}'",V.Local.sGSSPart.Trim,V.Local.ssql)
			F.ODBC.Connection!con.executeandreturn(V.Local.ssql,V.Local.fACst)
			
			F.Intrinsic.String.Build("select AMT_COST from V_INVENTORY_MSTR where PART='{0}'",V.Local.sGSSPart.Trim,V.Local.ssql)
			F.ODBC.Connection!con.executeandreturn(V.Local.ssql,V.Local.fICst)
			
			F.Intrinsic.String.Build("select NAME_VENDOR from V_INVENTORY_MST2 where PART='{0}'",V.Local.sGSSPart.Trim,V.Local.ssql)
			F.ODBC.Connection!con.executeandreturn(V.Local.ssql,V.Local.sVend)
			
			V.Local.fcost.Set(V.Local.fACst)
			F.Intrinsic.Control.If(V.Local.fcost,=,0)
				V.Local.fcost.Set(V.Local.fICst)
			F.Intrinsic.Control.EndIf
			
			F.Intrinsic.String.Concat(V.Local.sMessage," ",V.DataTable.dtMaster$dtAll(V.Local.i).SOPart!fieldval," --- ",V.DataTable.dtMaster$dtAll(V.Local.i).Description!fieldval,V.Ambient.NewLine,V.Local.sMessage)
			F.Data.DataTable.AddRow("dtPO","SOHD",V.Local.sSOHead,"SOLI",V.Local.sSOLine,"Part",V.Local.spart,"Desc",V.Local.sDescription,"PrdL",V.Local.sPL,"UoMs",V.Local.sUm,"Cost",V.Local.fCost,"Orig",V.Local.i,"Date",V.Local.sDate,"Qnty",V.Local.fQty,"Acct",V.Local.sGLACCOUNT,"GPrt",V.Local.sGSSPart,"ACst",V.Local.fACst,"ICst",V.Local.fICst,"Vend",V.Local.sVend)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.i)
	Gui.frmSelectVend.gsgcLines.DataSource("dtPO")
	Gui.frmSelectVend.gsgcLines.AddGridviewFromDatatable("gvPO","dtPO")
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Desc","Caption","Description")
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","PrdL","Caption","Product Line")
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","UoMs","Caption","UoM")
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Qnty","Caption","Quantity")
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Vend","Caption","Vendor Name")
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Orig","Visible","False")
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Date","Visible","False")
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Acct","Visible","False")
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","GPrt","Visible","False")
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","SOHD","Visible","False")
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","SOLI","Visible","False")
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","ACst","Visible","False")
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","ICst","Visible","False")
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Part","HeaderFontBold",True)
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Desc","HeaderFontBold",True)
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","PrdL","HeaderFontBold",True)
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Cost","HeaderFontBold",True)
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Qnty","HeaderFontBold",True)
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","UoMs","HeaderFontBold",True)
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Vend","HeaderFontBold",True)
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Part","HeaderHAlignment","Center")
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Desc","HeaderHAlignment","Center")
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","PrdL","HeaderHAlignment","Center")
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","UoMs","HeaderHAlignment","Center")
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Qnty","HeaderHAlignment","Center")
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Cost","HeaderHAlignment","Center")
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Vend","HeaderHAlignment","Center")
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Part","ReadOnly",True)
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Desc","ReadOnly",True)
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","PrdL","ReadOnly",True)
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","UoMs","ReadOnly",True)
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Qnty","ReadOnly",True)
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Cost","ReadOnly",False)
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Part","AllowEdit",False)
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Desc","AllowEdit",False)
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","PrdL","AllowEdit",False)
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","UoMs","AllowEdit",False)
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Qnty","AllowEdit",False)
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Cost","AllowEdit",True)
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Vend","AllowEdit",False)
	Gui.frmSelectVend.gsgcLines.SetColumnProperty("gvPO","Part","CellForeColor","Blue")
	Gui.frmSelectVend.gsgcLines.anchor(15)
	Gui.frmSelectVend.cmdNewPO.anchor(6)
	Gui.frmSelectVend..Show
F.Intrinsic.Control.Catch
	F.Intrinsic.UI.Msgbox(V.Ambient.ErrorDescription)
F.Intrinsic.Control.EndTry
Program.Sub.cmdCreatePO_Click.End

Program.Sub.cmdNewPO_Click.Start
F.Intrinsic.Control.Try
	F.Intrinsic.UI.InvokeWaitDialog("Processing Order")
	Gui.FrmOrderReview.GsGCAllOpen.enabled(false)
	V.Local.shold.Declare(string)
	V.Local.sPart.Declare(string)
	V.Local.sDesc.Declare(string)
	V.Local.sSODs.Declare(string)
	V.Local.sPrdL.Declare(string)
	V.Local.sUoMs.Declare(string)
	V.Local.sAcct.Declare(string)
	V.Local.sDate.Declare(string)
	V.Local.sVend.Declare(string)
	V.Local.sParm.Declare(string)
	V.Local.sFile.Declare(string)
	V.Local.sRslt.Declare(string)
	V.Local.sLine.Declare(string)
	V.Local.sPONm.Declare(string)
	V.Local.sTemp.Declare(string)
	V.Local.sSQL.Declare(string)
	V.Local.fExtn.Declare(float)
	V.Local.fCost.Declare(float)
	V.Local.fQnty.Declare(float)
	V.Local.i.Declare(long)
	
	'Create PO in Global Shop
	F.Data.DataTable.AddRow("175100","AutoNumber","Y","Addcomments","N","OpenPO","N")
	F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.dtPO.RowCount--,1)
		V.Local.sPart.Set(V.DataTable.dtPO(V.Local.i).GPRT!FIELDVALTRIM)
		V.Local.sDesc.Set(V.DataTable.dtPO(V.Local.i).DESC!FIELDVALTRIM)
		F.Intrinsic.String.Concat(V.DataTable.dtPO(V.Local.i).SOHD!FIELDVALTRIM,"-",V.DataTable.dtPO(V.Local.i).SOLI!FIELDVALTRIM,V.Local.sSODs)
		V.Local.sPrdL.Set(V.DataTable.dtPO(V.Local.i).PRDL!FIELDVALTRIM)
		V.Local.sUoMs.Set(V.DataTable.dtPO(V.Local.i).UOMS!FIELDVALTRIM)
		V.Local.sAcct.Set(V.DataTable.dtPO(V.Local.i).ACCT!FIELDVALTRIM)
		V.Local.sDate.Set(V.DataTable.dtPO(V.Local.i).DATE!FIELDVALTRIM)
		V.Local.sVend.Set(V.Screen.frmSelectVend!txtVendorNo.text)
		V.Local.fQnty.Set(V.DataTable.dtPO(V.Local.i).QNTY!FIELDVAL)
		V.Local.fCost.Set(V.DataTable.dtPO(V.Local.i).COST!FIELDVAL)
		F.Intrinsic.Math.Mult(V.Local.fCost,V.Local.fQnty,V.Local.fExtn)
		F.Data.DataTable.AddRow("175100File","Vendor",V.Local.sVend,"Part",V.Local.sPart,"Loc","","DueDate",V.Local.sDate,"Description",V.Local.sSODs,"InvUM",V.Local.sUoMs,"InvCost",V.Local.fCost,"InvQty",V.Local.fQnty,"POUM",V.Local.sUoMs,"POCost",V.Local.fCost,"POQty",V.Local.fQnty,"GLAccount",V.Local.sAcct,"Extension",V.Local.fExtn)
	F.Intrinsic.Control.Next(V.Local.i)
	F.Intrinsic.Control.CallSub(175100Sync)	
	
	'Read the resulting file to grab PO number
	F.Intrinsic.String.Concat(V.Caller.FilesDir,"\SLPUR",V.Caller.Terminal,".TXT",V.Local.sFile)
	F.Intrinsic.File.File2String(V.Local.sFile,V.Local.sRslt)
	F.Intrinsic.String.Left(V.Local.sRslt,7,V.Local.sPONm)
	
	'Query the PO and create datatable
	F.Intrinsic.String.Build("SELECT PURCHASE_ORDER, RECORD_NO, DESCRIPTION FROM V_PO_LINES WHERE PURCHASE_ORDER='{0}'",V.Local.sPONm,V.Local.ssql)
	F.Intrinsic.Control.If(V.DataTable.dtPOTemp.Exists)
		F.Data.DataTable.Close("dtPOTemp")
	F.Intrinsic.Control.EndIf
	F.Data.DataTable.CreateFromSQL("dtPOTemp","con",V.Local.sSQL,true)
	
	'Loop through and update the sales orders and replace with original description
	F.Intrinsic.Control.For(V.Local.i,0,V.DataTable.dtPOTemp.RowCount--,1)
		F.Intrinsic.String.Split(V.DataTable.dtPOTemp(V.Local.i).DESCRIPTION!FIELDVALTRIM,"-",V.Local.sTemp)
		F.Intrinsic.Control.If(V.Local.sTemp.UBound,>,0)
			F.Intrinsic.String.Build("SELECT DESCRIPTION FROM V_ORDER_LINES WHERE ORDER_NO='{0}' AND RECORD_NO='{1}0'",V.Local.stemp(0).trim,V.Local.sTemp(1).trim,V.Local.ssql)
			F.ODBC.Connection!con.executeandreturn(V.Local.ssql,V.Local.sDesc)
			F.Intrinsic.String.Build("UPDATE ORDER_LINES SET USER_2='{0}', USER_3='{1}' WHERE ORDER_NO='{2}' AND RECORD_NO='{3}0'",V.DataTable.dtPOTemp(V.Local.i).PURCHASE_ORDER!FIELDVALTRIM,V.DataTable.dtPOTemp(V.Local.i).RECORD_NO!FIELDVALTRIM,V.Local.sTemp(0),V.Local.sTemp(1),V.Local.sSQL)
			F.ODBC.Connection!con.execute(V.Local.ssql)
			F.Intrinsic.String.Build("UPDATE PO_LINES SET DESCRIPTION='{0}', USER_5='SO#: {3}' WHERE PURCHASE_ORDER='{1}' AND RECORD_NO='{2}'",V.Local.sDesc,V.DataTable.dtPOTemp(V.Local.i).PURCHASE_ORDER!FIELDVALTRIM,V.DataTable.dtPOTemp(V.Local.i).RECORD_NO!FIELDVALTRIM,V.DataTable.dtPOTemp(V.Local.i).DESCRIPTION!FIELDVALTRIM,V.Local.sSQL)
			F.ODBC.Connection!con.execute(V.Local.ssql)
		F.Intrinsic.Control.EndIf
	F.Intrinsic.Control.Next(V.Local.i)
	F.Intrinsic.UI.CloseWaitDialog
	F.Intrinsic.Control.CallSub(frmSelectVend_Unload)
	F.Intrinsic.Control.CallSub(cmdRefresh_Click)
	Gui.FrmOrderReview.GsGCAllOpen.enabled(true)
F.Intrinsic.Control.Catch
	F.Intrinsic.UI.Msgbox(V.Ambient.ErrorDescription)
F.Intrinsic.Control.EndTry
Program.Sub.cmdNewPO_Click.End

Program.Sub.Form_UnLoad.Start
Program.Sub.Form_UnLoad.End

Program.Sub.frmSerNo_UnLoad.Start
'6088
	F.Intrinsic.Control.Try
	V.Local.sError.Declare
	
	Gui.frmSerNo..Visible(False)
	
	F.Intrinsic.Control.Catch
		F.Intrinsic.String.Build("Project: {0}{1}{1}Subroutine: {2}{1}Error Occurred {3} with description {4}{1}{1}GAB Version: {5}",V.Ambient.ScriptPath,V.Ambient.Newline,V.Ambient.CurrentSubroutine,V.Ambient.ErrorNumber,V.Ambient.ErrorDescription,V.Ambient.GABVersion,V.Local.sError)
		F.Intrinsic.UI.Msgbox(V.Local.sError)
		F.Intrinsic.Control.End
	F.Intrinsic.Control.EndTry
Program.Sub.frmSerNo_UnLoad.End

Program.Sub.frmSelectVend_UnLoad.Start
F.Data.DataTable.Close("dtPO")
Gui.frmSelectVend..Visible(false)
Program.Sub.frmSelectVend_UnLoad.End

Program.Sub.cmdVendBrw_Click.Start
V.Local.sRet.Declare(String)
V.Local.sTitles.Declare(String)
V.Local.iWidths.Declare(String)
V.Local.stemp.Declare(String)
V.Local.ssql.Declare(String)

F.Intrinsic.UI.SetBrowserHotTypeAhead(true)

F.intrinsic.string.split("Vendor No.*!*Vendor Name","*!*",V.local.sTitles)
F.intrinsic.string.split("2000*!*3000","*!*",V.local.iWidths)

V.Local.ssql.set("SELECT VENDOR, NAME_VENDOR FROM V_VENDOR_MASTER")

F.intrinsic.ui.browser("Select a Vendor Code",con,V.Local.ssql,V.local.sTitles,V.local.iWidths,V.local.sRet)

F.intrinsic.control.if(V.local.sRet,"=","***CANCEL***")
F.intrinsic.control.else
  	F.intrinsic.string.split(V.local.sRet,"*!*",V.local.sRet)
  	Gui.frmSelectVend.txtVendorNo.Text(V.Local.sRet(0))
F.Intrinsic.Control.endif

Program.Sub.cmdVendBrw_Click.End

Program.Sub.gsgcLines_RowCellClick.Start
F.Intrinsic.Control.Try
	V.Local.sError.Declare
	V.Local.sPart.Declare
	V.Local.sGSSPart.Declare
	Gui.frmSelectVend.gsgcLines.GetCellValueByColumnName("gvPO","GPrt",V.Args.RowIndex,V.Local.sGssPart)
	F.Intrinsic.Control.SelectCase(V.Args.column)
		F.Intrinsic.Control.Case("Part")
			F.Data.DataTable.AddRow("300011","Part",V.Local.sGssPart,"Location","","Switch","M")
			F.Intrinsic.Control.CallSub(300011Async)
	F.Intrinsic.Control.EndSelect
F.Intrinsic.Control.Catch
	F.Intrinsic.UI.Msgbox(V.Ambient.ErrorDescription)
	F.ODBC.Connection!con.Close
	F.Intrinsic.Control.End
F.Intrinsic.Control.EndTry
Program.Sub.gsgcLines_RowCellClick.End

Program.Sub.Comments.Start
${$5$}$2.0.0.0$}$2
${$6$}$lfrey$}$20201223151043849$}$/MtXutbLn8OdE0bzCqZUp6fMoyvCUmyFR2NdALHz83I4GirOJiDQYBii5gPIQsJraqNwpR/Uqb4=
Program.Sub.Comments.End